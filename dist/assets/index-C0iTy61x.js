import{r as s,u as I,e as V,j as e,a as D,L as O,c as C}from"./index-xvO6EYLJ.js";import{B as H}from"./index-DhITJl5A.js";import U from"./index-CoisELQu.js";import{R as k}from"./ReCAPTCHAUtil-DR3OCpma.js";import{L as z}from"./styles-07yWa0TW.js";import{L as E}from"./LockOutlined-D0nT4oR-.js";import{B as G}from"./context-DdBxAEa7.js";import{M as S}from"./index-CvA9nhkX.js";import{I as J}from"./index-CedHbxzm.js";import{m as p}from"./index-BiTWdfWv.js";import"./AuthModal-BehEGevw.js";import"./index-CnZdoO9C.js";import"./Styles-BaVVybOo.js";import"./index-B3RoWMnv.js";import"./useSize-6WP4OJO1.js";import"./AntdIcon-D_LLieO3.js";import"./index-CCtKJevy.js";import"./index-C-c4zHbE.js";import"./render-DABMoBew.js";import"./row-cNkTQF-q.js";import"./responsiveObserver-DGOH8gk1.js";import"./useLocale-Bsp9xcRv.js";import"./ExclamationCircleFilled-D1rgX5dR.js";import"./index-Ci5EgdtF.js";import"./PurePanel-Bcv7kPDi.js";import"./CalendarOutlined-BOhopRP9.js";import"./ClockCircleOutlined-9RLiDPs1.js";import"./KeyCode-Buyvp17p.js";import"./SearchOutlined-2JrLTji_.js";import"./index-CwA9H1rK.js";import"./Overflow-nAuBfdjZ.js";import"./CheckOutlined-BkcGHlRB.js";import"./index-BFjzDzeC.js";import"./index-Cr1x6K6x.js";import"./WarningOutlined-BNzfROcW.js";import"./index-B-vtmrfF.js";import"./InfoCircleFilled-BPS8A9lc.js";import"./useNotification-CnkbSI_l.js";const K="_autenticar_103d6_1",Q="_formulario_103d6_10",W="_inputContainer_103d6_24",X="_captcha_103d6_32",Y="_inputField_103d6_38",Z="_forgotPassword_103d6_48",$="_registerPrompt_103d6_58",ee="_error_103d6_71",t={autenticar:K,formulario:Q,inputContainer:W,captcha:X,inputField:Y,forgotPassword:Z,registerPrompt:$,error:ee},De=()=>{const[f,x]=s.useState(""),[g,j]=s.useState(""),[M,v]=s.useState(!1),[R,re]=s.useState(""),[T,d]=s.useState(!1),[_,N]=s.useState(""),[P,m]=s.useState(""),[n,u]=s.useState(""),l=s.useRef(null),[L,h]=s.useState(!1),w=I(),{updateAuthData:A}=V(),b=async r=>{var a,o;if(r.preventDefault(),m(""),!n){m("Por favor, confirme que você não é um robô.");return}h(!0);try{const i=await C.post("/auth/login",{username:f,password:g,recaptchaToken:n}),{token:c,company_id:y,user_specialties:B}=i.data;if(typeof y>"u")throw h(!1),new Error("Informações do usuário ou da empresa não estão disponíveis.");A({authToken:c,companyID:y,userSpecialties:B}),x(""),j(""),u(""),w("/calendario")}catch(i){h(!1);const c=((o=(a=i.response)==null?void 0:a.data)==null?void 0:o.message)||"Erro ao fazer login.";m(c),p.error(c),l.current&&l.current.reset()}},q=async()=>{var r,a;if(!n){p.error("Por favor, complete o reCAPTCHA.");return}try{const o=await C.post("/auth/password-reset",{email:_,recaptchaToken:n});if(o.status>=200&&o.status<300)p.success("Se um email corresponder à sua conta, enviaremos um link de redefinição de senha.");else throw new Error("Algo deu errado, por favor tente novamente.")}catch(o){const i=((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.message)||"Algo deu errado, por favor tente novamente.";p.error(i)}finally{d(!1)}},F=()=>{d(!0)};return e.jsxs("div",{className:t.autenticar,children:[L?e.jsxs(z,{children:[e.jsx(D,{})," "]}):e.jsxs("form",{className:t.formulario,onSubmit:b,children:[e.jsxs("h1",{children:["Acesso ao Marquei ",e.jsx(E,{})]}),e.jsxs("div",{className:t.inputContainer,children:[e.jsx("label",{htmlFor:"username",children:"E-mail"}),e.jsx("input",{type:"text",id:"username",className:t.inputField,placeholder:"E-mail",value:f,onChange:r=>x(r.target.value),required:!0})]}),e.jsxs("div",{className:t.inputContainer,children:[e.jsx("label",{htmlFor:"password",children:"Senha"}),e.jsx("input",{type:"password",id:"password",className:t.inputField,placeholder:"Senha",value:g,onChange:r=>j(r.target.value),required:!0}),P&&e.jsx("div",{className:t.error,children:P})]}),e.jsx("div",{className:t.captcha,children:e.jsx(k,{ref:l,onChange:r=>u(r)})}),e.jsx(H,{type:"submit",className:t.loginButton,children:"Entrar"}),e.jsx("div",{className:t.forgotPassword,children:e.jsx(G,{type:"link",onClick:F,children:"Esqueci minha senha"})}),e.jsxs("div",{className:t.registerPrompt,children:[e.jsx("p",{children:"Você ainda não tem uma conta Marquei?"}),e.jsx(O,{to:"/cadastro",children:"Teste o Marquei gratuitamente"})]})]}),e.jsxs(S,{title:"Período de teste chegou ao Fim :(",open:M,onOk:()=>{w("/contratar-plano"),v(!1)},onCancel:()=>v(!1),okText:"Consulte outros planos...",cancelButtonProps:{style:{display:"none"}},children:[e.jsx("p",{children:R}),e.jsx(U,{title:"Plus",price:"69,99",originalPrice:"119",quantity:"1",duration:"1",mostSold:!0})]}),e.jsxs(S,{title:"Redefinir senha",open:T,onOk:q,onCancel:()=>d(!1),okText:"Resetar",cancelText:"Cancelar",children:[e.jsx("p",{children:"Insira o E-mail cadastrado para resetar a senha de acesso !"}),e.jsx(J,{prefix:e.jsx(E,{}),type:"email",placeholder:"Digite seu email",value:_,onChange:r=>N(r.target.value),required:!0}),e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"18px 0"},children:e.jsx(k,{ref:l,onChange:r=>u(r)})})]})]})};export{De as default};
