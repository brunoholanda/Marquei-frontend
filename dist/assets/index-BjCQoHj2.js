import{r as a,d as K,B as ue,j as e,L as De,N as we}from"./index-BjWOWftK.js";import{b as he,a as w}from"./api-yj2qoLPl.js";import{U as Te,P as Ie}from"./registerModal-CPwCNS73.js";/* empty css                     */import{M as V}from"./index-DZhypcJC.js";import{B as b}from"./context-CsxF_MV5.js";import{S as le}from"./index-BNxrNzwE.js";import{T as ce}from"./index-xwEKfmQR.js";import{U as fe,D as ie}from"./index-BGYDhtWV.js";import{I}from"./index-Dtquuxsa.js";import{m as D}from"./index-voIPXOLj.js";import{U as ge}from"./UploadOutlined-CfKVTpOI.js";import{A as Y,_ as q}from"./AntdIcon-CQBeZWiu.js";import{h as A}from"./moment-gy9AvL1k.js";import"./pt-br-B9zwe46w.js";import{T as W}from"./index-DmbuE59p.js";import{L as xe}from"./LinkOutlined-BuwQFSXi.js";import{c as ye}from"./index-CtBWz5l5.js";import{C as oe}from"./index-CQC3ljG7.js";import{C as ze}from"./ControlOutlined-B54heeAG.js";import{S as ve}from"./index-CrIh86xN.js";import{D as Me}from"./index-C7SteZcr.js";import{T as de}from"./Table-DssO-p4r.js";import{W as Pe}from"./WarningFilled-CCR6pemv.js";import $e from"./index-DncJ83qH.js";import He from"./index-T-DRixFE.js";import{E as Le,C as Oe}from"./ExclamationCircleOutlined-CMpo733E.js";import{C as Be}from"./ClockCircleOutlined-vEkn-5q0.js";import{S as Ae}from"./SwapOutlined-AtpSfL35.js";import{T as me}from"./index-Ccg1QiO6.js";import"./index-BYb_ULzC.js";import"./index-Chjiymov.js";import"./index-SZJkRHiF.js";import"./useForm-BVlqLGy1.js";import"./Styles-HDwQP3Lk.js";import"./styled-components.browser.esm-0XG6BcNo.js";import"./Serializer-CQbcCsmu.js";import"./index-DWnRouz4.js";import"./useSize-xGuuOV2H.js";import"./index-10_tvuH-.js";import"./render-Dc9fgLFB.js";import"./row-xbO0cgu3.js";import"./responsiveObserver-eh3CkRQ8.js";import"./useLocale-B5fEOMjY.js";import"./ExclamationCircleFilled-BXHKs-a4.js";import"./commonMailDomains-C8uuVB4t.js";import"./WarningOutlined-B45VRAgE.js";import"./InfoCircleFilled-CN7YLSSN.js";import"./KeyCode-iNboPXT1.js";import"./PurePanel-vSTbxOUV.js";import"./useForceUpdate-DA-qGIrz.js";import"./CheckOutlined-BorBS3ox.js";import"./SearchOutlined-DC5n_389.js";import"./useNotification-C_uzqUJr.js";import"./cjs-BuFYNCHu.js";import"./index-DREpUMdt.js";import"./Overflow-vieoZhrC.js";import"./CalendarOutlined-fGf3BKFZ.js";import"./index-z7srBD_T.js";import"./EllipsisOutlined-CWuHYn8k.js";import"./index-DICP50cq.js";import"./Dropdown-C_ydlxYW.js";import"./AuthModal-D1-hlBBe.js";import"./index-BrP1Cg1Z.js";import"./index-JyjWfW4x.js";import"./index-p12zW5yf.js";import"./PlusOutlined-OWyJAdgg.js";var Fe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"};const Re=Fe;var _e=function(c,o){return a.createElement(Y,q({},c,{ref:o,icon:Re}))};const Ne=a.forwardRef(_e);var Ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M894 462c30.9 0 43.8-39.7 18.7-58L530.8 126.2a31.81 31.81 0 00-37.6 0L111.3 404c-25.1 18.2-12.2 58 18.8 58H192v374h-72c-4.4 0-8 3.6-8 8v52c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-52c0-4.4-3.6-8-8-8h-72V462h62zM512 196.7l271.1 197.2H240.9L512 196.7zM264 462h117v374H264V462zm189 0h117v374H453V462zm307 374H642V462h118v374z"}}]},name:"bank",theme:"outlined"};const Ue=Ve;var We=function(c,o){return a.createElement(Y,q({},c,{ref:o,icon:Ue}))};const Ye=a.forwardRef(We);var qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136V232h752v560zM610.3 476h123.4c1.3 0 2.3-3.6 2.3-8v-48c0-4.4-1-8-2.3-8H610.3c-1.3 0-2.3 3.6-2.3 8v48c0 4.4 1 8 2.3 8zm4.8 144h185.7c3.9 0 7.1-3.6 7.1-8v-48c0-4.4-3.2-8-7.1-8H615.1c-3.9 0-7.1 3.6-7.1 8v48c0 4.4 3.2 8 7.1 8zM224 673h43.9c4.2 0 7.6-3.3 7.9-7.5 3.8-50.5 46-90.5 97.2-90.5s93.4 40 97.2 90.5c.3 4.2 3.7 7.5 7.9 7.5H522a8 8 0 008-8.4c-2.8-53.3-32-99.7-74.6-126.1a111.8 111.8 0 0029.1-75.5c0-61.9-49.9-112-111.4-112s-111.4 50.1-111.4 112c0 29.1 11 55.5 29.1 75.5a158.09 158.09 0 00-74.6 126.1c-.4 4.6 3.2 8.4 7.8 8.4zm149-262c28.5 0 51.7 23.3 51.7 52s-23.2 52-51.7 52-51.7-23.3-51.7-52 23.2-52 51.7-52z"}}]},name:"idcard",theme:"outlined"};const Je=qe;var Ke=function(c,o){return a.createElement(Y,q({},c,{ref:o,icon:Je}))};const Ge=a.forwardRef(Ke);var Qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H544v152c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V544H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h152V328c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v152h152c4.4 0 8 3.6 8 8v48z"}}]},name:"plus-circle",theme:"filled"};const Xe=Qe;var Ze=function(c,o){return a.createElement(Y,q({},c,{ref:o,icon:Xe}))};const ea=a.forwardRef(Ze);var aa={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"};const ta=aa;var oa=function(c,o){return a.createElement(Y,q({},c,{ref:o,icon:ta}))};const sa=a.forwardRef(oa);var na={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M759 335c0-137-111-248-248-248S263 198 263 335c0 82.8 40.6 156.2 103 201.2-.4.2-.7.3-.9.4-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00136 874.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C356 614.2 431 583 511 583c137 0 248-111 248-248zM511 507c-95 0-172-77-172-172s77-172 172-172 172 77 172 172-77 172-172 172zm105 221h264c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H703.5l47.2-60.1a8.1 8.1 0 001.7-4.9c0-4.4-3.6-8-8-8h-72.6c-4.9 0-9.5 2.3-12.6 6.1l-68.5 87.1c-4.4 5.6-6.8 12.6-6.8 19.8.1 17.7 14.4 32 32.1 32zm240 64H592c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h176.5l-47.2 60.1a8.1 8.1 0 00-1.7 4.9c0 4.4 3.6 8 8 8h72.6c4.9 0 9.5-2.3 12.6-6.1l68.5-87.1c4.4-5.6 6.8-12.6 6.8-19.8-.1-17.7-14.4-32-32.1-32z"}}]},name:"user-switch",theme:"outlined"};const ra=na;var ia=function(c,o){return a.createElement(Y,q({},c,{ref:o,icon:ra}))};const pe=a.forwardRef(ia);var la={icon:function(c,o){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M955.7 856l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z",fill:c}},{tag:"path",attrs:{d:"M172.2 828.1h679.6L512 239.9 172.2 828.1zM560 720a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm-16-304v184c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V416c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8z",fill:o}},{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8z",fill:c}}]}},name:"warning",theme:"twotone"};const ca=la;var da=function(c,o){return a.createElement(Y,q({},c,{ref:o,icon:ca}))};const re=a.forwardRef(da),ma=({isVisible:i,onClose:c})=>{const[o,k]=a.useState({}),[v,y]=a.useState({}),[d,m]=a.useState(null),[T,E]=a.useState(null),[P,z]=a.useState(!1),[M,R]=a.useState(""),[L,_]=a.useState(""),[$,F]=a.useState(""),[t,s]=a.useState({}),[r,l]=a.useState(""),{authData:j}=K(),S=j.companyID,H=async f=>{if(f.length===8)try{const u=await he.get(`https://viacep.com.br/ws/${f}/json/`);s(u.data)}catch(u){console.error("Erro ao buscar CEP:",u)}};a.useEffect(()=>{H(M)},[M]);const N=`${t.logradouro??""}, ${L??""}, ${$??""}, ${t.bairro??""} - ${t.localidade??""} / ${t.uf??""} - ${M}`;a.useEffect(()=>{i&&(async()=>{if(S&&j.authToken){z(!0);try{const u=await w.get(`/companies/${S}`,{headers:{Authorization:`Bearer ${j.authToken}`}});k(u.data),l(u.data.endereco)}catch(u){u.response?console.error("API response error:",u.response):console.error("Error fetching company data:",u)}finally{z(!1)}}else console.error("Company ID or auth token not found in local storage")})()},[S,j.authToken,i]),a.useEffect(()=>{y(o),o.logo_path&&E(`${ue}/${o.logo_path}`)},[o]);const B=f=>{const{name:u,value:O}=f.target;y(J=>({...J,[u]:O}))},C=f=>{if(f.fileList.length===0){m(null);return}const u=f.fileList[0];if(u.type!=="image/png"||u.size>5e5){D.error("Por favor, selecione um arquivo PNG de até 500kb.");return}if(u){const O=URL.createObjectURL(u.originFileObj);E(O)}m(u)},h=async()=>{z(!0);try{const f={...v,endereco:N},u=new FormData;u.append("nome",f.nome),u.append("telefone",f.telefone),u.append("instagram",f.instagram),u.append("endereco",f.endereco),d&&u.append("logo",d.originFileObj);const O=await w.put(`/companies/${o.company_id}`,u,{headers:{"Content-Type":"multipart/form-data"}});k(O.data.company),c()}catch(f){console.error("Erro ao atualizar dados da empresa:",f)}finally{z(!1)}};return e.jsxs(V,{title:"Dados da Empresa",open:i,onCancel:c,footer:[e.jsx(b,{onClick:c,children:"Cancelar"},"cancel"),e.jsx(b,{type:"primary",onClick:h,children:"Salvar"},"submit")],children:[e.jsx("p",{children:"Essas informações estão presentes nos atestados e declarações."}),P?e.jsx(le,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("h3",{children:"Logo:"}),T&&e.jsx("img",{src:T,style:{width:"45px",marginBottom:"10px"},alt:"Logo da Empresa"}),e.jsx(ce,{title:"A imagem deve estar em PNG e ter até 500kb",children:e.jsx(fe,{beforeUpload:()=>!1,onChange:C,fileList:d?[d]:[],children:e.jsx(b,{icon:e.jsx(ge,{}),children:"Selecionar Logo"})})})]}),e.jsx(I,{style:{marginBottom:"15px"},name:"nome",value:v.nome,onChange:B,placeholder:"Nome"}),e.jsx(I,{style:{marginBottom:"15px"},name:"telefone",value:v.telefone,onChange:B,placeholder:"WhatsApp"}),e.jsx(I,{style:{marginBottom:"15px"},name:"instagram",value:v.instagram,onChange:B,placeholder:"Instagram"}),e.jsx("label",{children:"Digite o CEP para atualizar o endereço:"}),e.jsx(I,{style:{marginBottom:"15px"},name:"cep",value:M,onChange:f=>R(f.target.value),placeholder:"CEP"}),e.jsx(I,{style:{marginBottom:"15px"},name:"numero",value:L,onChange:f=>_(f.target.value),placeholder:"Número"}),e.jsx(I,{style:{marginBottom:"15px"},name:"referencia",value:$,onChange:f=>F(f.target.value),placeholder:"Referência"}),M&&e.jsxs(e.Fragment,{children:[e.jsx("label",{children:"Novo Endereço:"}),e.jsx(I,{style:{marginBottom:"15px"},name:"endereco",value:N,onChange:B,placeholder:"Endereço Completo"})]}),e.jsx("label",{children:"Endereço Atual:"}),e.jsx(I,{style:{marginBottom:"15px"},name:"enderecoEmpresa",value:r,onChange:B,placeholder:"Endereço da Empresa",disabled:!0}),e.jsx(I,{name:"cnpj",value:v.cnpj,onChange:B,placeholder:"CNPJ",disabled:!0}),e.jsx("h2",{children:"Plano"})]})]})},pa=()=>{const[i,c]=a.useState({}),[o,k]=a.useState({}),[v,y]=a.useState(null),[d,m]=a.useState(null),[T,E]=a.useState(!1),[P,z]=a.useState(""),[M,R]=a.useState(""),[L,_]=a.useState(""),[$,F]=a.useState({}),[t,s]=a.useState(""),{authData:r}=K(),l=r.companyID,j=async C=>{if(C.length===8)try{const h=await he.get(`https://viacep.com.br/ws/${C}/json/`);F(h.data)}catch(h){console.error("Erro ao buscar CEP:",h)}};a.useEffect(()=>{j(P)},[P]);const S=`${$.logradouro??""}, ${M??""}, ${L??""}, ${$.bairro??""} - ${$.localidade??""} / ${$.uf??""} - ${P}`;a.useEffect(()=>{(async()=>{if(l&&r.authToken){E(!0);try{const h=await w.get(`/companies/${l}`,{headers:{Authorization:`Bearer ${r.authToken}`}});c(h.data),s(h.data.endereco)}catch(h){h.response?console.error("API response error:",h.response):console.error("Error fetching company data:",h)}finally{E(!1)}}else console.error("Company ID or auth token not found in local storage")})()},[l,r.authToken]),a.useEffect(()=>{k(i),i.logo_path&&m(`${ue}/${i.logo_path}`)},[i]);const H=C=>{const{name:h,value:f}=C.target;k(u=>({...u,[h]:f}))},N=C=>{if(C.fileList.length===0){y(null);return}const h=C.fileList[0];if(h.type!=="image/png"||h.size>5e5){D.error("Por favor, selecione um arquivo PNG de até 500kb.");return}if(h){const f=URL.createObjectURL(h.originFileObj);m(f)}y(h)},B=async()=>{E(!0);try{const C={...o,endereco:S},h=new FormData;h.append("nome",C.nome),h.append("telefone",C.telefone),h.append("instagram",C.instagram),h.append("endereco",C.endereco),v&&h.append("logo",v.originFileObj);const f=await w.put(`/companies/${i.company_id}`,h,{headers:{"Content-Type":"multipart/form-data"}});c(f.data.company)}catch(C){console.error("Erro ao atualizar dados da empresa:",C)}finally{E(!1)}};return e.jsxs("div",{children:[e.jsxs("h1",{children:["Dados da Empresa ",e.jsx(Ye,{})]}),e.jsx("p",{children:"Essas informações estão presentes nos atestados e declarações."}),T?e.jsx(le,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("h3",{children:"Logo:"}),d&&e.jsx("img",{src:d,style:{width:"45px",marginBottom:"10px"},alt:"Logo da Empresa"}),e.jsx(ce,{title:"A imagem deve estar em PNG e ter até 500kb",children:e.jsx(fe,{beforeUpload:()=>!1,onChange:N,fileList:v?[v]:[],children:e.jsx(b,{icon:e.jsx(ge,{}),children:"Selecionar Logo"})})})]}),e.jsx(I,{style:{marginBottom:"15px"},name:"nome",value:o.nome,onChange:H,placeholder:"Nome"}),e.jsx(I,{style:{marginBottom:"15px"},name:"telefone",value:o.telefone,onChange:H,placeholder:"WhatsApp"}),e.jsx(I,{style:{marginBottom:"15px"},name:"instagram",value:o.instagram,onChange:H,placeholder:"Instagram"}),e.jsx("label",{children:"Digite o CEP para atualizar o endereço:"}),e.jsx(I,{style:{marginBottom:"15px"},name:"cep",value:P,onChange:C=>z(C.target.value),placeholder:"CEP"}),e.jsx(I,{style:{marginBottom:"15px"},name:"numero",value:M,onChange:C=>R(C.target.value),placeholder:"Número"}),e.jsx(I,{style:{marginBottom:"15px"},name:"referencia",value:L,onChange:C=>_(C.target.value),placeholder:"Referência"}),P&&e.jsxs(e.Fragment,{children:[e.jsx("label",{children:"Novo Endereço:"}),e.jsx(I,{style:{marginBottom:"15px"},name:"endereco",value:S,onChange:H,placeholder:"Endereço Completo"})]}),e.jsx("label",{children:"Endereço Atual:"}),e.jsx(I,{style:{marginBottom:"15px"},name:"enderecoEmpresa",value:t,onChange:H,placeholder:"Endereço da Empresa",disabled:!0}),e.jsx(I,{name:"cnpj",value:o.cnpj,onChange:H,placeholder:"CNPJ",disabled:!0}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx(b,{onClick:B,type:"primary",style:{marginRight:"10px"},children:"Salvar"}),e.jsx(b,{children:"Cancelar"})]})]})]})},ua=({isVisible:i,setIsVisible:c,selectedProfessional:o})=>{const[k,v]=a.useState([]),y=["Segunda","Terça","Quarta","Quinta","Sexta","Sábado","Domingo"],[d,m]=a.useState({}),[T,E]=a.useState(null),P=t=>{E(t?t.format("HH:mm"):null)},z=t=>{let s={};return t.forEach(r=>{s[r.id]={startam:r.startam,endam:r.endam,startpm:r.startpm,endpm:r.endpm}}),s},M=(t,s)=>{m(r=>({...r,[t]:{...r[t],[s]:null}}))};a.useEffect(()=>{(async()=>{try{const s=await w.get("/dias-semanais");v(s.data),m(z(s.data))}catch(s){console.error("Erro ao buscar dias da semana",s)}})()},[]);const R=k.sort((t,s)=>y.indexOf(t.dia)-y.indexOf(s.dia)),L=async(t,s)=>{try{if((await w.put(`/dias-semanais/${t}`,{ativo:s,professional_id:o})).data.professional_id===o)v(l=>l.map(j=>j.id===t?{...j,ativo:s}:j));else throw new Error("Dia da semana não corresponde ao profissional selecionado.")}catch(r){console.error("Erro ao atualizar dia da semana",r),D.error("Erro ao atualizar dia da semana. Tente novamente.")}};a.useEffect(()=>{o&&(async()=>{try{const s=await w.get(`/dias-semanais/?professional_id=${o}`);v(s.data),m(z(s.data))}catch(s){console.error("Erro ao buscar dias da semana",s)}})()},[o]),a.useEffect(()=>{i&&o&&(async()=>{try{const s=await w.get(`/professional-intervals/professional/${o}`);s.data?E(A(s.data.intervalo,"HH:mm")):E(null)}catch(s){s.response&&s.response.status===404?(D.info("Nenhum intervalo configurado para este profissional."),E(null)):(console.error("Erro ao buscar intervalo de atendimento",s),D.error("Erro ao buscar intervalo de atendimento. Tente novamente."))}})()},[i,o]);const _=async()=>{const t=[];let s=!1;for(const l of k){const j=d[l.id];if(l.ativo&&(!j||!j.startam||!j.endam||!j.startpm||!j.endpm)){s=!0,D.error(`Por favor, defina todos os intervalos de tempo para ${l.dia}.`);break}const S={ativo:l.ativo,...d[l.id]};if(l.changed||d[l.id]){const H=w.put(`/dias-semanais/${l.id}`,S);t.push(H)}}if(s)return;if(!T){D.error("Por favor, selecione um intervalo de tempo entre atendimentos.");return}const r={professional_id:o,intervalo:T};t.push(w.post("/professional-intervals",r));try{await Promise.all(t),D.success("Configurações do padrão semanal e intervalo de atendimento atualizadas com sucesso!")}catch(l){console.error("Erro ao atualizar configurações",l),D.error("Erro ao atualizar configurações. Tente novamente.")}finally{c(!1)}},$=(t,s,r)=>{m(l=>({...l,[t]:{...l[t],[s]:r?r.format("HH:mm"):null}}))},F=()=>{const t=k.find(l=>l.ativo).id,s=d[t],r={...d};k.forEach(l=>{l.id!==t&&(r[l.id]={...s})}),m(r)};return e.jsxs(V,{title:"Padrão Semanal de Atendimento",open:i,onCancel:()=>c(!1),footer:[e.jsx(b,{onClick:()=>c(!1),children:"Cancelar"},"back"),e.jsx(b,{type:"primary",onClick:_,children:"Salvar"},"submit")],children:[e.jsx("p",{children:"Aqui você configura os dias da semana e intervalos de tempo que sua agenda estará disponível para seus clientes:"}),e.jsx(b,{type:"primary",onClick:F,style:{marginBottom:"10px",width:"100%"},children:"Replicar Horários"}),e.jsx("div",{children:R.map(t=>{var s,r,l,j;return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[e.jsx("input",{type:"checkbox",checked:t.ativo,onChange:()=>L(t.id,!t.ativo)}),e.jsx("span",{style:{marginLeft:"10px"},children:t.dia})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(W,{disabled:!t.ativo,format:"HH:mm",placeholder:"Início AM",onChange:S=>$(t.id,"startam",S),value:(s=d[t.id])!=null&&s.startam?A(d[t.id].startam,"HH:mm"):null,onFocus:()=>M(t.id,"startam")}),e.jsx(W,{disabled:!t.ativo,format:"HH:mm",placeholder:"Fim AM",onChange:S=>$(t.id,"endam",S),value:(r=d[t.id])!=null&&r.endam?A(d[t.id].endam,"HH:mm"):null,onFocus:()=>M(t.id,"endam")}),e.jsx(W,{disabled:!t.ativo,format:"HH:mm",placeholder:"Início PM",onChange:S=>$(t.id,"startpm",S),value:(l=d[t.id])!=null&&l.startpm?A(d[t.id].startpm,"HH:mm"):null,onFocus:()=>M(t.id,"startpm")}),e.jsx(W,{disabled:!t.ativo,format:"HH:mm",placeholder:"Fim PM",onChange:S=>$(t.id,"endpm",S),value:(j=d[t.id])!=null&&j.endpm?A(d[t.id].endpm,"HH:mm"):null,onFocus:()=>M(t.id,"endpm")})]})]},t.id)})}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("label",{style:{marginRight:"15px"},children:"Intervalo de tempo entre um atendimento e outro:"}),e.jsx(W,{format:"HH:mm",placeholder:"Selecione o intervalo",onChange:P,onFocus:()=>E(null),value:T?A(T,"HH:mm"):null})]})]})},ha=({isLinkModalVisible:i,onLinkModalClose:c})=>{const{authData:o}=K(),k=o.companyID,v=()=>`${window.location.origin}/#/agendar/${k}`,y=()=>{navigator.clipboard.writeText(v()).then(()=>{D.success("Link copiado para a área de transferência!"),c()}).catch(d=>{D.error("Falha ao copiar o link."),console.error("Erro ao copiar o link:",d)})};return e.jsxs(V,{title:"Link do Agendamento Para Clientes !",open:i,onOk:y,onCancel:c,footer:[e.jsx(b,{type:"primary",onClick:y,children:"Copiar Link"},"copy"),e.jsx(b,{onClick:c,children:"Fechar"},"close")],children:[e.jsx("p",{children:"O link a seguir pode ser compartilhado com seus clientes após a configuração da agenda."}),e.jsxs("p",{children:[e.jsx(xe,{})," Copie e compartilhe este link para permitir o agendamento:"]}),e.jsx(I,{value:v(),readOnly:!0})]})};const{Option:fa}=ve,ga=()=>{A.locale("pt-br");const[i,c]=a.useState(window.innerWidth<768),[o,k]=a.useState(!1),[v,y]=a.useState(null),[d,m]=a.useState(null),[T,E]=a.useState(!1),[P,z]=a.useState(null),[M,R]=a.useState([]),[L,_]=a.useState(!1),[$,F]=a.useState([]),[t,s]=a.useState(null),[r,l]=a.useState(!1),{authData:j}=K(),S=j.companyID,[H,N]=a.useState(),[B,C]=a.useState([{target:".select-professional",content:"Primeiro, selecione um profissional da lista."},{target:".weekly-pattern-button",content:"Agora, clique aqui para definir o padrão semanal de horários."},{target:".generate-link-button",content:"Por fim, clique aqui para gerar um link de agendamento para os clientes, compartilhe o link nas suas redes sociais."}]),h={next:"Próximo ➡️",last:"Blz 😊",skip:"Fazer depois 😞",close:"Close"};a.useEffect(()=>{(async()=>{if(S&&j.authToken)try{const x=await w.get(`/professionals?company_id=${S}`,{headers:{Authorization:`Bearer ${j.authToken}`}});if(x.status!==200)throw new Error("Falha ao buscar dados dos profissionais");const Se=oe.AES.decrypt(x.data,"%A0533266q6td9g*"),Ee=JSON.parse(Se.toString(oe.enc.Utf8));F(Ee)}catch(x){console.error("Error fetching professionals:",x)}else console.error("Company ID or auth token not found in local storage")})()},[S,j.authToken]),a.useEffect(()=>{const n=()=>c(window.innerWidth<768);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]);const f=n=>{const{status:x}=n;(x==="finished"||x==="skipped")&&N(!1)},[u,O]=a.useState(null),J=n=>{z(A(n.date,"DD/MM/YYYY")),E(n.allDay),y(n.startTime?A(n.startTime,"HH:mm"):null),m(n.endTime?A(n.endTime,"HH:mm"):null),O(n.id),k(!0)},[Z,U]=a.useState(!1),[G,ee]=a.useState(null),Q=n=>{ee(n),U(!0)},ae=async()=>{if(U(!1),G)try{await w.delete(`/disabledDates/${G}`),R(n=>n.filter(x=>x.id!==G)),D.success("Data excluída com sucesso!")}catch(n){console.error("Erro ao excluir data",n),D.error("Erro ao excluir data. Tente novamente.")}ee(null),z(null),E(!1),y(null),m(null)},g=n=>{Q(n)},p=[{title:"Data",dataIndex:"date",key:"date",render:(n,x)=>A(x.date,"DD/MM/YYYY").format("DD [de] MMMM YYYY")},...i?[]:[{title:"Dia da Semana",dataIndex:"weekday",key:"weekday",render:(n,x)=>A(x.date,"DD/MM/YYYY").format("dddd")}],{title:i?"Intervalo":"Intervalo de Tempo",dataIndex:"time",key:"time",render:(n,x)=>x.allday?"Todo o dia":x.starttime&&x.endtime?`${x.starttime.slice(0,5)} - ${x.endtime.slice(0,5)}`:"Não especificado"},{title:"Ações",key:"action",render:(n,x)=>e.jsxs(e.Fragment,{children:[e.jsx(b,{icon:e.jsx(Ne,{}),onClick:()=>J(x),type:"primary",title:"Editar horário",style:{marginLeft:"10px"},children:i?"":"Editar"}),e.jsx(b,{icon:e.jsx(ie,{}),onClick:()=>g(x.id),type:"primary",danger:!0,title:"Excluir",style:{marginLeft:"10px"},children:i?"":"Excluir"})]})}],te=()=>{k(!0),O(null),z(null)},X=()=>{ke(),k(!1)},se=()=>{k(!1),O(null)},je=()=>!P||!T&&(!v||!d),Ce=n=>{E(n),n&&(y(null),m(null))},be=()=>{_(!0)};a.useEffect(()=>{(async()=>{if(t)try{const x=await w.get(`/disabledDates?professional_id=${t}`);R(x.data)}catch(x){console.error("Erro ao buscar datas desabilitadas",x)}})()},[t]);const ke=async()=>{if(P&&t)try{const n=v||d,x={date:P.format("DD/MM/YYYY"),allDay:n?!1:T,startTime:v?v.format("HH:mm"):null,endTime:d?d.format("HH:mm"):null,professional_id:t};let ne;u?(ne=await w.put(`/disabledDates/${u}`,x),D.success("Data atualizada com sucesso!")):(ne=await w.post("/disabledDates",x),D.success("Data salva com sucesso!")),z(null),E(!1),y(null),m(null),O(null)}catch(n){console.error("Erro ao salvar data",n),D.error("Erro ao salvar data. Tente novamente.")}else D.warning("Selecione um profissional e uma data para prosseguir.")};return a.useEffect(()=>{localStorage.getItem("tutorialShown")||(N(!0),localStorage.setItem("tutorialShown","true"))},[]),e.jsxs("div",{children:[e.jsxs("h1",{children:["Controle da Agenda ",e.jsx(ze,{})]}),e.jsxs("p",{children:["Aqui você inclui seu padrão de atendiemnto semanal que ficará disponivel no link de agendamento.",e.jsx(Pe,{})]}),e.jsxs("div",{className:"padrao-semanal-mobile",children:[e.jsx(ve,{className:"select-professional",showSearch:!0,style:{width:200,marginBottom:20,marginRight:20,display:"flex",flexWrap:"wrap"},placeholder:"Selecione um profissional",optionFilterProp:"children",onChange:n=>s(n),filterOption:(n,x)=>x.children.toLowerCase().indexOf(n.toLowerCase())>=0,value:t,children:$.map(n=>e.jsx(fa,{value:n.id,children:n.nome},n.id))}),e.jsx(b,{className:"weekly-pattern-button",type:"primary",onClick:be,disabled:!t,children:"Padrão Semanal"})]}),e.jsxs(V,{title:"Desabilitar Data ou Horário",visible:o,onOk:X,onCancel:se,okButtonProps:{disabled:je()},children:[e.jsxs("p",{children:["Ao executar essa ação os seus clientes não conseguirão agendar na data ou horários selecionados ",e.jsx(re,{twoToneColor:"#ff0000"})]}),e.jsx(Me,{format:"DD/MM/YYYY",value:P,onChange:z,disabled:!!u}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",checked:T,onChange:n=>Ce(n.target.checked)})," Todos os horários."]}),e.jsxs("p",{children:["Escolha Hora Inicial 00:00 para intervalos no inicio do dia ",e.jsx(re,{twoToneColor:"#ff0000"})]}),!T&&e.jsxs("div",{children:[e.jsx(W,{format:"HH:mm",onChange:y,placeholder:"Hora Inicial"}),e.jsx(W,{format:"HH:mm",onChange:m,placeholder:"Hora Final"})]})]}),e.jsx(V,{title:"Vai disponibilizar este dia/horário?",visible:Z,onOk:ae,onCancel:()=>U(!1),footer:[e.jsx(b,{onClick:()=>U(!1),children:"Não"},"back"),e.jsx(b,{type:"primary",onClick:ae,children:"Sim"},"submit")],children:e.jsx("p",{children:"Ao executar esta ação o horário selecionado ficará disponível para os seus clientes, tem certeza que deseja prosseguir? "})}),e.jsx(ua,{isVisible:L,setIsVisible:_,selectedProfessional:t}),e.jsxs("div",{className:"datadesabilitados",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[e.jsx("h2",{style:{marginRight:"18px",fontSize:"18px"},children:"Datas ou Horário Desabilitadas"}),e.jsxs(b,{type:"primary",onClick:te,style:{marginRight:"10px"},children:[e.jsx(ea,{}),"Incluir"]})]}),e.jsxs("p",{children:["Feriados locais precisam ser incluídos manualmente ",e.jsx(re,{twoToneColor:"#ff0000"})]}),e.jsxs(b,{className:"generate-link-button",style:{marginBottom:"20px"},type:"primary",onClick:()=>l(!0),children:[e.jsx(xe,{})," Gerar Link de Agendamento"]}),r&&e.jsx(ha,{isLinkModalVisible:r,onLinkModalClose:()=>l(!1),companyID:S}),e.jsx(de,{dataSource:M,columns:p,rowKey:"id"})]}),e.jsx(ye,{run:H,steps:B,callback:f,continuous:!0,showProgress:!0,locale:h,showSkipButton:!0,styles:{options:{zIndex:1e4}}})]})},xa=()=>{const[i,c]=a.useState([]),[o,k]=a.useState(null),{authData:v}=K(),y=v.companyID;a.useEffect(()=>{(async()=>{try{const T=await w.get(`/chamados/${y}`);c(T.data)}catch{D.error("Erro ao buscar chamados")}})()},[y]);const d=[{title:"Número do Chamado",dataIndex:"ticket_number",key:"ticket_number"},{title:"Data de Abertura",dataIndex:"created_at",key:"created_at",render:m=>new Date(m).toLocaleDateString()},{title:"Status",dataIndex:"status",key:"status",render:m=>e.jsx(ce,{title:m===null?"A Iniciar":m===1?"Em Andamento":"Concluído",children:e.jsxs("span",{children:[m===null?e.jsx(Le,{style:{color:"red",marginRight:8}}):m===1?e.jsx(Be,{style:{color:"orange",marginRight:8}}):e.jsx(Oe,{style:{color:"green",marginRight:8}}),m===null?"A Iniciar":m===1?"Em Andamento":"Concluído"]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs("h1",{children:["Chamados ",e.jsx(sa,{})]}),e.jsx(de,{columns:d,dataSource:i,onRow:m=>({onClick:()=>{k(m)}})}),e.jsxs(V,{title:`Chamado ${o==null?void 0:o.ticket_number}`,open:!!o,onCancel:()=>k(null),footer:null,children:[e.jsx("p",{children:e.jsx("b",{children:"Seu relato:"})}),e.jsx("p",{children:o==null?void 0:o.description}),e.jsx("p",{children:e.jsx("b",{children:"Resposta:"})}),e.jsx("p",{children:(o==null?void 0:o.answer)===null?"Seu chamado logo será atendido e faremos o impossível para solucionar sua demanda.":o==null?void 0:o.answer})]})]})};function Mt(){const[i,c]=a.useState(window.innerWidth<768),[o,k]=a.useState(!1),[v,y]=a.useState(!1),[d,m]=a.useState([]),[T,E]=a.useState(null),[P,z]=a.useState(!1),[M,R]=a.useState(null),[L,_]=a.useState(null),[$,F]=a.useState(!1),[t,s]=a.useState(!1),{authData:r}=K(),l=r.companyID,j=r.userSpecialties,S={next:"Proceed",last:"Blz 😊",skip:"Not Now",close:"Close"},[H,N]=a.useState([{target:".add-professional-button",content:'Clique aqui para adicionar um novo profissional ao sistema, faça o cadastro com atenção incluindo todos os dados. Em seguida clique em "Controle da Agenda"'}]);a.useEffect(()=>{localStorage.getItem("configsTutorialShown")||(s(!0),localStorage.setItem("configsTutorialShown","true"))},[]);const B=g=>{const{status:p}=g;(p==="finished"||p==="skipped")&&s(!1)},C=g=>{m(T?d.map(p=>p.id===g.id?g:p):[...d,g]),J()};a.useEffect(()=>{(async()=>{if(l&&r.authToken){y(!0);try{const te=(await w.get(`/companies/${l}`,{headers:{Authorization:`Bearer ${r.authToken}`}})).data.service_id,X=await w.get(`/service_details/${te}`,{headers:{Authorization:`Bearer ${r.authToken}`}});_(X.data.persons)}catch(p){console.error("Erro ao buscar o número máximo de profissionais:",p),D.error("Erro ao buscar informações do serviço")}finally{y(!1)}}})()},[l,r.authToken]),a.useEffect(()=>{(async()=>{try{const p=await w.get("/companies/1");R(p.data)}catch(p){console.error("Erro ao buscar dados da empresa:",p),D.error("Erro ao buscar dados da empresa")}})()},[]);const h=()=>{z(!1)};a.useEffect(()=>{(async()=>{if(l&&r.authToken){y(!0);try{const p=await w.get(`/professionals?company_id=${l}`,{headers:{Authorization:`Bearer ${r.authToken}`}}),X=oe.AES.decrypt(p.data,"%A0533266q6td9g*"),se=JSON.parse(X.toString(oe.enc.Utf8));m(se)}catch(p){p.response?console.error("API response error:",p.response):console.error("Error fetching professionals:",p)}finally{y(!1)}}else console.error("Company ID or auth token not found in local storage")})()},[l,r.authToken]),a.useEffect(()=>{const g=()=>c(window.innerWidth<768);return window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]);const f=()=>{if(d.length>=L){F(!0);return}E(null),k(!0)},u=()=>{we("/upgrade"),F(!1)},O=()=>{F(!1)},J=()=>{k(!1),E(null)},Z=g=>{E(g),k(!0)},U=g=>{V.confirm({title:"Tem certeza que deseja excluir este profissional? 😢",content:"Remarque os clientes ja agendados para outro Profissional, Fazendo isso, todos os horários referentes a ele ficarão indisponíveis para os clientes!",okText:"Excluir",okType:"danger",cancelText:"Cancelar",onOk(){G(g.id)}})},G=async g=>{y(!0);try{await w.delete(`/professionals/${g}`),m(d.filter(p=>p.id!==g)),D.success("Profissional excluído com sucesso")}catch(p){console.error("Erro ao excluir o profissional:",p),D.error("Erro ao excluir o profissional")}finally{y(!1)}},ee=g=>{const p=g.split(" ");return p.length>2?`${p[0]} ${p[1]}`:g};let Q=[{title:"Nome",dataIndex:"nome",key:"nome",render:g=>i?ee(g):g}];i||Q.push({title:"Celular",dataIndex:"celular",key:"celular"},{title:"Registro Profissional",dataIndex:"registro_profissional",key:"registro_profissional"}),Q.push({title:"Ação",key:"action",render:(g,p)=>e.jsxs(e.Fragment,{children:[e.jsx(De,{to:`/professionals/${p.id}`,style:{marginRight:8},children:i?e.jsx(b,{icon:e.jsx(pe,{}),onClick:()=>Z(p)}):e.jsxs(b,{type:"primary",onClick:()=>Z(p),children:[e.jsx(pe,{})," Editar"]})}),i?e.jsx(b,{icon:e.jsx(ie,{}),type:"primary",danger:!0,onClick:()=>U(p)}):e.jsxs(b,{type:"primary",danger:!0,onClick:()=>U(p),children:[e.jsx(ie,{})," Excluir"]})]})});const ae=[{key:"1",tab:i?"Profissionais":"Controle de Profissionais",content:e.jsxs(e.Fragment,{children:[e.jsxs("h1",{children:["Controle de Profissionais ",e.jsx(Ge,{})]}),e.jsx("p",{children:"Aqui você pode adicionar profissionais ou atualizar seus dados."}),e.jsxs(b,{className:"add-professional-button",style:{marginBottom:"10px"},type:"primary",onClick:f,children:[e.jsx(Te,{}),"Adicionar Profissional"]}),e.jsxs(V,{title:"Limite de Profissionais Atingido",visible:$,onCancel:O,footer:[e.jsx(b,{onClick:O,children:"Cancelar"},"back"),e.jsx(b,{type:"primary",onClick:u,children:"Fazer Upgrade"},"submit")],children:[e.jsxs("p",{children:["Seu plano contratado só permite até ",L," profissionais. Caso sua clínica esteja crescendo, faça um upgrade do seu plano."]}),e.jsx($e,{maxProfessionals:L})]}),e.jsx(Ie,{isVisible:o,onClose:J,initialData:T,userSpecialties:j,onProfessionalSaved:C}),e.jsx(ma,{isVisible:P,onClose:h,company:M}),v?e.jsx(le,{size:"large"}):e.jsx(de,{dataSource:d,columns:Q,rowKey:"id"})]})},{key:"2",tab:i?"Agenda":"Controle da Agenda",content:e.jsx(e.Fragment,{children:e.jsx(ga,{})})},{key:"3",tab:i?"Empresa":"Dados Empresa",content:e.jsx(e.Fragment,{children:e.jsx(pa,{})})},!i&&{key:"4",tab:"Chamados",content:e.jsx(e.Fragment,{children:e.jsx(xa,{})})},!i&&{key:"5",tab:"Meu Plano",content:e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx(He,{})})}].filter(Boolean);return e.jsxs("div",{className:"tabela",children:[e.jsxs("h3",{children:["Navegue entre as opções abaixo ",e.jsx(Ae,{})]}),e.jsx(me,{defaultActiveKey:"1",className:"custom-tab-class",type:"card",style:{margin:"2rem 0 0 0"},children:ae.map(g=>e.jsx(me.TabPane,{tab:g.tab,children:g.content},g.key))}),e.jsx(ye,{run:t,steps:H,callback:B,continuous:!0,showSkipButton:!0,locale:S,styles:{options:{zIndex:1e4}}})]})}export{Mt as default};
