import{r as a,d as ee,j as i}from"./index-kPzU05gx.js";import{a as N}from"./api-p_bhudRe.js";import{F as C}from"./index-COTnBvfG.js";import{C as oe,E as te}from"./ExclamationCircleFilled-C5haNHtp.js";import{r as ne,C as re}from"./render-CJmks47J.js";import{C as se}from"./KeyCode-Bp2GxRS5.js";import{I as ie}from"./InfoCircleFilled-aimHxtz3.js";import{c as A}from"./AntdIcon-rDAQJIgd.js";import{g as ae,r as le,u as H,C as ce,A as de,n as me,q as ue,G as pe,v as ge}from"./useSize-Dir-JjEK.js";import{p as fe}from"./PurePanel-DZZoC6Qu.js";import{I as _}from"./index-DdU0LtvV.js";import{I as k}from"./index-DTCjzQCT.js";import{B as O}from"./context-Cu6KQni0.js";import{T as ye}from"./Table-B0u-CeGd.js";import{M as F}from"./index-DmsyNvo6.js";import{s as j}from"./index-DkzRl__G.js";import{B as he}from"./BarChartOutlined-D9CNPEco.js";import{W as xe}from"./WarningOutlined-CuxWXMQ9.js";import"./index-DvbXQ1GL.js";import"./index-DSAf5tNC.js";import"./useForm-sTvtv3Iy.js";import"./row-BdR9_GnZ.js";import"./responsiveObserver-BuWZJpCK.js";import"./useLocale-D_rXO8QB.js";import"./Serializer-CQbcCsmu.js";import"./SearchOutlined-BKygTbfa.js";import"./index-CDd_3z3j.js";import"./Overflow-DH1nb5VS.js";import"./CheckOutlined-CJXAI-D_.js";import"./index-BxaDw8tE.js";import"./index-qm-UxHX_.js";import"./EllipsisOutlined-CT_kym8T.js";import"./Dropdown-BnNsehg0.js";import"./useForceUpdate-B--ZqLvt.js";import"./index-C_g5XK6A.js";import"./context-Cq6TeAM8.js";const B=(e,o,r,t,s)=>({background:e,border:`${H(t.lineWidth)} ${t.lineType} ${o}`,[`${s}-icon`]:{color:r}}),Ie=e=>{const{componentCls:o,motionDurationSlow:r,marginXS:t,marginSM:s,fontSize:u,fontSizeLG:m,lineHeight:p,borderRadiusLG:x,motionEaseInOutCirc:f,withDescriptionIconSize:y,colorText:I,colorTextHeading:b,withDescriptionPadding:d,defaultPadding:S}=e;return{[o]:Object.assign(Object.assign({},le(e)),{position:"relative",display:"flex",alignItems:"center",padding:S,wordWrap:"break-word",borderRadius:x,[`&${o}-rtl`]:{direction:"rtl"},[`${o}-content`]:{flex:1,minWidth:0},[`${o}-icon`]:{marginInlineEnd:t,lineHeight:0},"&-description":{display:"none",fontSize:u,lineHeight:p},"&-message":{color:b},[`&${o}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${r} ${f}, opacity ${r} ${f},
        padding-top ${r} ${f}, padding-bottom ${r} ${f},
        margin-bottom ${r} ${f}`},[`&${o}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${o}-with-description`]:{alignItems:"flex-start",padding:d,[`${o}-icon`]:{marginInlineEnd:s,fontSize:y,lineHeight:0},[`${o}-message`]:{display:"block",marginBottom:t,color:b,fontSize:m},[`${o}-description`]:{display:"block",color:I}},[`${o}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},ve=e=>{const{componentCls:o,colorSuccess:r,colorSuccessBorder:t,colorSuccessBg:s,colorWarning:u,colorWarningBorder:m,colorWarningBg:p,colorError:x,colorErrorBorder:f,colorErrorBg:y,colorInfo:I,colorInfoBorder:b,colorInfoBg:d}=e;return{[o]:{"&-success":B(s,t,r,e,o),"&-info":B(d,b,I,e,o),"&-warning":B(p,m,u,e,o),"&-error":Object.assign(Object.assign({},B(y,f,x,e,o)),{[`${o}-description > pre`]:{margin:0,padding:0}})}}},Ce=e=>{const{componentCls:o,iconCls:r,motionDurationMid:t,marginXS:s,fontSizeIcon:u,colorIcon:m,colorIconHover:p}=e;return{[o]:{"&-action":{marginInlineStart:s},[`${o}-close-icon`]:{marginInlineStart:s,padding:0,overflow:"hidden",fontSize:u,lineHeight:H(u),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${r}-close`]:{color:m,transition:`color ${t}`,"&:hover":{color:p}}},"&-close-text":{color:m,transition:`color ${t}`,"&:hover":{color:p}}}}},be=e=>({withDescriptionIconSize:e.fontSizeHeading3,defaultPadding:`${e.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`}),Se=ae("Alert",e=>[Ie(e),ve(e),Ce(e)],be);var D=function(e,o){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&o.indexOf(t)<0&&(r[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,t=Object.getOwnPropertySymbols(e);s<t.length;s++)o.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(e,t[s])&&(r[t[s]]=e[t[s]]);return r};const $e={success:oe,info:ie,error:re,warning:te},je=e=>{const{icon:o,prefixCls:r,type:t}=e,s=$e[t]||null;return o?ne(o,a.createElement("span",{className:`${r}-icon`},o),()=>({className:A(`${r}-icon`,{[o.props.className]:o.props.className})})):a.createElement(s,{className:`${r}-icon`})},Ee=e=>{const{isClosable:o,prefixCls:r,closeIcon:t,handleClose:s,ariaProps:u}=e,m=t===!0||t===void 0?a.createElement(se,null):t;return o?a.createElement("button",Object.assign({type:"button",onClick:s,className:`${r}-close-icon`,tabIndex:0},u),m):null},we=e=>{const{description:o,prefixCls:r,message:t,banner:s,className:u,rootClassName:m,style:p,onMouseEnter:x,onMouseLeave:f,onClick:y,afterClose:I,showIcon:b,closable:d,closeText:S,closeIcon:$,action:q}=e,M=D(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action"]),[w,z]=a.useState(!1),l=a.useRef(null),{getPrefixCls:c,direction:E,alert:n}=a.useContext(ce),g=c("alert",r),[L,Q,V]=Se(g),G=h=>{var v;z(!0),(v=e.onClose)===null||v===void 0||v.call(e,h)},T=a.useMemo(()=>e.type!==void 0?e.type:s?"warning":"info",[e.type,s]),X=a.useMemo(()=>typeof d=="object"&&d.closeIcon||S?!0:typeof d=="boolean"?d:$!==!1&&$!==null&&$!==void 0?!0:!!(n!=null&&n.closable),[S,$,d,n==null?void 0:n.closable]),P=s&&b===void 0?!0:b,K=A(g,`${g}-${T}`,{[`${g}-with-description`]:!!o,[`${g}-no-icon`]:!P,[`${g}-banner`]:!!s,[`${g}-rtl`]:E==="rtl"},n==null?void 0:n.className,u,m,V,Q),U=fe(M,{aria:!0,data:!0}),J=a.useMemo(()=>{var h,v;return typeof d=="object"&&d.closeIcon?d.closeIcon:S||($!==void 0?$:typeof(n==null?void 0:n.closable)=="object"&&(!((h=n==null?void 0:n.closable)===null||h===void 0)&&h.closeIcon)?(v=n==null?void 0:n.closable)===null||v===void 0?void 0:v.closeIcon:n==null?void 0:n.closeIcon)},[$,d,S,n==null?void 0:n.closeIcon]),Y=a.useMemo(()=>{const h=d??(n==null?void 0:n.closable);return typeof h=="object"?D(h,["closeIcon"]):{}},[d,n==null?void 0:n.closable]);return L(a.createElement(de,{visible:!w,motionName:`${g}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:h=>({maxHeight:h.offsetHeight}),onLeaveEnd:I},h=>{let{className:v,style:Z}=h;return a.createElement("div",Object.assign({ref:l,"data-show":!w,className:A(K,v),style:Object.assign(Object.assign(Object.assign({},n==null?void 0:n.style),p),Z),onMouseEnter:x,onMouseLeave:f,onClick:y,role:"alert"},U),P?a.createElement(je,{description:o,icon:e.icon,prefixCls:g,type:T}):null,a.createElement("div",{className:`${g}-content`},t?a.createElement("div",{className:`${g}-message`},t):null,o?a.createElement("div",{className:`${g}-description`},o):null),q?a.createElement("div",{className:`${g}-action`},q):null,a.createElement(Ee,{isClosable:X,prefixCls:g,closeIcon:J,handleClose:G,ariaProps:Y}))}))},R=we;let Ne=function(e){me(o,e);function o(){var r;return ue(this,o),r=pe(this,o,arguments),r.state={error:void 0,info:{componentStack:""}},r}return ge(o,[{key:"componentDidCatch",value:function(t,s){this.setState({error:t,info:s})}},{key:"render",value:function(){const{message:t,description:s,children:u}=this.props,{error:m,info:p}=this.state,x=p&&p.componentStack?p.componentStack:null,f=typeof t>"u"?(m||"").toString():t,y=typeof s>"u"?x:s;return m?a.createElement(R,{type:"error",message:f,description:a.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},y)}):u}}]),o}(a.Component);const ke=Ne,W=R;W.ErrorBoundary=ke;const qe=W,go=()=>{const[e]=C.useForm(),[o,r]=a.useState([]),[t,s]=a.useState(0),[u,m]=a.useState(!1),[p,x]=a.useState(null),{authData:f}=ee(),y=f.companyID,I=async()=>{try{const l=await N.get("/stock-items",{params:{company_id:y}});r(l.data);const c=l.data.filter(E=>E.quantidade<=E.limite_estoque).length;s(c)}catch(l){j.error({message:"Erro ao carregar itens de estoque",description:l.message})}},b=async l=>{try{const c=await N.post("/stock-items",{...l,company_id:y});r([...o,c.data]),e.resetFields(),j.success({message:"Item adicionado com sucesso!"})}catch(c){j.error({message:"Erro ao adicionar item",description:c.message})}},d=async(l,c)=>{try{await N.put(`/stock-items/${l}`,{quantidade:c}),I(),j.success({message:"Quantidade atualizada com sucesso!"})}catch(E){j.error({message:"Erro ao atualizar quantidade",description:E.message})}},S=l=>{F.confirm({title:"Tem certeza que deseja excluir o item selecionado?",okText:"Sim",cancelText:"Não",onOk:async()=>{try{await N.delete(`/stock-items/${l}`),I(),j.success({message:"Item excluído com sucesso!"})}catch(c){j.error({message:"Erro ao excluir item",description:c.message})}}})},$=l=>{x(l),m(!0)},q=l=>l.quantidade<=l.limite_estoque?"low-stock":"",M=async l=>{try{await N.put(`/stock-items/${p.id}`,l),I(),w(),j.success({message:"Item atualizado com sucesso!"})}catch(c){j.error({message:"Erro ao atualizar item",description:c.message})}};a.useEffect(()=>{y&&I()},[y]);const w=()=>{e.resetFields(),x(null),m(!1)},z=[{title:"Nome",dataIndex:"nome",key:"nome"},{title:"Quantidade",dataIndex:"quantidade",key:"quantidade",render:(l,c)=>i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(k,{min:0,defaultValue:l,onChange:E=>c.newQuantity=E,style:{marginRight:10}}),i.jsx(O,{onClick:()=>d(c.id,c.newQuantity),type:"primary",children:"Atualizar"})]})},{title:"Aviso de Fim",dataIndex:"limite_estoque",key:"limite_estoque"},{title:"Ação",key:"acao",render:(l,c)=>i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(O,{onClick:()=>$(c),type:"primary",style:{marginRight:10},children:"Alterar"}),i.jsx(O,{onClick:()=>S(c.id),type:"primary",danger:!0,children:"Excluir"})]})}];return i.jsxs("div",{className:"estoque",children:[i.jsxs("h1",{children:["Suprimentos da Clínica ",i.jsx(he,{})]}),t>0&&i.jsx(qe,{message:`Atenção: Existem ${t} itens chegando ao fim!`,type:"warning",showIcon:!0,icon:i.jsx(xe,{}),style:{marginBottom:20}}),i.jsx("p",{children:"Para adicionar um novo item basta preencher os dados abaixo !"}),i.jsxs(C,{form:e,onFinish:b,layout:"inline",children:[i.jsx(C.Item,{name:"nome",rules:[{required:!0,message:"Insira o nome do item!"}],children:i.jsx(_,{placeholder:"Nome do Item"})}),i.jsx(C.Item,{name:"quantidade",rules:[{required:!0,message:"Insira a quantidade!"}],children:i.jsx(k,{style:{width:"105px"},min:1,placeholder:"Quantidade"})}),i.jsx(C.Item,{name:"limite_estoque",rules:[{required:!0,message:"Insira o limite de estoque!"}],children:i.jsx(k,{style:{width:"105px"},min:0,placeholder:"Aviso de Fim"})}),i.jsx(C.Item,{children:i.jsx(O,{type:"primary",htmlType:"submit",children:"Adicionar Item"})})]}),i.jsx(ye,{style:{marginTop:"20px"},dataSource:o,columns:z,rowKey:"id",rowClassName:q}),u&&i.jsx(F,{title:"Editar Item",open:u,onCancel:w,onOk:()=>e.submit(),children:i.jsxs(C,{form:e,initialValues:p,onFinish:M,children:[i.jsx(C.Item,{name:"nome",label:"Nome",rules:[{required:!0}],children:i.jsx(_,{})}),i.jsx(C.Item,{name:"quantidade",label:"Quantidade",rules:[{required:!0}],children:i.jsx(k,{min:1})}),i.jsx(C.Item,{name:"limite_estoque",label:"Aviso de Fim",rules:[{required:!0}],children:i.jsx(k,{min:0})})]})})]})};export{go as default};
