import{r,d as Ke,u as Qe,e as Xe,j as e,c as h,B as Ye}from"./index-F_APLYFk.js";import{R as Ze}from"./index-BXhJrqF1.js";/* empty css                     */import{A as te,_ as re}from"./AntdIcon-Dm9H8mJU.js";import{B as f}from"./context-BBgDGUKR.js";import{u as He}from"./useForm-ByqIYigZ.js";import{S as ea,R as aa}from"./resetDoctorPassword-DI6lkRyL.js";import{s as q}from"./styled-components.browser.esm-Dscn1jK2.js";import{I as l}from"./index-CF94sgcy.js";import{S as x}from"./index-DiInJGef.js";import{T as ae}from"./index-ZuMCXK86.js";import{T as se}from"./index-C__zbDOQ.js";import{M as N}from"./index-CuE4LayX.js";import{U as sa}from"./index-ClTbX5-I.js";import{m as g}from"./index-BZ8NrSYz.js";import{s as V}from"./index-BSshCDlB.js";import{U as oa}from"./UploadOutlined-DyclOumx.js";import"./index-Chjiymov.js";import"./useSize-CS2hrim6.js";import"./Serializer-CQbcCsmu.js";import"./render-BLHg8_GC.js";import"./LockOutlined-CL2uAh3Q.js";import"./SearchOutlined-DT7IAkrq.js";import"./index-Cz3MuDBw.js";import"./KeyCode-BGAGjcbr.js";import"./PurePanel-B5Kw681a.js";import"./Overflow-BJpsyGVy.js";import"./useLocale-Ds0JCdav.js";import"./CheckOutlined-DjblNYZ6.js";import"./EllipsisOutlined-DDzN43b1.js";import"./PlusOutlined-DqtbK4e0.js";import"./Dropdown-Cf0ZhVYL.js";import"./ExclamationCircleFilled-CJs6dt2B.js";import"./InfoCircleFilled-D7yE8Sak.js";import"./useForceUpdate-CIBrDK4H.js";import"./useNotification-B5cApIMQ.js";var ta={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.68 160.68 0 000-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3 0 66.2 53.8 120 120 120s120-53.8 120-120-53.8-120-120-120zm0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52-52-23.3-52-52 23.3-52 52-52zM312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88 88 39.5 88 88-39.5 88-88 88zm440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52 52 23.3 52 52-23.3 52-52 52z"}}]},name:"share-alt",theme:"outlined"};const ra=ta;var na=function(w,p){return r.createElement(te,re({},w,{ref:p,icon:ra}))};const ia=r.forwardRef(na);var la={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"};const ca=la;var da=function(w,p){return r.createElement(te,re({},w,{ref:p,icon:ca}))};const ua=r.forwardRef(da),P=q.div`
    display: flex;
    justify-content: space-between;
    margin: 1rem 0;

    input {
        width: 250px;
    }

    select {
        width: 250px;
    }
`,pa=q.div`
  position: relative;
  width: 130px; // Ajuste para o tamanho desejado
  height: 130px; // Ajuste para o tamanho desejado
  border-radius: 50%;
  overflow: hidden;
  border: 2px solid #fff; // Cor da borda
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4); // Sombra para dar profundidade

  img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  .ant-upload {
    color: var(--branco);
  }
  .upload-btn {
    position: absolute;
    bottom: 5px; 
    right: 48px; 
    background: var(--azul);
    padding: 5px 10px;
    border-radius: 20px;
    cursor: pointer;
    
    &:hover {
      background: #4e68fc;
    }
  }
`,oe=q.div`
    display: flex;
    justify-content: space-between;
    flex-direction: column;
    margin: 1rem 0;

    input {
        width: 320px;
    }
`,Za=()=>{const[m,w]=r.useState(window.innerWidth<768),{id:p}=Ke(),ne=Qe(),[t,z]=r.useState(null),[u,O]=r.useState({}),[ha,W]=r.useState(""),E=r.useRef({}),[A,ie]=r.useState([]),[C,U]=r.useState([]),[ma,le]=r.useState([]),[ce,G]=r.useState(""),[de,ue]=r.useState(""),[pe,he]=r.useState(""),[me,fe]=r.useState(""),[ge,xe]=r.useState(""),[je,ve]=r.useState(""),[be,Pe]=r.useState(null),[Ce,T]=r.useState(!1),[R,ye]=r.useState({matricula:"",senha:""}),[Se,we]=r.useState(null),[Ee,D]=r.useState(!1),[n,d]=r.useState({}),[M,$]=r.useState(null),[F,J]=r.useState(null),[_,K]=r.useState(!1),[Q,Ae]=r.useState(null),[X,Y]=r.useState(!1),[De,L]=r.useState(!1),{authData:_e}=Xe(),ke=_e.companyID,[Ie]=He();r.useEffect(()=>{(async()=>{try{const s=await h.get(`/professionals/${p}`);z(s.data),O(s.data),G(s.data.cep||""),s.data.email&&L(!0)}catch(s){console.error("Erro ao buscar detalhes",s),g.error("Erro ao buscar detalhes")}})()},[p]),r.useEffect(()=>{p&&(async()=>{try{const s=await h.get(`/publicProfessionals/professional/${p}`);s.data&&(K(!0),d(s.data))}catch(s){console.error("Erro ao verificar perfil público",s)}})()},[p]),r.useEffect(()=>{(async()=>{try{const i=(await h.get(`/professionals/${p}`)).data;z(i),O(i);const o=await h.get("/planos_medicos");if(o.data&&o.data.length>0){const I=o.data.sort((j,S)=>j.nome==="Particular"?-1:S.nome==="Particular"?1:0);le(I)}ie(o.data);const y=(await h.get(`/professionals/${p}/planos`)).data.map(I=>I.id);U(y)}catch(s){console.error("Erro ao buscar dados",s)}})()},[p]),r.useEffect(()=>{const a=()=>w(window.innerWidth<768);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);const ze=async a=>{const s=a.target.value.replace(/\D/g,"");if(G(s),s.length===8)try{const i=await fetch(`https://viacep.com.br/ws/${s}/json/`);if(!i.ok)throw new Error(`Erro ${i.status}: ${i.statusText}`);const o=await i.json();o.erro?console.error("CEP não encontrado."):(ue(o.logradouro||""),he(o.numero||""),ve(o.bairro||""),fe(o.complemento||""),xe(o.localidade||""),Pe(o.uf||""),c("endereco",o.logradouro||""),c("numero",o.numero||""),c("bairro",o.bairro||""),c("referencia",o.complemento||""),c("cidade",o.localidade||""),c("estado",o.uf||""),Ie.setFieldsValue({endereco:o.logradouro||"",numero:o.numero||"",bairro:o.bairro||"",referencia:o.complemento||"",cidade:o.localidade||"",estado:o.uf||""}))}catch(i){console.error("Erro ao buscar CEP:",i)}},B=async()=>{try{const a={...u,planosSaude:C},s=await h.put(`/professionals/${p}`,a);s.status===200?(g.success("Detalhes atualizados com sucesso!"),z({...t,...a}),u.email&&L(!0)):(console.error("Resposta de erro da API:",s),g.error("Erro ao atualizar detalhes: "+s.statusText))}catch(a){console.error("Erro ao atualizar detalhes",a),g.error("Erro ao atualizar detalhes: "+a.message)}},c=(a,s,i)=>{O(o=>({...o,[a]:s})),i==="email"&&t.email&&!u.email&&L(!0)},Re=()=>{ne(-1)};if(!t)return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(ea,{size:"large"})});const Oe=async a=>{try{const s={...t,assinatura:a};(await h.put(`/professionals/${p}`,s)).status===200?(g.success("Assinatura atualizada com sucesso!"),z({...t,assinatura:a}),Z()):g.error("Não foi possível atualizar a assinatura.")}catch(s){console.error("Erro ao atualizar a assinatura",s),g.error("Erro ao atualizar a assinatura")}},Z=()=>{E.current&&(E.current.clear(),W(""))},Ue=()=>{if(E.current){const s=E.current.getTrimmedCanvas().toDataURL("image/png").split(",")[1];W(s),Oe(s)}},Te=[{key:"1",tab:m?"Detalhes":"Dados Pessoais",content:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("b",{children:"Nome:"})," ",e.jsx(l,{value:u.nome||t.nome,onChange:a=>c("nome",a.target.value)})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Telefone:"})," ",e.jsx(l,{value:u.celular||t.celular,onChange:a=>c("celular",a.target.value)})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Nascimento:"})," ",e.jsx(l,{value:u.data_de_nascimento||t.data_de_nascimento,onChange:a=>c("data_de_nascimento",a.target.value)})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Email:"})," ",e.jsx(l,{value:u.email||t.email,onChange:a=>c("email",a.target.value),disabled:De})]}),e.jsxs("p",{children:[e.jsx("b",{children:"CPF:"})," ",e.jsx(l,{value:u.cpf||t.cpf,onChange:a=>c("cpf",a.target.value),disabled:!0})]}),e.jsx(f,{onClick:B,type:"primary",children:"Salvar"})]})},{key:"2",tab:m?"Profissional":"Informacoes Proffisionais",content:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("b",{children:"Registro Profissional:"})," ",e.jsx(l,{value:u.registro_profissional||t.registro_profissional,onChange:a=>c("registro_profissional",a.target.value)})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Título:"})," ",e.jsx(l,{value:u.titulo||t.titulo,onChange:a=>c("titulo",a.target.value)})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Planos que atende:"}),A&&e.jsx(x,{mode:"multiple",style:{width:"100%"},placeholder:"Selecione os planos de saúde",defaultValue:C,onChange:a=>U(a),children:A.map(a=>e.jsx(x.Option,{value:a.id,children:a.nome},a.id))})]}),e.jsx(f,{onClick:B,type:"primary",children:"Salvar"}),"                "]})},{key:"3",tab:m?"End. Prof":"Endereço Profissional",content:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("b",{children:"CEP:"}),e.jsx(l,{value:ce,onChange:ze})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Rua:"}),e.jsx(l,{value:u.endereco||de,onChange:a=>c("endereco",a.target.value)})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Número:"}),e.jsx(l,{value:u.numero||pe,onChange:a=>c("numero",a.target.value)})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Referência:"}),e.jsx(l,{value:u.referencia||me,onChange:a=>c("referencia",a.target.value)})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Estado:"}),e.jsx(l,{value:u.estado||be,onChange:a=>c("estado",a.target.value)})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Cidade:"}),e.jsx(l,{value:u.cidade||ge,onChange:a=>c("cidade",a.target.value)})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Bairro:"}),e.jsx(l,{value:u.bairro||je,onChange:a=>c("bairro",a.target.value)})]}),e.jsx(f,{onClick:B,type:"primary",children:"Salvar"}),"                "]})},{key:"4",tab:m?"Ass.":"Assinatura",content:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("b",{children:"Assinatura Atual:"})}),t.assinatura&&e.jsx("img",{src:`data:image/png;base64,${t.assinatura}`,alt:"Assinatura",style:{maxWidth:"100%",height:"auto"}}),e.jsx("p",{children:e.jsx("b",{children:"Você pode assinar novamnete para atualizar:"})}),e.jsx("div",{style:{border:"1px solid black",width:m?"75vw":"500px",margin:m?"2px 0 15px 0":"20px",display:"flex",justifyContent:"center"},children:e.jsx(Ze,{ref:E,canvasProps:{width:m?window.innerWidth*.8:500,height:m?window.innerWidth*.4:200,className:"signatureCanvas"}})}),e.jsx(f,{onClick:Z,children:"Limpar"}),e.jsx(f,{onClick:Ue,style:{marginLeft:"10px"},type:"primary",children:"Salvar Assinatura"})]})}].filter(Boolean),Me=()=>{T(!1)},H=a=>{const{name:s,value:i}=a.target;ye(o=>({...o,[s]:i}))},$e=()=>{T(!0)},Fe=async a=>{try{const s=await h.get(`/publicProfessionals/professional/${a}`);if(s.data){if(K(!0),d(s.data),Ae(s.data.id),s.data.foto){const i=`${Ye}/uploads/ProfileDoctor/${s.data.foto.split("/").pop()}`;$(i)}}else d({nome:t.nome,telefone:t.celular,email:t.email,registro_profissional:t.registro_profissional,titulo:t.titulo,planos_que_atende:C.join(", "),endereco:t.endereco,numero:t.numero,bairro:t.bairro,cidade:t.cidade,uf:t.estado,cep:t.cep});D(!0)}catch(s){console.error("Erro ao carregar perfil público",s),d({nome:t.nome,telefone:t.celular,email:t.email,registro_profissional:t.registro_profissional,titulo:t.titulo,planos_que_atende:C.join(", "),endereco:t.endereco,numero:t.numero,bairro:t.bairro,cidade:t.cidade,uf:t.estado,cep:t.cep}),$(null),D(!0)}},Le=async()=>{try{const a=await h.post("/professionals/authenticate",{login:R.matricula,senha:R.senha});a.data.autenticado&&String(a.data.professional_id)===String(p)?(we(a.data.professional_id),T(!1),Fe(a.data.professional_id)):V.error({message:"Você inseriu as credenciais de outro profssional, por favor insira as credenciais do profissional selecionado"})}catch(a){console.error("Erro de autenticação",a),g.error("Erro na autenticação")}},Be=async()=>{N.confirm({title:"Consentimento para Divulgação das Informações",content:"Ao prosseguir, você permite que as informações listadas (nome, contato, especialidade médica, endereço, redes sociais, e detalhes profissionais) sejam publicadas em nossa plataforma, tornando-as visíveis ao público. Esta ação visa facilitar seu encontro por potenciais pacientes.",onOk(){Ne()}})},Ne=async()=>{const a=new FormData,s=C.map(o=>{const k=A.find(y=>y.id===o);return k?k.nome:null}).filter(o=>o!==null).join(", "),i={...n};delete i.company_id,delete i.professional_id,delete i.planos_que_atende,Object.keys(i).forEach(o=>{a.append(o,i[o])}),a.append("planos_que_atende",s),a.append("company_id",ke),a.append("professional_id",Se),F&&a.append("foto",F,F.name);try{let o;_&&Q?o=await h.put(`/publicProfessionals/${Q}`,a,{headers:{"Content-Type":"multipart/form-data"}}):o=await h.post("/publicProfessionals",a,{headers:{"Content-Type":"multipart/form-data"}}),o.status===200||o.status===201?(V.success({message:_?"Perfil atualizado com sucesso!":"Perfil publicado com sucesso!"}),D(!1)):V.error({message:"Erro ao salvar perfil público"})}catch(o){console.error("Erro ao salvar perfil público",o),g.error("Erro ao salvar perfil público: "+o.message)}};function Ve(a,s,i,o,k){const y=new FileReader;y.onload=I=>{const j=new Image;j.onload=()=>{const S=document.createElement("canvas");let v=j.width,b=j.height;v>b?v>s&&(b*=s/v,v=s):b>i&&(v*=i/b,b=i),S.width=v,S.height=b,S.getContext("2d").drawImage(j,0,0,v,b),S.toBlob(Ge=>{const Je=new File([Ge],a.name,{type:a.type,lastModified:Date.now()});k(Je)},a.type,o)},j.src=I.target.result},y.readAsDataURL(a)}const qe=a=>{if(a.fileList.length===0){J(null);return}const s=a.fileList[0].originFileObj;if(!["image/png","image/jpeg","image/jpg"].includes(s.type)){g.error("Por favor, selecione um arquivo PNG, JPG ou JPEG.");return}Ve(s,500,500,1,i=>{const o=URL.createObjectURL(i);$(o),J(i)})},ee=()=>n.nome&&n.especialidade&&n.telefone&&n.atendimento&&M,We=e.jsx(ae,{title:ee()?"":"Preencha todos os campos obrigatórios para continuar",children:e.jsx(f,{type:"primary",onClick:Be,disabled:!ee(),children:_?"Atualizar":"Publicar"})});return e.jsxs("div",{className:"tabela",children:[e.jsxs("h1",{children:["Detalhes do Profissional ",e.jsx(ua,{})]}),e.jsx(f,{onClick:Re,type:"primary",style:{marginRight:"1rem"},children:"Voltar"}),e.jsxs(f,{onClick:$e,type:"primary",children:[_?"Atualizar Perfil Público":"Tornar Público",e.jsx(ia,{})]}),e.jsx(se,{defaultActiveKey:"1",type:"card",style:{margin:"2rem 0 0 0"},children:Te.map(a=>e.jsx(se.TabPane,{tab:a.tab,children:a.content},a.key))}),e.jsxs(N,{title:"Autenticação do Profissional",open:Ce,onCancel:Me,onOk:Le,okText:"Autenticar",cancelText:"Cancelar",children:[e.jsx("p",{children:"Compartilhe suas informações e aumente seu alcance, com isso as pessoas vão poder te achar em nossa plataforma"}),e.jsx("p",{children:"Somente o próprio profissional pode compartilhar suas informações"}),e.jsx(l,{placeholder:"Matrícula",name:"matricula",value:R.matricula,onChange:H,style:{marginBottom:".6rem"}}),e.jsx(l.Password,{placeholder:"Senha",name:"senha",value:R.senha,onChange:H}),e.jsx(f,{type:"link",onClick:()=>Y(!0),style:{marginTop:"1rem"},children:"Esqueci a senha 😥"})]}),e.jsxs(N,{title:"Informações do seu Perfil Publico 🔄",open:Ee,onCancel:()=>D(!1),okText:_?"Atualizar":"Publicar",cancelText:"Cancelar",width:900,footer:[e.jsx(f,{onClick:()=>D(!1),children:"Cancelar"},"back"),We],children:[e.jsx("p",{children:"As informações a seguir serão publicadas em nossa plataforma de agendamentos, possibilitando que pessoas do mundo inteiro te encontrem"}),e.jsxs(P,{children:[e.jsxs(pa,{children:[M&&e.jsx("img",{src:M,alt:"Perfil",style:{maxWidth:"100%",height:"auto"}}),e.jsx(ae,{title:"Alterar foto de perfil",children:e.jsx("div",{className:"upload-btn",children:e.jsx(sa,{beforeUpload:()=>!1,onChange:qe,showUploadList:!1,accept:"image/png, image/jpeg, image/jpg",children:e.jsx(oa,{})})})})]}),e.jsxs(oe,{children:[e.jsx(l,{placeholder:"Nome",value:n.nome,onChange:a=>d({...n,nome:a.target.value})}),e.jsx(l,{placeholder:"Telefone",value:n.telefone,onChange:a=>d({...n,telefone:a.target.value})})]}),e.jsxs(oe,{children:[e.jsx(l,{placeholder:"Email",value:n.email,onChange:a=>d({...n,email:a.target.value})}),e.jsx(l,{placeholder:"Instagram",value:n.instagram,onChange:a=>d({...n,instagram:a.target.value})})]})]}),e.jsxs(P,{children:[e.jsx(l,{placeholder:"Especialidade",value:n.especialidade,onChange:a=>d({...n,especialidade:a.target.value})}),e.jsx(l,{placeholder:"Registro Profissional",value:n.registro_profissional,onChange:a=>d({...n,registro_profissional:a.target.value})}),e.jsx(l,{placeholder:"Título",value:n.titulo,onChange:a=>d({...n,titulo:a.target.value})})]}),e.jsxs(P,{children:[e.jsx(P,{children:A&&e.jsx(x,{mode:"multiple",style:{width:"100%"},placeholder:"Selecione os planos de saúde",defaultValue:C,onChange:a=>U(a),children:A.map(a=>e.jsx(x.Option,{value:a.id,children:a.nome},a.id))})}),e.jsx(P,{children:e.jsxs(x,{placeholder:"Tipo de Atendimento",style:{width:"100%"},onChange:a=>d({...n,atendimento:a}),children:[e.jsx(x.Option,{value:"1",children:"Apenas Presencial"}),e.jsx(x.Option,{value:"2",children:"Apenas Teleconsulta"}),e.jsx(x.Option,{value:"3",children:"Ambos"})]})})]}),e.jsxs(P,{children:[e.jsx(l,{placeholder:"Endereço",value:n.endereco,onChange:a=>d({...n,endereco:a.target.value})}),e.jsx(l,{placeholder:"Número",value:n.numero,onChange:a=>d({...n,numero:a.target.value})}),e.jsx(l,{placeholder:"Bairro",value:n.bairro,onChange:a=>d({...n,bairro:a.target.value})})]}),e.jsxs(P,{children:[e.jsx(l,{placeholder:"Cidade",value:n.cidade,onChange:a=>d({...n,cidade:a.target.value})}),e.jsx(l,{placeholder:"UF",maxLength:2,value:n.uf,onChange:a=>d({...n,uf:a.target.value.toUpperCase()})}),e.jsx(l,{placeholder:"CEP",value:n.cep,onChange:a=>d({...n,cep:a.target.value})})]})]}),X&&e.jsx(aa,{isResetDoctorModalVisible:X,onResetDoctorModalClose:()=>Y(!1)})]})};export{Za as default};
