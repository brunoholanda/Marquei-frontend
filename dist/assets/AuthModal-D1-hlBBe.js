import{r as p,g as Xe,R as Ze,j as n,b as et,u as tt,d as rt,B as W}from"./index-BjWOWftK.js";import{i as nt,W as ot}from"./index-BrP1Cg1Z.js";import{p as at,q as xe,r as it}from"./Styles-HDwQP3Lk.js";import{a as Se}from"./api-yj2qoLPl.js";import{B as N}from"./index-JyjWfW4x.js";import{P as S}from"./index-DREpUMdt.js";import{M as be}from"./index-DZhypcJC.js";import{S as Pe}from"./index-BNxrNzwE.js";import{I as je}from"./index-Dtquuxsa.js";import{B as st}from"./context-CsxF_MV5.js";import{m as _}from"./index-voIPXOLj.js";import{W as we}from"./WarningOutlined-B45VRAgE.js";var ct=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function ae(){return ae=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},ae.apply(this,arguments)}function lt(e,o){if(e==null)return{};var a={},r=Object.keys(e),t,u;for(u=0;u<r.length;u++)t=r[u],!(o.indexOf(t)>=0)&&(a[t]=e[t]);return a}function q(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dt(e,o){e.prototype=Object.create(o.prototype),e.prototype.constructor=e,ie(e,o)}function ie(e,o){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},ie(e,o)}var B=function(e){dt(o,e);function o(){var r;return r=e.call(this)||this,r.handleExpired=r.handleExpired.bind(q(r)),r.handleErrored=r.handleErrored.bind(q(r)),r.handleChange=r.handleChange.bind(q(r)),r.handleRecaptchaRef=r.handleRecaptchaRef.bind(q(r)),r}var a=o.prototype;return a.getCaptchaFunction=function(t){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[t]:this.props.grecaptcha[t]:null},a.getValue=function(){var t=this.getCaptchaFunction("getResponse");return t&&this._widgetId!==void 0?t(this._widgetId):null},a.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},a.execute=function(){var t=this.getCaptchaFunction("execute");if(t&&this._widgetId!==void 0)return t(this._widgetId);this._executeRequested=!0},a.executeAsync=function(){var t=this;return new Promise(function(u,j){t.executionResolve=u,t.executionReject=j,t.execute()})},a.reset=function(){var t=this.getCaptchaFunction("reset");t&&this._widgetId!==void 0&&t(this._widgetId)},a.forceReset=function(){var t=this.getCaptchaFunction("reset");t&&t()},a.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},a.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},a.handleChange=function(t){this.props.onChange&&this.props.onChange(t),this.executionResolve&&(this.executionResolve(t),delete this.executionReject,delete this.executionResolve)},a.explicitRender=function(){var t=this.getCaptchaFunction("render");if(t&&this._widgetId===void 0){var u=document.createElement("div");this._widgetId=t(u,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(u)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},a.componentDidMount=function(){this.explicitRender()},a.componentDidUpdate=function(){this.explicitRender()},a.handleRecaptchaRef=function(t){this.captcha=t},a.render=function(){var t=this.props;t.sitekey,t.onChange,t.theme,t.type,t.tabindex,t.onExpired,t.onErrored,t.size,t.stoken,t.grecaptcha,t.badge,t.hl,t.isolated;var u=lt(t,ct);return p.createElement("div",ae({},u,{ref:this.handleRecaptchaRef}))},o}(p.Component);B.displayName="ReCAPTCHA";B.propTypes={sitekey:S.string.isRequired,onChange:S.func,grecaptcha:S.object,theme:S.oneOf(["dark","light"]),type:S.oneOf(["image","audio"]),tabindex:S.number,onExpired:S.func,onErrored:S.func,size:S.oneOf(["compact","normal","invisible"]),stoken:S.string,hl:S.string,badge:S.oneOf(["bottomright","bottomleft","inline"]),isolated:S.bool};B.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};var Oe={exports:{}},c={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=typeof Symbol=="function"&&Symbol.for,de=f?Symbol.for("react.element"):60103,pe=f?Symbol.for("react.portal"):60106,G=f?Symbol.for("react.fragment"):60107,V=f?Symbol.for("react.strict_mode"):60108,J=f?Symbol.for("react.profiler"):60114,K=f?Symbol.for("react.provider"):60109,Y=f?Symbol.for("react.context"):60110,ue=f?Symbol.for("react.async_mode"):60111,Q=f?Symbol.for("react.concurrent_mode"):60111,X=f?Symbol.for("react.forward_ref"):60112,Z=f?Symbol.for("react.suspense"):60113,pt=f?Symbol.for("react.suspense_list"):60120,ee=f?Symbol.for("react.memo"):60115,te=f?Symbol.for("react.lazy"):60116,ut=f?Symbol.for("react.block"):60121,ft=f?Symbol.for("react.fundamental"):60117,ht=f?Symbol.for("react.responder"):60118,mt=f?Symbol.for("react.scope"):60119;function P(e){if(typeof e=="object"&&e!==null){var o=e.$$typeof;switch(o){case de:switch(e=e.type,e){case ue:case Q:case G:case J:case V:case Z:return e;default:switch(e=e&&e.$$typeof,e){case Y:case X:case te:case ee:case K:return e;default:return o}}case pe:return o}}}function Te(e){return P(e)===Q}c.AsyncMode=ue;c.ConcurrentMode=Q;c.ContextConsumer=Y;c.ContextProvider=K;c.Element=de;c.ForwardRef=X;c.Fragment=G;c.Lazy=te;c.Memo=ee;c.Portal=pe;c.Profiler=J;c.StrictMode=V;c.Suspense=Z;c.isAsyncMode=function(e){return Te(e)||P(e)===ue};c.isConcurrentMode=Te;c.isContextConsumer=function(e){return P(e)===Y};c.isContextProvider=function(e){return P(e)===K};c.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===de};c.isForwardRef=function(e){return P(e)===X};c.isFragment=function(e){return P(e)===G};c.isLazy=function(e){return P(e)===te};c.isMemo=function(e){return P(e)===ee};c.isPortal=function(e){return P(e)===pe};c.isProfiler=function(e){return P(e)===J};c.isStrictMode=function(e){return P(e)===V};c.isSuspense=function(e){return P(e)===Z};c.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===G||e===Q||e===J||e===V||e===Z||e===pt||typeof e=="object"&&e!==null&&(e.$$typeof===te||e.$$typeof===ee||e.$$typeof===K||e.$$typeof===Y||e.$$typeof===X||e.$$typeof===ft||e.$$typeof===ht||e.$$typeof===mt||e.$$typeof===ut)};c.typeOf=P;Oe.exports=c;var yt=Oe.exports,fe=yt,gt={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},vt={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},xt={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Ie={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},he={};he[fe.ForwardRef]=xt;he[fe.Memo]=Ie;function _e(e){return fe.isMemo(e)?Ie:he[e.$$typeof]||gt}var St=Object.defineProperty,bt=Object.getOwnPropertyNames,Re=Object.getOwnPropertySymbols,Pt=Object.getOwnPropertyDescriptor,jt=Object.getPrototypeOf,Ee=Object.prototype;function Ce(e,o,a){if(typeof o!="string"){if(Ee){var r=jt(o);r&&r!==Ee&&Ce(e,r,a)}var t=bt(o);Re&&(t=t.concat(Re(o)));for(var u=_e(e),j=_e(o),E=0;E<t.length;++E){var g=t[E];if(!vt[g]&&!(a&&a[g])&&!(j&&j[g])&&!(u&&u[g])){var w=Pt(o,g);try{St(e,g,w)}catch{}}}}return e}var wt=Ce;const _t=Xe(wt);function se(){return se=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},se.apply(this,arguments)}function Rt(e,o){if(e==null)return{};var a={},r=Object.keys(e),t,u;for(u=0;u<r.length;u++)t=r[u],!(o.indexOf(t)>=0)&&(a[t]=e[t]);return a}function Et(e,o){e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.__proto__=o}var R={},Ot=0;function Tt(e,o){return o=o||{},function(r){var t=r.displayName||r.name||"Component",u=function(E){Et(g,E);function g(v,d){var s;return s=E.call(this,v,d)||this,s.state={},s.__scriptURL="",s}var w=g.prototype;return w.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+Ot++),this.__scriptLoaderID},w.setupScriptURL=function(){return this.__scriptURL=typeof e=="function"?e():e,this.__scriptURL},w.asyncScriptLoaderHandleLoad=function(d){var s=this;this.setState(d,function(){return s.props.asyncScriptOnLoad&&s.props.asyncScriptOnLoad(s.state)})},w.asyncScriptLoaderTriggerOnScriptLoaded=function(){var d=R[this.__scriptURL];if(!d||!d.loaded)throw new Error("Script is not loaded.");for(var s in d.observers)d.observers[s](d);delete window[o.callbackName]},w.componentDidMount=function(){var d=this,s=this.setupScriptURL(),b=this.asyncScriptLoaderGetScriptLoaderID(),h=o,$=h.globalName,k=h.callbackName,A=h.scriptId;if($&&typeof window[$]<"u"&&(R[s]={loaded:!0,observers:{}}),R[s]){var m=R[s];if(m&&(m.loaded||m.errored)){this.asyncScriptLoaderHandleLoad(m);return}m.observers[b]=function(y){return d.asyncScriptLoaderHandleLoad(y)};return}var M={};M[b]=function(y){return d.asyncScriptLoaderHandleLoad(y)},R[s]={loaded:!1,observers:M};var O=document.createElement("script");O.src=s,O.async=!0;for(var F in o.attributes)O.setAttribute(F,o.attributes[F]);A&&(O.id=A);var z=function(C){if(R[s]){var U=R[s],L=U.observers;for(var D in L)C(L[D])&&delete L[D]}};k&&typeof window<"u"&&(window[k]=function(){return d.asyncScriptLoaderTriggerOnScriptLoaded()}),O.onload=function(){var y=R[s];y&&(y.loaded=!0,z(function(C){return k?!1:(C(y),!0)}))},O.onerror=function(){var y=R[s];y&&(y.errored=!0,z(function(C){return C(y),!0}))},document.body.appendChild(O)},w.componentWillUnmount=function(){var d=this.__scriptURL;if(o.removeOnUnmount===!0)for(var s=document.getElementsByTagName("script"),b=0;b<s.length;b+=1)s[b].src.indexOf(d)>-1&&s[b].parentNode&&s[b].parentNode.removeChild(s[b]);var h=R[d];h&&(delete h.observers[this.asyncScriptLoaderGetScriptLoaderID()],o.removeOnUnmount===!0&&delete R[d])},w.render=function(){var d=o.globalName,s=this.props;s.asyncScriptOnLoad;var b=s.forwardedRef,h=Rt(s,["asyncScriptOnLoad","forwardedRef"]);return d&&typeof window<"u"&&(h[d]=typeof window[d]<"u"?window[d]:void 0),h.ref=b,p.createElement(r,h)},g}(p.Component),j=p.forwardRef(function(E,g){return p.createElement(u,se({},E,{forwardedRef:g}))});return j.displayName="AsyncScriptLoader("+t+")",j.propTypes={asyncScriptOnLoad:S.func},_t(j,r)}}var ce="onloadcallback",It="grecaptcha";function le(){return typeof window<"u"&&window.recaptchaOptions||{}}function Ct(){var e=le(),o=e.useRecaptchaNet?"recaptcha.net":"www.google.com";return e.enterprise?"https://"+o+"/recaptcha/enterprise.js?onload="+ce+"&render=explicit":"https://"+o+"/recaptcha/api.js?onload="+ce+"&render=explicit"}const Lt=Tt(Ct,{callbackName:ce,globalName:It,attributes:le().nonce?{nonce:le().nonce}:{}})(B),At=p.forwardRef(({onChange:e},o)=>{const a=Ze.createRef();return p.useImperativeHandle(o,()=>({reset:()=>{a.current&&a.current.reset()}})),n.jsx(Lt,{ref:a,sitekey:"6LdQaYcpAAAAAHaX_ZIhgaOTN0olO9KyoijpMNTH",onChange:e})}),$t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,kt=["gmail.com","yahoo.com","hotmail.com","outlook.com","live.com"],Jt=({isVisible:e,onClose:o,onLoginSuccess:a,selectedService:r})=>{const[t,u]=p.useState(""),[j,E]=p.useState(""),[g,w]=p.useState(null),[v,d]=p.useState(!1),[s,b]=p.useState(!1),[h,$]=p.useState(null),k=et(),{serviceId:A}=k.state||{serviceId:null},[m,M]=p.useState({plan:"",monthlyPrice:0,anualPrice:0}),[O,F]=p.useState(null),[z,y]=p.useState(!1),C=tt(),[U,L]=p.useState([]),[D,Le]=p.useState(""),[Ae,re]=p.useState(!1),{authData:$e}=rt(),ke=$e.companyID,[me,De]=p.useState(""),[ye,ge]=p.useState(""),ne=p.useRef(null),Ne=i=>$t.test(i),Me=i=>{if(i.includes("@")){const l=i.split("@"),x=l[1],T=kt.filter(I=>I.startsWith(x)).map(I=>l[0]+"@"+I);L(T)}else L([])},Fe=i=>{const l=i.target.value;u(l),Me(l)},ze=i=>{u(i),L([])},Ue=async i=>{try{const x=await(await fetch(`${W}/auth/check-email`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,company_id:ke})})).json();w(x.exists),x.exists||(_.info("Seu email não existe em nosso cadastro, por favor faça seu cadastro e aproveite 7 dias grátis para testar o Marquei"),re(!0))}catch(l){_.error("Error checking email: "+l.message)}},He=()=>{C("/cadastro"),re(!1)},We=async i=>{if(i.preventDefault(),!Ne(t)){_.error("Por favor, insira um email valido");return}d(!0),await Ue(t),d(!1)},qe=async i=>{if(i.preventDefault(),d(!0),!ye){De("Por favor, confirme que você não é um robô.");return}try{const l=await fetch(`${W}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:j,recaptchaToken:ye})}),x=await l.json();l.ok?(sessionStorage.setItem("authToken",x.token),b(!0),a(x),oe(r.serviceId)):(_.error(x.message||"Failed to login. Please check your credentials."),ge(""))}catch(l){_.error("An error occurred while trying to log in: "+l.message),ne.current&&ne.current.reset()}d(!1)};p.useEffect(()=>{r.serviceId&&oe(r.serviceId)},[r.serviceId]),p.useEffect(()=>{nt("TEST-c12efe3e-56fd-49b6-a560-dd5d3b700102",{locale:"pt-BR"}),A&&oe(A)},[A]);const oe=async i=>{try{const l=await Se.get(`/service_details/${i}`);M({plan:l.data.plan,monthlyPrice:l.data.price,anualPrice:l.data.anualPrice,persons:l.data.persons}),Le(l.data.preapproval_plan_id)}catch(l){console.error("Erro ao carregar detalhes do serviço:",l)}},Be=async i=>{try{const x=(await Se.post("/create_preference",{itemDetails:i})).data.id;F(x),y(!1),ve()}catch(l){console.error("Erro ao criar a preferência de pagamento:",l),y(!1)}},H=async(i,l)=>{const x=sessionStorage.getItem("authToken");if(i==="monthly"){if(!D){_.error("ID de plano de aprovação prévia não encontrado. Por favor, tente novamente mais tarde.");return}const T={payment_type:"mensal",payment_email:t};try{const I=await fetch(`${W}/companies/updatePaymentInfo`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`},body:JSON.stringify(T)}),Ye=await I.json();if(I.ok){const Qe=`https://www.mercadopago.com/mlb/debits/new?preapproval_plan_id=${D}`;window.location.href=Qe}else _.error(`Erro ao atualizar informações de pagamento: ${Ye.error||"Erro desconhecido"}`)}catch(I){console.error("Erro ao enviar dados de pagamento:",I),_.error("Erro ao enviar informações de pagamento.")}}else{const T={title:`Plano ${m.plan}`,unit_price:i==="anual"?m.anualPrice:m.monthlyPrice,description:`Plano ${m.plan} - ${i==="anual"?"Anual":"Mensal"}`};$(i),y(!0),Be(T)}},Ge=()=>m.monthlyPrice*12-m.anualPrice,ve=async()=>{const i=sessionStorage.getItem("authToken");if(!i){_.error("Você precisa estar logado para realizar o pagamento.");return}const x={payment_type:h==="monthly"?"mensal":"anual",payment_email:t};try{const T=await fetch(`${W}/companies/updatePaymentInfo`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(x)}),I=await T.json();T.ok||_.error(`Erro: ${I.error}`)}catch(T){console.error("Erro ao enviar dados de pagamento:",T),_.error("Erro ao enviar informações de pagamento.")}},Ve=i=>{ve()},Je={visual:{borderRadius:"6px",color:"white"},texts:{action:"pay",valueProp:"security_details"}},Ke=()=>s?h?n.jsxs("div",{children:[n.jsxs("h2",{children:["Você selecionou o ",h==="monthly"?"Plano Mensal":"Plano Anual"," de pagamento"]}),z?n.jsx(Pe,{size:"large"}):h&&O&&n.jsx(ot,{customization:Je,initialization:{preferenceId:O},onPaymentSuccess:Ve}),n.jsxs(it,{children:[n.jsxs("p",{children:["Ao clicar em Pagar você será redirecionado para o ambiente seguro do Mercado Pago, o valor a ser pago no plano anual será  ",n.jsxs("b",{children:["R$ ",m.anualPrice]})," e pode ser parcelado*"]}),n.jsx("p",{children:"Utilize o mesmo e-mail logado no pagamento !"})]}),n.jsx(st,{style:{textAlign:"center",width:"100%",marginTop:"1rem"},onClick:()=>$(null),children:"Alterar Plano de Pagamento"})]}):n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx("h2",{children:"Escolha o tipo de pagamento"}),n.jsxs("p",{children:[n.jsx(we,{})," Ao pagar utilize o mesmo e-mail logado !"]}),n.jsxs(at,{children:[n.jsxs(xe,{selected:h==="anual",onClick:()=>H("anual"),children:[n.jsx("h2",{children:n.jsx("strong",{children:"Plano Anual 🤩"})}),n.jsxs("h3",{children:["Use 12 meses pagando por 10 e Economize R$ ",Ge().toFixed(2)," ao ano!"]}),n.jsxs("h2",{children:["Pagando Apenas R$ ",(m.anualPrice/12).toFixed(2)," por mês"]}),n.jsxs("div",{children:[m.persons," profissional(is) teram acesso a plataforma"]}),n.jsx(N,{onClick:i=>{i.stopPropagation(),H("anual")},children:"Contratar  🤝"})]}),n.jsxs(xe,{selected:h==="monthly",onClick:()=>H("monthly"),children:[n.jsx("h2",{children:n.jsx("strong",{children:"Plano Mensal 💸"})}),n.jsx("h3",{children:"Pagamento mês a mês..."}),n.jsxs("h2",{children:["R$ ",m.monthlyPrice," por mês"]}),n.jsxs("div",{children:[m.persons," profissional(is) teram acesso a plataforma"]}),n.jsx(N,{onClick:i=>{i.stopPropagation(),H("monthly")},children:"Contratar  🤝"})]})]}),n.jsxs("p",{children:[n.jsx(we,{})," Ao pagar utilize o mesmo e-mail logado !"]})]}):n.jsx("div",{children:n.jsxs("form",{onSubmit:We,children:[n.jsx(je,{type:"email",value:t,onChange:Fe,placeholder:"Insira seu E-mail",required:!0,style:{marginBottom:"1rem"}}),U.length>0&&n.jsx("div",{style:{marginTop:"0.5rem",background:"#f7f7f7",padding:"0.5rem"},children:U.map((i,l)=>n.jsx("div",{style:{cursor:"pointer",padding:"0.5rem"},onClick:()=>ze(i),children:i},l))}),g&&n.jsxs(n.Fragment,{children:[n.jsx(je,{style:{marginTop:"1rem"},type:"password",value:j,onChange:i=>E(i.target.value),placeholder:"Insira sua senha",required:!0}),me&&n.jsx("div",{children:me}),n.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"15px 0 10px 0"},children:n.jsx(At,{ref:ne,onChange:i=>ge(i)})}),n.jsx(N,{style:{textAlign:"center",width:"100%",marginTop:"1rem"},type:"primary",onClick:qe,loading:v,children:"Login"})]}),!g&&!v&&n.jsx(N,{style:{textAlign:"center",width:"100%",height:"20px"},htmlType:"submit",loading:v,children:"Continue"})]})});return n.jsxs(n.Fragment,{children:[n.jsxs(be,{title:"Cadastre-se / Entrar",open:e,onCancel:o,footer:null,children:[n.jsxs("p",{children:["Plano ",r.servicePlan]}),n.jsx("div",{style:{textAlign:"center"},children:v?n.jsx(Pe,{size:"large"}):Ke()})]}),n.jsxs(be,{title:"Teste Grátis 😮",open:Ae,onCancel:()=>re(!1),footer:null,children:[n.jsx("p",{children:"Seu e-mail não existe em nosso cadastro, por favor faça seu cadastro e aproveite 7 dias grátis para testar o Marquei !"}),n.jsx(N,{style:{textAlign:"center",width:"100%",marginTop:"1rem"},type:"primary",onClick:He,children:"Testar Grátis Por 7 Dias 😃"})]})]})};export{Jt as A,At as R};
