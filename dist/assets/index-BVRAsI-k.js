import{r as t,u as F,d as O,j as e,a as I,L as V,B as w}from"./index-BjWOWftK.js";import{B as D}from"./index-JyjWfW4x.js";import U from"./index-DncJ83qH.js";import{R as P}from"./AuthModal-D1-hlBBe.js";import{L as z}from"./styles-IZQvhEu5.js";import{L as C}from"./LockOutlined-ejqNwguy.js";import{B as H}from"./context-CsxF_MV5.js";import{M as S}from"./index-DZhypcJC.js";import{I as J}from"./index-Dtquuxsa.js";import{m as c}from"./index-voIPXOLj.js";import"./api-yj2qoLPl.js";import"./index-BrP1Cg1Z.js";import"./Styles-HDwQP3Lk.js";import"./styled-components.browser.esm-0XG6BcNo.js";import"./Serializer-CQbcCsmu.js";import"./index-DWnRouz4.js";import"./useSize-xGuuOV2H.js";import"./AntdIcon-CQBeZWiu.js";import"./index-10_tvuH-.js";import"./index-xwEKfmQR.js";import"./render-Dc9fgLFB.js";import"./useForm-BVlqLGy1.js";import"./row-xbO0cgu3.js";import"./responsiveObserver-eh3CkRQ8.js";import"./useLocale-B5fEOMjY.js";import"./ExclamationCircleFilled-BXHKs-a4.js";import"./index-C7SteZcr.js";import"./PurePanel-vSTbxOUV.js";import"./CalendarOutlined-fGf3BKFZ.js";import"./ClockCircleOutlined-vEkn-5q0.js";import"./KeyCode-iNboPXT1.js";import"./SearchOutlined-DC5n_389.js";import"./index-CrIh86xN.js";import"./Overflow-vieoZhrC.js";import"./CheckOutlined-BorBS3ox.js";import"./index-DmbuE59p.js";import"./index-DREpUMdt.js";import"./index-Chjiymov.js";import"./index-BNxrNzwE.js";import"./WarningOutlined-B45VRAgE.js";import"./InfoCircleFilled-CN7YLSSN.js";import"./useNotification-C_uzqUJr.js";const $="_autenticar_103d6_1",G="_formulario_103d6_10",K="_inputContainer_103d6_24",Q="_captcha_103d6_32",W="_inputField_103d6_38",X="_forgotPassword_103d6_48",Y="_registerPrompt_103d6_58",Z="_error_103d6_71",o={autenticar:$,formulario:G,inputContainer:K,captcha:Q,inputField:W,forgotPassword:X,registerPrompt:Y,error:Z},Ue=()=>{const[h,f]=t.useState(""),[g,x]=t.useState(""),[k,p]=t.useState(!1),[E,T]=t.useState(""),[N,d]=t.useState(!1),[j,R]=t.useState(""),[v,m]=t.useState(""),[a,u]=t.useState(""),i=t.useRef(null),[q,n]=t.useState(!1),y=F(),{updateAuthData:L}=O(),M=async r=>{if(r.preventDefault(),m(""),!a){m("Por favor, confirme que você não é um robô.");return}n(!0);try{const s=await fetch(`${w}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:h,password:g,recaptchaToken:a})});if(s.ok){const{token:l,company_id:_,user_specialties:B}=await s.json();if(typeof _>"u")throw n(!1),new Error("Informações do usuário ou da empresa não estão disponíveis.");L({authToken:l,companyID:_,userSpecialties:B}),f(""),x(""),u(""),y("/calendario")}else{const l=await s.json();if(n(!1),l.message==="Token inválido ou expirado")p(!0),T("Seu período de teste chegou ao fim, mas não fique triste, fique à vontade para contratar um dos nossos planos clicando aqui!");else throw new Error(l.message||"Erro ao fazer login.")}}catch(s){n(!1),m(s.message||"Erro ao fazer login."),c.error(s.message),i.current&&i.current.reset()}},b=async()=>{if(!a){c.error("Por favor, complete o reCAPTCHA.");return}try{if((await fetch(`${w}/auth/password-reset`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:j,recaptchaToken:a})})).ok)c.success("Se um email corresponder à sua conta, enviaremos um link de redefinição de senha.");else throw new Error("Algo deu errado, por favor tente novamente.")}catch(r){c.error(r.message)}finally{d(!1)}},A=()=>{d(!0)};return e.jsxs("div",{className:o.autenticar,children:[q?e.jsxs(z,{children:[e.jsx(I,{})," "]}):e.jsxs("form",{className:o.formulario,onSubmit:M,children:[e.jsxs("h1",{children:["Acesso ao Marquei ",e.jsx(C,{})]}),e.jsxs("div",{className:o.inputContainer,children:[e.jsx("label",{htmlFor:"username",children:"E-mail"}),e.jsx("input",{type:"text",id:"username",className:o.inputField,placeholder:"E-mail",value:h,onChange:r=>f(r.target.value),required:!0})]}),e.jsxs("div",{className:o.inputContainer,children:[e.jsx("label",{htmlFor:"password",children:"Senha"}),e.jsx("input",{type:"password",id:"password",className:o.inputField,placeholder:"Senha",value:g,onChange:r=>x(r.target.value),required:!0}),v&&e.jsx("div",{className:o.error,children:v})]}),e.jsx("div",{className:o.captcha,children:e.jsx(P,{ref:i,onChange:r=>u(r)})}),e.jsx(D,{type:"submit",className:o.loginButton,children:"Entrar"}),e.jsx("div",{className:o.forgotPassword,children:e.jsx(H,{type:"link",onClick:A,children:"Esqueci minha senha"})}),e.jsxs("div",{className:o.registerPrompt,children:[e.jsx("p",{children:"Você ainda não tem uma conta Marquei?"}),e.jsx(V,{to:"/cadastro",children:"Teste o Marquei gratuitamente"})]})]}),e.jsxs(S,{title:"Período de teste chegou ao Fim :(",open:k,onOk:()=>{y("/contratar-plano"),p(!1)},onCancel:()=>p(!1),okText:"Consulte outros planos...",cancelButtonProps:{style:{display:"none"}},children:[e.jsx("p",{children:E}),e.jsx(U,{title:"Plus",price:"69,99",originalPrice:"119",quantity:"1",duration:"1",mostSold:!0})]}),e.jsxs(S,{title:"Redefinir senha",open:N,onOk:b,onCancel:()=>d(!1),okText:"Resetar",cancelText:"Cancelar",children:[e.jsx("p",{children:"Insira o E-mail cadastrado para resetar a senha de acesso !"}),e.jsx(J,{prefix:e.jsx(C,{}),type:"email",placeholder:"Digite seu email",value:j,onChange:r=>R(r.target.value),required:!0}),e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"18px 0"},children:e.jsx(P,{ref:i,onChange:r=>u(r)})})]})]})};export{Ue as default};
