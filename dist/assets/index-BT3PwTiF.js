import{r as n,u as j,d as v,j as e,B as g}from"./index-F_APLYFk.js";/* empty css                      */import{I as m}from"./index-CF94sgcy.js";import{B as y}from"./context-BBgDGUKR.js";import{s as p}from"./index-BSshCDlB.js";import{m as c}from"./index-BZ8NrSYz.js";import{L as d}from"./LockOutlined-CL2uAh3Q.js";import{C as N}from"./CheckOutlined-DjblNYZ6.js";import{C as P}from"./KeyCode-BGAGjcbr.js";import"./AntdIcon-Dm9H8mJU.js";import"./useSize-CS2hrim6.js";import"./Serializer-CQbcCsmu.js";import"./render-BLHg8_GC.js";import"./SearchOutlined-DT7IAkrq.js";import"./ExclamationCircleFilled-CJs6dt2B.js";import"./InfoCircleFilled-D7yE8Sak.js";import"./useNotification-B5cApIMQ.js";const a=({isCriteriaMet:r,text:i})=>e.jsxs("p",{className:r?"criteriaMet":"criteriaNotMet",children:[r?e.jsx(N,{style:{color:"green"}}):e.jsx(P,{style:{color:"red"}})," ",i]}),U=()=>{const[r,i]=n.useState(""),[l,u]=n.useState(""),h=j(),{token:C}=v(),[t,f]=n.useState({minLength:!1,upperCase:!1,lowerCase:!1,specialChar:!1,numbers:!1}),x=o=>{const s=o.target.value;f({minLength:s.length>=10,upperCase:/[A-Z]/.test(s),lowerCase:/[a-z]/.test(s),specialChar:/[^A-Za-z0-9]/.test(s),numbers:/[0-9].*[0-9]/.test(s)}),i(s)},w=async()=>{if(!Object.values(t).every(s=>s)){p.success({message:"A senha não atende aos critérios necessários."});return}if(r!==l){c.error("As senhas não coincidem."),p.error({message:"As senhas não coincidem."});return}try{if((await fetch(`${g}/auth/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:C,newPassword:r})})).ok)c.success("Senha redefinida com sucesso!"),h("/login");else throw new Error("Não foi possível redefinir a senha. Tente novamente.")}catch(s){c.error(s.message)}};return e.jsx("div",{className:"resetPassword",children:e.jsxs("div",{className:"resetPasswordContainer",children:[e.jsx("h2",{children:"Redefinir Senha"}),e.jsx(m,{prefix:e.jsx(d,{}),type:"password",placeholder:"Nova senha",value:r,onChange:x,required:!0}),e.jsxs("div",{className:"passwordCriteria",children:[e.jsx(a,{isCriteriaMet:t.minLength,text:"A senha deve conter pelo menos 10 dígitos"}),e.jsx(a,{isCriteriaMet:t.upperCase,text:"Deve conter pelo menos uma letra maiúscula"}),e.jsx(a,{isCriteriaMet:t.lowerCase,text:"Deve conter pelo menos uma letra minúscula"}),e.jsx(a,{isCriteriaMet:t.specialChar,text:"Deve conter pelo menos um caractere especial"}),e.jsx(a,{isCriteriaMet:t.numbers,text:"Deve conter pelo menos dois números"})]}),e.jsx(m,{prefix:e.jsx(d,{}),type:"password",placeholder:"Confirme a nova senha",value:l,onChange:o=>u(o.target.value),required:!0}),e.jsx(y,{type:"primary",onClick:w,children:"Redefinir Senha"})]})})};export{U as default};
