import{r as s,u as V,e as D,j as e,a as O,L as z,c as C}from"./index-CNAW3eq3.js";import{B as H}from"./index-HKc2MpAH.js";import U from"./index-B1PnSOQa.js";import{R as k}from"./ReCAPTCHAUtil-ByZk266M.js";import{L as G}from"./styles-Cljwda4P.js";import{L as S}from"./LockOutlined-BkomFUY9.js";import{B as J}from"./context-dvodvhd4.js";import{M as E}from"./index-D1_O_0Vz.js";import{I as K}from"./index-BdZwxmcX.js";import{m as p}from"./index-BfLTes4p.js";import"./AuthModal-oPx8_DPV.js";import"./index-BINF971z.js";import"./Styles-C_5TLpkW.js";import"./styled-components.browser.esm-Dpe2mTWd.js";import"./Serializer-CQbcCsmu.js";import"./index-zYDVGZq8.js";import"./useSize-zNFkUmnO.js";import"./AntdIcon-BGp71K7u.js";import"./index-91MMm8di.js";import"./index-DPkEw2AG.js";import"./render-BV6mHij8.js";import"./row-DCpfzZX7.js";import"./responsiveObserver-lvPprBgq.js";import"./useLocale-DrB7vlH5.js";import"./ExclamationCircleFilled-CIJGRYBD.js";import"./index-C7ivzDJW.js";import"./PurePanel-zdfJd6bP.js";import"./CalendarOutlined-D2Nx08jh.js";import"./ClockCircleOutlined-DQlVZjF2.js";import"./KeyCode-BfOxs3zp.js";import"./SearchOutlined-BqMw0g9J.js";import"./index-B1nCgeeC.js";import"./Overflow-rQDOYPcw.js";import"./CheckOutlined-BmRh5aFk.js";import"./index-B2KaeOWd.js";import"./index-vPjO4Z7k.js";import"./WarningOutlined-Bm9jbQ8j.js";import"./index-EU4tcXRS.js";import"./InfoCircleFilled-B20eU8OV.js";import"./useNotification-KqZwggrl.js";const Q="_autenticar_103d6_1",W="_formulario_103d6_10",X="_inputContainer_103d6_24",Y="_captcha_103d6_32",Z="_inputField_103d6_38",$="_forgotPassword_103d6_48",ee="_registerPrompt_103d6_58",re="_error_103d6_71",t={autenticar:Q,formulario:W,inputContainer:X,captcha:Y,inputField:Z,forgotPassword:$,registerPrompt:ee,error:re},ze=()=>{const[x,g]=s.useState(""),[j,v]=s.useState(""),[M,d]=s.useState(!1),[T,R]=s.useState(""),[N,m]=s.useState(!1),[_,L]=s.useState(""),[P,u]=s.useState(""),[l,h]=s.useState(""),c=s.useRef(null),[b,f]=s.useState(!1),w=V(),{updateAuthData:A}=D(),q=async r=>{var a,o;if(r.preventDefault(),u(""),!l){u("Por favor, confirme que você não é um robô.");return}f(!0);try{const i=await C.post("/auth/login",{username:x,password:j,recaptchaToken:l}),{token:n,company_id:y,user_specialties:I}=i.data;if(typeof y>"u")throw f(!1),new Error("Informações do usuário ou da empresa não estão disponíveis.");A({authToken:n,companyID:y,userSpecialties:I}),g(""),v(""),h(""),w("/calendario")}catch(i){f(!1);const n=((o=(a=i.response)==null?void 0:a.data)==null?void 0:o.message)||"Erro ao fazer login.";u(n),p.error(n),c.current&&c.current.reset(),n==="Token inválido ou expirado"&&(R("Seu período de teste expirou. Por favor, considere contratar um plano para continuar utilizando nossos serviços."),d(!0))}},F=async()=>{var r,a;if(!l){p.error("Por favor, complete o reCAPTCHA.");return}try{const o=await C.post("/auth/password-reset",{email:_,recaptchaToken:l});if(o.status>=200&&o.status<300)p.success("Se um email corresponder à sua conta, enviaremos um link de redefinição de senha.");else throw new Error("Algo deu errado, por favor tente novamente.")}catch(o){const i=((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.message)||"Algo deu errado, por favor tente novamente.";p.error(i)}finally{m(!1)}},B=()=>{m(!0)};return e.jsxs("div",{className:t.autenticar,children:[b?e.jsxs(G,{children:[e.jsx(O,{})," "]}):e.jsxs("form",{className:t.formulario,onSubmit:q,children:[e.jsxs("h1",{children:["Acesso ao Marquei ",e.jsx(S,{})]}),e.jsxs("div",{className:t.inputContainer,children:[e.jsx("label",{htmlFor:"username",children:"E-mail"}),e.jsx("input",{type:"text",id:"username",className:t.inputField,placeholder:"E-mail",value:x,onChange:r=>g(r.target.value),required:!0})]}),e.jsxs("div",{className:t.inputContainer,children:[e.jsx("label",{htmlFor:"password",children:"Senha"}),e.jsx("input",{type:"password",id:"password",className:t.inputField,placeholder:"Senha",value:j,onChange:r=>v(r.target.value),required:!0}),P&&e.jsx("div",{className:t.error,children:P})]}),e.jsx("div",{className:t.captcha,children:e.jsx(k,{ref:c,onChange:r=>h(r)})}),e.jsx(H,{type:"submit",className:t.loginButton,children:"Entrar"}),e.jsx("div",{className:t.forgotPassword,children:e.jsx(J,{type:"link",onClick:B,children:"Esqueci minha senha"})}),e.jsxs("div",{className:t.registerPrompt,children:[e.jsx("p",{children:"Você ainda não tem uma conta Marquei?"}),e.jsx(z,{to:"/cadastro",children:"Teste o Marquei gratuitamente"})]})]}),e.jsxs(E,{title:"Período de teste chegou ao Fim :(",open:M,onOk:()=>{w("/planos"),d(!1)},onCancel:()=>d(!1),okText:"Saber mais...",cancelButtonProps:{style:{display:"none"}},children:[e.jsx("p",{children:T}),e.jsx(U,{title:"Plus",price:"69,99",originalPrice:"119",quantity:"1",duration:"1",mostSold:!0})]}),e.jsxs(E,{title:"Redefinir senha",open:N,onOk:F,onCancel:()=>m(!1),okText:"Resetar",cancelText:"Cancelar",children:[e.jsx("p",{children:"Insira o E-mail cadastrado para resetar a senha de acesso !"}),e.jsx(K,{prefix:e.jsx(S,{}),type:"email",placeholder:"Digite seu email",value:_,onChange:r=>L(r.target.value),required:!0}),e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"18px 0"},children:e.jsx(k,{ref:c,onChange:r=>h(r)})})]})]})};export{ze as default};
