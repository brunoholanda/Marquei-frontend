import{r as i,e as K,j as s,c as N}from"./index-BQF3cPym.js";import{F as h}from"./index-C0dvJG1O.js";import{C as U,E as J}from"./ExclamationCircleFilled-Cq3JtRsb.js";import{r as Y,C as Z}from"./render-Evlt6hy1.js";import{C as ee}from"./KeyCode-Bfjm3k6b.js";import{I as te}from"./InfoCircleFilled-9dsj_Nm8.js";import{c as A}from"./AntdIcon-Bf-y5mt3.js";import{g as oe,r as ne,C as re,z as se,l as ie,n as ae,p as le,q as ce}from"./useSize-D_L_sEch.js";import{p as me}from"./PurePanel-BVQW51Q3.js";import{I as F}from"./index-5ndGXuFb.js";import{I as k}from"./index-DZ2YWfwI.js";import{B as O}from"./context-Fzf3q6Qk.js";import{T as de}from"./Table-BtrjlE9_.js";import{M as D}from"./index-Bb0wNoCb.js";import{s as I}from"./index-GHCFiXpW.js";import{B as ue}from"./BarChartOutlined-FIj796mi.js";import{W as pe}from"./WarningOutlined-B1Wz2Rzd.js";import"./index-Zqv3mRLS.js";import"./index-BCWQvPtp.js";import"./row-CXODCmak.js";import"./responsiveObserver-BFwVCCVV.js";import"./useLocale-DqFOwQe3.js";import"./Serializer-CQbcCsmu.js";import"./SearchOutlined-D4A1T3K6.js";import"./index-BiGWWT0_.js";import"./Overflow-C-Iz2ka9.js";import"./CheckOutlined-DTHRp8rd.js";import"./useForceUpdate-Cb-16ZfM.js";import"./index-DDs0x0Q4.js";import"./EllipsisOutlined-Cn-2e4jY.js";import"./index-BjuhNa7t.js";import"./index-D5pPztTr.js";import"./index-CsUWG4nD.js";import"./Dropdown-Dec2Znn0.js";import"./index-DN31wMcw.js";import"./useNotification-4XyWe70T.js";const B=(e,t,n,o,r)=>({backgroundColor:e,border:`${o.lineWidth}px ${o.lineType} ${t}`,[`${r}-icon`]:{color:n}}),ge=e=>{const{componentCls:t,motionDurationSlow:n,marginXS:o,marginSM:r,fontSize:c,fontSizeLG:u,lineHeight:m,borderRadiusLG:g,motionEaseInOutCirc:p,withDescriptionIconSize:f,colorText:y,colorTextHeading:x,withDescriptionPadding:C,defaultPadding:$}=e;return{[t]:Object.assign(Object.assign({},ne(e)),{position:"relative",display:"flex",alignItems:"center",padding:$,wordWrap:"break-word",borderRadius:g,[`&${t}-rtl`]:{direction:"rtl"},[`${t}-content`]:{flex:1,minWidth:0},[`${t}-icon`]:{marginInlineEnd:o,lineHeight:0},"&-description":{display:"none",fontSize:c,lineHeight:m},"&-message":{color:x},[`&${t}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${n} ${p}, opacity ${n} ${p},
        padding-top ${n} ${p}, padding-bottom ${n} ${p},
        margin-bottom ${n} ${p}`},[`&${t}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${t}-with-description`]:{alignItems:"flex-start",padding:C,[`${t}-icon`]:{marginInlineEnd:r,fontSize:f,lineHeight:0},[`${t}-message`]:{display:"block",marginBottom:o,color:x,fontSize:u},[`${t}-description`]:{display:"block",color:y}},[`${t}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},fe=e=>{const{componentCls:t,colorSuccess:n,colorSuccessBorder:o,colorSuccessBg:r,colorWarning:c,colorWarningBorder:u,colorWarningBg:m,colorError:g,colorErrorBorder:p,colorErrorBg:f,colorInfo:y,colorInfoBorder:x,colorInfoBg:C}=e;return{[t]:{"&-success":B(r,o,n,e,t),"&-info":B(C,x,y,e,t),"&-warning":B(m,u,c,e,t),"&-error":Object.assign(Object.assign({},B(f,p,g,e,t)),{[`${t}-description > pre`]:{margin:0,padding:0}})}}},ye=e=>{const{componentCls:t,iconCls:n,motionDurationMid:o,marginXS:r,fontSizeIcon:c,colorIcon:u,colorIconHover:m}=e;return{[t]:{"&-action":{marginInlineStart:r},[`${t}-close-icon`]:{marginInlineStart:r,padding:0,overflow:"hidden",fontSize:c,lineHeight:`${c}px`,backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${n}-close`]:{color:u,transition:`color ${o}`,"&:hover":{color:m}}},"&-close-text":{color:u,transition:`color ${o}`,"&:hover":{color:m}}}}},he=e=>[ge(e),fe(e),ye(e)],xe=oe("Alert",e=>[he(e)],e=>({withDescriptionIconSize:e.fontSizeHeading3,defaultPadding:`${e.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`}));var Ce=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n};const Ie={success:U,info:te,error:Z,warning:J},Se=e=>{const{icon:t,prefixCls:n,type:o}=e,r=Ie[o]||null;return t?Y(t,i.createElement("span",{className:`${n}-icon`},t),()=>({className:A(`${n}-icon`,{[t.props.className]:t.props.className})})):i.createElement(r,{className:`${n}-icon`})},$e=e=>{const{isClosable:t,prefixCls:n,closeIcon:o,handleClose:r}=e,c=o===!0||o===void 0?i.createElement(ee,null):o;return t?i.createElement("button",{type:"button",onClick:r,className:`${n}-close-icon`,tabIndex:0},c):null},be=e=>{const{description:t,prefixCls:n,message:o,banner:r,className:c,rootClassName:u,style:m,onMouseEnter:g,onMouseLeave:p,onClick:f,afterClose:y,showIcon:x,closable:C,closeText:$,closeIcon:b,action:q}=e,z=Ce(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action"]),[v,M]=i.useState(!1),a=i.useRef(null),{getPrefixCls:l,direction:S,alert:E}=i.useContext(re),d=l("alert",n),[R,W]=xe(d),L=j=>{var w;M(!0),(w=e.onClose)===null||w===void 0||w.call(e,j)},T=i.useMemo(()=>e.type!==void 0?e.type:r?"warning":"info",[e.type,r]),Q=i.useMemo(()=>$?!0:typeof C=="boolean"?C:b!==!1&&b!==null&&b!==void 0,[$,b,C]),_=r&&x===void 0?!0:x,V=A(d,`${d}-${T}`,{[`${d}-with-description`]:!!t,[`${d}-no-icon`]:!_,[`${d}-banner`]:!!r,[`${d}-rtl`]:S==="rtl"},E==null?void 0:E.className,c,u,W),G=me(z,{aria:!0,data:!0});return R(i.createElement(se,{visible:!v,motionName:`${d}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:j=>({maxHeight:j.offsetHeight}),onLeaveEnd:y},j=>{let{className:w,style:X}=j;return i.createElement("div",Object.assign({ref:a,"data-show":!v,className:A(V,w),style:Object.assign(Object.assign(Object.assign({},E==null?void 0:E.style),m),X),onMouseEnter:g,onMouseLeave:p,onClick:f,role:"alert"},G),_?i.createElement(Se,{description:t,icon:e.icon,prefixCls:d,type:T}):null,i.createElement("div",{className:`${d}-content`},o?i.createElement("div",{className:`${d}-message`},o):null,t?i.createElement("div",{className:`${d}-description`},t):null),q?i.createElement("div",{className:`${d}-action`},q):null,i.createElement($e,{isClosable:Q,prefixCls:d,closeIcon:$||b,handleClose:L}))}))},H=be;let Ee=function(e){ie(n,e);var t=ae(n);function n(){var o;return le(this,n),o=t.apply(this,arguments),o.state={error:void 0,info:{componentStack:""}},o}return ce(n,[{key:"componentDidCatch",value:function(r,c){this.setState({error:r,info:c})}},{key:"render",value:function(){const{message:r,description:c,children:u}=this.props,{error:m,info:g}=this.state,p=g&&g.componentStack?g.componentStack:null,f=typeof r>"u"?(m||"").toString():r,y=typeof c>"u"?p:c;return m?i.createElement(H,{type:"error",message:f,description:i.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},y)}):u}}]),n}(i.Component);const ve=Ee,P=H;P.ErrorBoundary=ve;const je=P,ct=()=>{const[e]=h.useForm(),[t,n]=i.useState([]),[o,r]=i.useState(0),[c,u]=i.useState(!1),[m,g]=i.useState(null),{authData:p}=K(),f=p.companyID,y=async()=>{try{const a=await N.get("/stock-items",{params:{company_id:f}});n(a.data);const l=a.data.filter(S=>S.quantidade<=S.limite_estoque).length;r(l)}catch(a){I.error({message:"Erro ao carregar itens de estoque",description:a.message})}},x=async a=>{try{const l=await N.post("/stock-items",{...a,company_id:f});n([...t,l.data]),e.resetFields(),I.success({message:"Item adicionado com sucesso!"})}catch(l){I.error({message:"Erro ao adicionar item",description:l.message})}},C=async(a,l)=>{try{await N.put(`/stock-items/${a}`,{quantidade:l}),y(),I.success({message:"Quantidade atualizada com sucesso!"})}catch(S){I.error({message:"Erro ao atualizar quantidade",description:S.message})}},$=a=>{D.confirm({title:"Tem certeza que deseja excluir o item selecionado?",okText:"Sim",cancelText:"Não",onOk:async()=>{try{await N.delete(`/stock-items/${a}`),y(),I.success({message:"Item excluído com sucesso!"})}catch(l){I.error({message:"Erro ao excluir item",description:l.message})}}})},b=a=>{g(a),u(!0)},q=a=>a.quantidade<=a.limite_estoque?"low-stock":"",z=async a=>{try{await N.put(`/stock-items/${m.id}`,a),y(),v(),I.success({message:"Item atualizado com sucesso!"})}catch(l){I.error({message:"Erro ao atualizar item",description:l.message})}};i.useEffect(()=>{f&&y()},[f]);const v=()=>{e.resetFields(),g(null),u(!1)},M=[{title:"Nome",dataIndex:"nome",key:"nome"},{title:"Quantidade",dataIndex:"quantidade",key:"quantidade",render:(a,l)=>s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx(k,{min:0,defaultValue:a,onChange:S=>l.newQuantity=S,style:{marginRight:10}}),s.jsx(O,{onClick:()=>C(l.id,l.newQuantity),type:"primary",children:"Atualizar"})]})},{title:"Aviso de Fim",dataIndex:"limite_estoque",key:"limite_estoque"},{title:"Ação",key:"acao",render:(a,l)=>s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx(O,{onClick:()=>b(l),type:"primary",style:{marginRight:10},children:"Alterar"}),s.jsx(O,{onClick:()=>$(l.id),type:"primary",danger:!0,children:"Excluir"})]})}];return s.jsxs("div",{className:"estoque",children:[s.jsxs("h1",{children:["Suprimentos da Clínica ",s.jsx(ue,{})]}),o>0&&s.jsx(je,{message:`Atenção: Existem ${o} itens chegando ao fim!`,type:"warning",showIcon:!0,icon:s.jsx(pe,{}),style:{marginBottom:20}}),s.jsx("p",{children:"Para adicionar um novo item basta preencher os dados abaixo !"}),s.jsxs(h,{form:e,onFinish:x,layout:"inline",children:[s.jsx(h.Item,{name:"nome",rules:[{required:!0,message:"Insira o nome do item!"}],children:s.jsx(F,{placeholder:"Nome do Item"})}),s.jsx(h.Item,{name:"quantidade",rules:[{required:!0,message:"Insira a quantidade!"}],children:s.jsx(k,{style:{width:"105px"},min:1,placeholder:"Quantidade"})}),s.jsx(h.Item,{name:"limite_estoque",rules:[{required:!0,message:"Insira o limite de estoque!"}],children:s.jsx(k,{style:{width:"105px"},min:0,placeholder:"Aviso de Fim"})}),s.jsx(h.Item,{children:s.jsx(O,{type:"primary",htmlType:"submit",children:"Adicionar Item"})})]}),s.jsx(de,{style:{marginTop:"20px"},dataSource:t,columns:M,rowKey:"id",rowClassName:q}),c&&s.jsx(D,{title:"Editar Item",open:c,onCancel:v,onOk:()=>e.submit(),children:s.jsxs(h,{form:e,initialValues:m,onFinish:z,children:[s.jsx(h.Item,{name:"nome",label:"Nome",rules:[{required:!0}],children:s.jsx(F,{})}),s.jsx(h.Item,{name:"quantidade",label:"Quantidade",rules:[{required:!0}],children:s.jsx(k,{min:1})}),s.jsx(h.Item,{name:"limite_estoque",label:"Aviso de Fim",rules:[{required:!0}],children:s.jsx(k,{min:0})})]})})]})};export{ct as default};
