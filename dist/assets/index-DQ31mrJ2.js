import{r as s,u as I,e as V,j as e,a as D,L as O,c as C}from"./index-DtAKxO-I.js";import{B as H}from"./index-_akqntwb.js";import U from"./index-Bk7dcu8M.js";import{R as k}from"./ReCAPTCHAUtil-Bq0XrcWm.js";import{L as z}from"./styles-Cbs-aLpW.js";import{L as E}from"./LockOutlined-BGyqMb-5.js";import{B as G}from"./context-DBlOovQj.js";import{M as S}from"./index-53RB1vmR.js";import{I as J}from"./index-Bh7spuOb.js";import{m as p}from"./index-ckeLVLhX.js";import"./AuthModal-CxLRBDi8.js";import"./index-DKKNANKo.js";import"./Styles-B5msiCGj.js";import"./styled-components.browser.esm-Bk05TAV1.js";import"./Serializer-CQbcCsmu.js";import"./index-DVTGV1Ty.js";import"./useSize-CI_ZKiRx.js";import"./AntdIcon-yIvRgVWP.js";import"./index-BMUJ3kY3.js";import"./index-CFnU9gTT.js";import"./render-DxYmgcxZ.js";import"./row-Pvs6HpoF.js";import"./responsiveObserver-CzKOeKup.js";import"./useLocale-CKM3KW2_.js";import"./ExclamationCircleFilled-BDkHAKsa.js";import"./index-gnFUhh9P.js";import"./PurePanel-DTnqM39y.js";import"./CalendarOutlined-BHHeKPdf.js";import"./ClockCircleOutlined-yAqJ-m-N.js";import"./KeyCode-BDlL2ZxM.js";import"./SearchOutlined-Bb9Je5JO.js";import"./index-DsB5NFMg.js";import"./Overflow-CxvXknPO.js";import"./CheckOutlined-R07Mhy7g.js";import"./index-Cpu2Yaof.js";import"./index-DmqRj2CN.js";import"./WarningOutlined-DektOd_F.js";import"./index-BD1vRKR1.js";import"./InfoCircleFilled-D2hARdve.js";import"./useNotification-CiPFwKzO.js";const K="_autenticar_103d6_1",Q="_formulario_103d6_10",W="_inputContainer_103d6_24",X="_captcha_103d6_32",Y="_inputField_103d6_38",Z="_forgotPassword_103d6_48",$="_registerPrompt_103d6_58",ee="_error_103d6_71",t={autenticar:K,formulario:Q,inputContainer:W,captcha:X,inputField:Y,forgotPassword:Z,registerPrompt:$,error:ee},He=()=>{const[f,x]=s.useState(""),[g,j]=s.useState(""),[M,v]=s.useState(!1),[R,re]=s.useState(""),[T,d]=s.useState(!1),[_,N]=s.useState(""),[P,m]=s.useState(""),[n,u]=s.useState(""),l=s.useRef(null),[L,h]=s.useState(!1),w=I(),{updateAuthData:A}=V(),b=async r=>{var a,o;if(r.preventDefault(),m(""),!n){m("Por favor, confirme que você não é um robô.");return}h(!0);try{const i=await C.post("/auth/login",{username:f,password:g,recaptchaToken:n}),{token:c,company_id:y,user_specialties:B}=i.data;if(typeof y>"u")throw h(!1),new Error("Informações do usuário ou da empresa não estão disponíveis.");A({authToken:c,companyID:y,userSpecialties:B}),x(""),j(""),u(""),w("/calendario")}catch(i){h(!1);const c=((o=(a=i.response)==null?void 0:a.data)==null?void 0:o.message)||"Erro ao fazer login.";m(c),p.error(c),l.current&&l.current.reset()}},q=async()=>{var r,a;if(!n){p.error("Por favor, complete o reCAPTCHA.");return}try{const o=await C.post("/auth/password-reset",{email:_,recaptchaToken:n});if(o.status>=200&&o.status<300)p.success("Se um email corresponder à sua conta, enviaremos um link de redefinição de senha.");else throw new Error("Algo deu errado, por favor tente novamente.")}catch(o){const i=((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.message)||"Algo deu errado, por favor tente novamente.";p.error(i)}finally{d(!1)}},F=()=>{d(!0)};return e.jsxs("div",{className:t.autenticar,children:[L?e.jsxs(z,{children:[e.jsx(D,{})," "]}):e.jsxs("form",{className:t.formulario,onSubmit:b,children:[e.jsxs("h1",{children:["Acesso ao Marquei ",e.jsx(E,{})]}),e.jsxs("div",{className:t.inputContainer,children:[e.jsx("label",{htmlFor:"username",children:"E-mail"}),e.jsx("input",{type:"text",id:"username",className:t.inputField,placeholder:"E-mail",value:f,onChange:r=>x(r.target.value),required:!0})]}),e.jsxs("div",{className:t.inputContainer,children:[e.jsx("label",{htmlFor:"password",children:"Senha"}),e.jsx("input",{type:"password",id:"password",className:t.inputField,placeholder:"Senha",value:g,onChange:r=>j(r.target.value),required:!0}),P&&e.jsx("div",{className:t.error,children:P})]}),e.jsx("div",{className:t.captcha,children:e.jsx(k,{ref:l,onChange:r=>u(r)})}),e.jsx(H,{type:"submit",className:t.loginButton,children:"Entrar"}),e.jsx("div",{className:t.forgotPassword,children:e.jsx(G,{type:"link",onClick:F,children:"Esqueci minha senha"})}),e.jsxs("div",{className:t.registerPrompt,children:[e.jsx("p",{children:"Você ainda não tem uma conta Marquei?"}),e.jsx(O,{to:"/cadastro",children:"Teste o Marquei gratuitamente"})]})]}),e.jsxs(S,{title:"Período de teste chegou ao Fim :(",open:M,onOk:()=>{w("/contratar-plano"),v(!1)},onCancel:()=>v(!1),okText:"Consulte outros planos...",cancelButtonProps:{style:{display:"none"}},children:[e.jsx("p",{children:R}),e.jsx(U,{title:"Plus",price:"69,99",originalPrice:"119",quantity:"1",duration:"1",mostSold:!0})]}),e.jsxs(S,{title:"Redefinir senha",open:T,onOk:q,onCancel:()=>d(!1),okText:"Resetar",cancelText:"Cancelar",children:[e.jsx("p",{children:"Insira o E-mail cadastrado para resetar a senha de acesso !"}),e.jsx(J,{prefix:e.jsx(E,{}),type:"email",placeholder:"Digite seu email",value:_,onChange:r=>N(r.target.value),required:!0}),e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"18px 0"},children:e.jsx(k,{ref:l,onChange:r=>u(r)})})]})]})};export{He as default};
