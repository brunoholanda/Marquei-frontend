import{r as a,e as Q,B as ue,j as e,f as he,c as E,L as we}from"./index-BQF3cPym.js";import{U as Te,P as Ie}from"./registerModal-G9buuGJv.js";/* empty css                     */import{M as V}from"./index-Bb0wNoCb.js";import{B as k}from"./context-Fzf3q6Qk.js";import{S as ie}from"./index-BjuhNa7t.js";import{T as le}from"./index-BCWQvPtp.js";import{U as fe,D as re}from"./index-xne8bVLV.js";import{I as $}from"./index-5ndGXuFb.js";import{m as b}from"./index-DCz0qyh3.js";import{U as ge,D as $e}from"./UploadOutlined-BVUWffJ0.js";import{A as W,_ as Y}from"./AntdIcon-Bf-y5mt3.js";import{h as _}from"./moment-gy9AvL1k.js";import"./pt-br-CeAu04ye.js";import{C as de}from"./index-D5pPztTr.js";import{T as U}from"./index-CjgFxGpf.js";import{L as xe}from"./LinkOutlined-BQXMAeLy.js";import{c as ve}from"./index-B_z3CG5F.js";import{C as ae}from"./index-BV6iTKco.js";import{C as ze}from"./ControlOutlined-CEUIkbCC.js";import{S as ye}from"./index-BiGWWT0_.js";import{D as Me}from"./index-g8AgFOgb.js";import{T as ce}from"./Table-BtrjlE9_.js";import{W as He}from"./WarningFilled-DmuNQdO_.js";import Oe from"./index-DPdNUbgL.js";import Ae from"./index-BwkiVIzn.js";import{E as Le}from"./ExclamationCircleOutlined-7HnU-imv.js";import{C as Pe}from"./ClockCircleOutlined-CGK1f65m.js";import{C as Be}from"./CheckCircleOutlined-Bm0LZL5V.js";import{S as Fe}from"./SwapOutlined-Dri4SeNI.js";import{T as me}from"./index-DFRlCUnV.js";import"./index-gPGki1FS.js";import"./index-B5ADy5vq.js";import"./index-D61Ku0Ai.js";import"./index-C0dvJG1O.js";import"./useSize-D_L_sEch.js";import"./Serializer-CQbcCsmu.js";import"./index-Zqv3mRLS.js";import"./render-Evlt6hy1.js";import"./row-CXODCmak.js";import"./responsiveObserver-BFwVCCVV.js";import"./useLocale-DqFOwQe3.js";import"./ExclamationCircleFilled-Cq3JtRsb.js";import"./Styles-ytlb0fSP.js";import"./styled-components.browser.esm-DBwtvTCP.js";import"./commonMailDomains-C8uuVB4t.js";import"./WarningOutlined-B1Wz2Rzd.js";import"./InfoCircleFilled-9dsj_Nm8.js";import"./KeyCode-Bfjm3k6b.js";import"./PurePanel-BVQW51Q3.js";import"./useForceUpdate-Cb-16ZfM.js";import"./CheckOutlined-DTHRp8rd.js";import"./SearchOutlined-D4A1T3K6.js";import"./useNotification-4XyWe70T.js";import"./index-CsUWG4nD.js";import"./cjs-wu2YKcdf.js";import"./Overflow-C-Iz2ka9.js";import"./CalendarOutlined-DVyygKEd.js";import"./index-DDs0x0Q4.js";import"./EllipsisOutlined-Cn-2e4jY.js";import"./Dropdown-Dec2Znn0.js";import"./index-DN31wMcw.js";import"./AuthModal-BnTXj22D.js";import"./index-B8tbPq5o.js";import"./index-BpA3Fuot.js";import"./ReCAPTCHAUtil-CIOfCtCN.js";import"./index-BZbTVXNt.js";import"./PlusOutlined-DTU3Jvmp.js";var _e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"};const Re=_e;var Ne=function(m,s){return a.createElement(W,Y({},m,{ref:s,icon:Re}))};const Ve=a.forwardRef(Ne);var Ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M894 462c30.9 0 43.8-39.7 18.7-58L530.8 126.2a31.81 31.81 0 00-37.6 0L111.3 404c-25.1 18.2-12.2 58 18.8 58H192v374h-72c-4.4 0-8 3.6-8 8v52c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-52c0-4.4-3.6-8-8-8h-72V462h62zM512 196.7l271.1 197.2H240.9L512 196.7zM264 462h117v374H264V462zm189 0h117v374H453V462zm307 374H642V462h118v374z"}}]},name:"bank",theme:"outlined"};const We=Ue;var Ye=function(m,s){return a.createElement(W,Y({},m,{ref:s,icon:We}))};const qe=a.forwardRef(Ye);var Je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136V232h752v560zM610.3 476h123.4c1.3 0 2.3-3.6 2.3-8v-48c0-4.4-1-8-2.3-8H610.3c-1.3 0-2.3 3.6-2.3 8v48c0 4.4 1 8 2.3 8zm4.8 144h185.7c3.9 0 7.1-3.6 7.1-8v-48c0-4.4-3.2-8-7.1-8H615.1c-3.9 0-7.1 3.6-7.1 8v48c0 4.4 3.2 8 7.1 8zM224 673h43.9c4.2 0 7.6-3.3 7.9-7.5 3.8-50.5 46-90.5 97.2-90.5s93.4 40 97.2 90.5c.3 4.2 3.7 7.5 7.9 7.5H522a8 8 0 008-8.4c-2.8-53.3-32-99.7-74.6-126.1a111.8 111.8 0 0029.1-75.5c0-61.9-49.9-112-111.4-112s-111.4 50.1-111.4 112c0 29.1 11 55.5 29.1 75.5a158.09 158.09 0 00-74.6 126.1c-.4 4.6 3.2 8.4 7.8 8.4zm149-262c28.5 0 51.7 23.3 51.7 52s-23.2 52-51.7 52-51.7-23.3-51.7-52 23.2-52 51.7-52z"}}]},name:"idcard",theme:"outlined"};const Ke=Je;var Ge=function(m,s){return a.createElement(W,Y({},m,{ref:s,icon:Ke}))};const Qe=a.forwardRef(Ge);var Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H544v152c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V544H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h152V328c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v152h152c4.4 0 8 3.6 8 8v48z"}}]},name:"plus-circle",theme:"filled"};const Ze=Xe;var ea=function(m,s){return a.createElement(W,Y({},m,{ref:s,icon:Ze}))};const aa=a.forwardRef(ea);var ta={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"};const oa=ta;var sa=function(m,s){return a.createElement(W,Y({},m,{ref:s,icon:oa}))};const na=a.forwardRef(sa);var ra={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M759 335c0-137-111-248-248-248S263 198 263 335c0 82.8 40.6 156.2 103 201.2-.4.2-.7.3-.9.4-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00136 874.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C356 614.2 431 583 511 583c137 0 248-111 248-248zM511 507c-95 0-172-77-172-172s77-172 172-172 172 77 172 172-77 172-172 172zm105 221h264c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H703.5l47.2-60.1a8.1 8.1 0 001.7-4.9c0-4.4-3.6-8-8-8h-72.6c-4.9 0-9.5 2.3-12.6 6.1l-68.5 87.1c-4.4 5.6-6.8 12.6-6.8 19.8.1 17.7 14.4 32 32.1 32zm240 64H592c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h176.5l-47.2 60.1a8.1 8.1 0 00-1.7 4.9c0 4.4 3.6 8 8 8h72.6c4.9 0 9.5-2.3 12.6-6.1l68.5-87.1c4.4-5.6 6.8-12.6 6.8-19.8-.1-17.7-14.4-32-32.1-32z"}}]},name:"user-switch",theme:"outlined"};const ia=ra;var la=function(m,s){return a.createElement(W,Y({},m,{ref:s,icon:ia}))};const pe=a.forwardRef(la);var ca={icon:function(m,s){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M955.7 856l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z",fill:m}},{tag:"path",attrs:{d:"M172.2 828.1h679.6L512 239.9 172.2 828.1zM560 720a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm-16-304v184c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V416c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8z",fill:s}},{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8z",fill:m}}]}},name:"warning",theme:"twotone"};const da=ca;var ma=function(m,s){return a.createElement(W,Y({},m,{ref:s,icon:da}))};const ne=a.forwardRef(ma),pa=({isVisible:i,onClose:m})=>{const[s,y]=a.useState({}),[j,C]=a.useState({}),[p,h]=a.useState(null),[w,S]=a.useState(null),[z,M]=a.useState(!1),[H,B]=a.useState(""),[P,F]=a.useState(""),[O,R]=a.useState(""),[I,N]=a.useState({}),[D,T]=a.useState(""),{authData:A}=Q(),t=A.companyID,n=async d=>{if(d.length===8)try{const u=await he.get(`https://viacep.com.br/ws/${d}/json/`);N(u.data)}catch(u){console.error("Erro ao buscar CEP:",u)}};a.useEffect(()=>{n(H)},[H]);const l=`${I.logradouro??""}, ${P??""}, ${O??""}, ${I.bairro??""} - ${I.localidade??""} / ${I.uf??""} - ${H}`;a.useEffect(()=>{i&&(async()=>{if(t&&A.authToken){M(!0);try{const u=await E.get(`/companies/${t}`,{headers:{Authorization:`Bearer ${A.authToken}`}});y(u.data),T(u.data.endereco)}catch(u){u.response?console.error("API response error:",u.response):console.error("Error fetching company data:",u)}finally{M(!1)}}else console.error("Company ID or auth token not found in local storage")})()},[t,A.authToken,i]),a.useEffect(()=>{C(s),s.logo_path&&S(`${ue}/${s.logo_path}`)},[s]);const g=d=>{const{name:u,value:L}=d.target;C(q=>({...q,[u]:L}))},c=d=>{if(d.fileList.length===0){h(null);return}const u=d.fileList[0];if(u.type!=="image/png"||u.size>5e5){b.error("Por favor, selecione um arquivo PNG de até 500kb.");return}if(u){const L=URL.createObjectURL(u.originFileObj);S(L)}h(u)},o=async()=>{M(!0);try{const d={...j,endereco:l},u=new FormData;u.append("nome",d.nome),u.append("telefone",d.telefone),u.append("instagram",d.instagram),u.append("endereco",d.endereco),p&&u.append("logo",p.originFileObj);const L=await E.put(`/companies/${s.company_id}`,u,{headers:{"Content-Type":"multipart/form-data"}});y(L.data.company),m()}catch(d){console.error("Erro ao atualizar dados da empresa:",d)}finally{M(!1)}};return e.jsxs(V,{title:"Dados da Empresa",open:i,onCancel:m,footer:[e.jsx(k,{onClick:m,children:"Cancelar"},"cancel"),e.jsx(k,{type:"primary",onClick:o,children:"Salvar"},"submit")],children:[e.jsx("p",{children:"Essas informações estão presentes nos atestados e declarações."}),z?e.jsx(ie,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("h3",{children:"Logo:"}),w&&e.jsx("img",{src:w,style:{width:"45px",marginBottom:"10px"},alt:"Logo da Empresa"}),e.jsx(le,{title:"A imagem deve estar em PNG e ter até 500kb",children:e.jsx(fe,{beforeUpload:()=>!1,onChange:c,fileList:p?[p]:[],children:e.jsx(k,{icon:e.jsx(ge,{}),children:"Selecionar Logo"})})})]}),e.jsx($,{style:{marginBottom:"15px"},name:"nome",value:j.nome,onChange:g,placeholder:"Nome"}),e.jsx($,{style:{marginBottom:"15px"},name:"telefone",value:j.telefone,onChange:g,placeholder:"WhatsApp"}),e.jsx($,{style:{marginBottom:"15px"},name:"instagram",value:j.instagram,onChange:g,placeholder:"Instagram"}),e.jsx("label",{children:"Digite o CEP para atualizar o endereço:"}),e.jsx($,{style:{marginBottom:"15px"},name:"cep",value:H,onChange:d=>B(d.target.value),placeholder:"CEP"}),e.jsx($,{style:{marginBottom:"15px"},name:"numero",value:P,onChange:d=>F(d.target.value),placeholder:"Número"}),e.jsx($,{style:{marginBottom:"15px"},name:"referencia",value:O,onChange:d=>R(d.target.value),placeholder:"Referência"}),H&&e.jsxs(e.Fragment,{children:[e.jsx("label",{children:"Novo Endereço:"}),e.jsx($,{style:{marginBottom:"15px"},name:"endereco",value:l,onChange:g,placeholder:"Endereço Completo"})]}),e.jsx("label",{children:"Endereço Atual:"}),e.jsx($,{style:{marginBottom:"15px"},name:"enderecoEmpresa",value:D,onChange:g,placeholder:"Endereço da Empresa",disabled:!0}),e.jsx($,{name:"cnpj",value:j.cnpj,onChange:g,placeholder:"CNPJ",disabled:!0}),e.jsx("h2",{children:"Plano"})]})]})},ua=()=>{const[i,m]=a.useState({}),[s,y]=a.useState({}),[j,C]=a.useState(null),[p,h]=a.useState(null),[w,S]=a.useState(!1),[z,M]=a.useState(""),[H,B]=a.useState(""),[P,F]=a.useState(""),[O,R]=a.useState({}),[I,N]=a.useState(""),{authData:D}=Q(),T=D.companyID,A=async c=>{if(c.length===8)try{const o=await he.get(`https://viacep.com.br/ws/${c}/json/`);R(o.data)}catch(o){console.error("Erro ao buscar CEP:",o)}};a.useEffect(()=>{A(z)},[z]);const t=`${O.logradouro??""}, ${H??""}, ${P??""}, ${O.bairro??""} - ${O.localidade??""} / ${O.uf??""} - ${z}`;a.useEffect(()=>{(async()=>{if(T&&D.authToken){S(!0);try{const o=await E.get(`/companies/${T}`,{headers:{Authorization:`Bearer ${D.authToken}`}});m(o.data),N(o.data.endereco)}catch(o){o.response?console.error("API response error:",o.response):console.error("Error fetching company data:",o)}finally{S(!1)}}else console.error("Company ID or auth token not found in local storage")})()},[T,D.authToken]),a.useEffect(()=>{y(i),i.logo_path&&h(`${ue}/${i.logo_path}`)},[i]);const n=c=>{const{name:o,value:d}=c.target;y(u=>({...u,[o]:d}))},l=c=>{if(c.fileList.length===0){C(null);return}const o=c.fileList[0];if(o.type!=="image/png"||o.size>5e5){b.error("Por favor, selecione um arquivo PNG de até 500kb.");return}if(o){const d=URL.createObjectURL(o.originFileObj);h(d)}C(o)},g=async()=>{S(!0);try{const c={...s,endereco:t},o=new FormData;o.append("nome",c.nome),o.append("telefone",c.telefone),o.append("instagram",c.instagram),o.append("endereco",c.endereco),j&&o.append("logo",j.originFileObj);const d=await E.put(`/companies/${i.company_id}`,o,{headers:{"Content-Type":"multipart/form-data"}});m(d.data.company)}catch(c){console.error("Erro ao atualizar dados da empresa:",c)}finally{S(!1)}};return e.jsxs("div",{children:[e.jsxs("h1",{children:["Dados da Empresa ",e.jsx(qe,{})]}),e.jsx("p",{children:"Essas informações estão presentes nos atestados e declarações."}),w?e.jsx(ie,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("h3",{children:"Logo:"}),p&&e.jsx("img",{src:p,style:{width:"45px",marginBottom:"10px"},alt:"Logo da Empresa"}),e.jsx(le,{title:"A imagem deve estar em PNG e ter até 500kb",children:e.jsx(fe,{beforeUpload:()=>!1,onChange:l,fileList:j?[j]:[],children:e.jsx(k,{icon:e.jsx(ge,{}),children:"Selecionar Logo"})})})]}),e.jsx($,{style:{marginBottom:"15px"},name:"nome",value:s.nome,onChange:n,placeholder:"Nome"}),e.jsx($,{style:{marginBottom:"15px"},name:"telefone",value:s.telefone,onChange:n,placeholder:"WhatsApp"}),e.jsx($,{style:{marginBottom:"15px"},name:"instagram",value:s.instagram,onChange:n,placeholder:"Instagram"}),e.jsx("label",{children:"Digite o CEP para atualizar o endereço:"}),e.jsx($,{style:{marginBottom:"15px"},name:"cep",value:z,onChange:c=>M(c.target.value),placeholder:"CEP"}),e.jsx($,{style:{marginBottom:"15px"},name:"numero",value:H,onChange:c=>B(c.target.value),placeholder:"Número"}),e.jsx($,{style:{marginBottom:"15px"},name:"referencia",value:P,onChange:c=>F(c.target.value),placeholder:"Referência"}),z&&e.jsxs(e.Fragment,{children:[e.jsx("label",{children:"Novo Endereço:"}),e.jsx($,{style:{marginBottom:"15px"},name:"endereco",value:t,onChange:n,placeholder:"Endereço Completo"})]}),e.jsx("label",{children:"Endereço Atual:"}),e.jsx($,{style:{marginBottom:"15px"},name:"enderecoEmpresa",value:I,onChange:n,placeholder:"Endereço da Empresa",disabled:!0}),e.jsx($,{name:"cnpj",value:s.cnpj,onChange:n,placeholder:"CNPJ",disabled:!0}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx(k,{onClick:g,type:"primary",style:{marginRight:"10px"},children:"Salvar"}),e.jsx(k,{children:"Cancelar"})]})]})]})},ha=({isVisible:i,setIsVisible:m,selectedProfessional:s})=>{const[y,j]=a.useState([]),C=["Segunda","Terça","Quarta","Quinta","Sexta","Sábado","Domingo"],[p,h]=a.useState({}),[w,S]=a.useState(null),[z,M]=a.useState([]),[H,B]=a.useState({}),P=t=>{S(t?t.format("HH:mm"):null)},F=t=>{let n={};return t.forEach(l=>{n[l.id]={startam:l.startam,endam:l.endam,startpm:l.startpm,endpm:l.endpm}}),n},O=(t,n)=>{h(l=>({...l,[t]:{...l[t],[n]:null}}))},R=(t,n)=>{B(l=>({...l,[t]:n}))};a.useEffect(()=>{(async()=>{try{const n=await E.get("/dias-semanais");j(n.data),h(F(n.data))}catch(n){console.error("Erro ao buscar dias da semana",n)}})()},[]);const I=y.sort((t,n)=>C.indexOf(t.dia)-C.indexOf(n.dia)),N=async(t,n)=>{try{if((await E.put(`/dias-semanais/${t}`,{ativo:n,professional_id:s})).data.professional_id===s)j(g=>g.map(c=>c.id===t?{...c,ativo:n}:c));else throw new Error("Dia da semana não corresponde ao profissional selecionado.")}catch(l){console.error("Erro ao atualizar dia da semana",l),b.error("Erro ao atualizar dia da semana. Tente novamente.")}};a.useEffect(()=>{s&&(async()=>{try{const n=await E.get(`/dias-semanais/?professional_id=${s}`);j(n.data),h(F(n.data))}catch(n){console.error("Erro ao buscar dias da semana",n)}})()},[s]),a.useEffect(()=>{i&&s&&(async()=>{try{const n=await E.get(`/dias-semanais/?professional_id=${s}`);j(n.data);const l=n.data.reduce((g,c)=>(c.endereco_id&&(g[c.id]=c.endereco_id),g),{});B(l),h(F(n.data))}catch(n){console.error("Erro ao buscar dias da semana",n)}})()},[i,s]),a.useEffect(()=>{i&&s&&(async()=>{try{const n=await E.get(`/professional-intervals/professional/${s}`);n.data?S(_(n.data.intervalo,"HH:mm")):S(null)}catch(n){n.response&&n.response.status===404?(b.info("Nenhum intervalo configurado para este profissional."),S(null)):(console.error("Erro ao buscar intervalo de atendimento",n),b.error("Erro ao buscar intervalo de atendimento. Tente novamente."))}})()},[i,s]),a.useEffect(()=>{s&&(async()=>{try{const l=(await E.get(`/enderecos/professional/${s}`)).data||[];if(M(l),l.length===1){const g=l[0].id,c=y.reduce((o,d)=>(o[d.id]=g,o),{});B(c)}}catch(n){console.error("Erro ao carregar endereços:",n),b.error("Erro ao carregar endereços.")}})()},[s,y]);const D=async()=>{const t=y.some(o=>o.ativo&&H[o.id]);if(z.length>0&&!t){b.error("Por favor, selecione pelo menos um endereço para os dias ativos.");return}const l=[];let g=!1;for(const o of y){const d=p[o.id];if(o.ativo&&(!d||!d.startam||!d.endam||!d.startpm||!d.endpm)){g=!0,b.error(`Por favor, defina todos os intervalos de tempo para ${o.dia}.`);break}const u={ativo:o.ativo,endereco_id:H[o.id],...p[o.id]};if(o.changed||p[o.id]){const L=E.put(`/dias-semanais/${o.id}`,u);l.push(L)}}if(g)return;if(!w){b.error("Por favor, selecione um intervalo de tempo entre atendimentos.");return}const c={professional_id:s,intervalo:w};l.push(E.post("/professional-intervals",c));try{await Promise.all(l),b.success("Configurações do padrão semanal e intervalo de atendimento atualizadas com sucesso!")}catch(o){console.error("Erro ao atualizar configurações",o),b.error("Erro ao atualizar configurações. Tente novamente.")}finally{m(!1)}},T=(t,n,l)=>{h(g=>({...g,[t]:{...g[t],[n]:l?l.format("HH:mm"):null}}))},A=()=>{const t=y.find(g=>g.ativo).id,n=p[t],l={...p};y.forEach(g=>{g.id!==t&&(l[g.id]={...n})}),h(l)};return e.jsxs(V,{title:"Padrão Semanal de Atendimento",open:i,onCancel:()=>m(!1),footer:[e.jsx(k,{onClick:()=>m(!1),children:"Cancelar"},"back"),e.jsx(k,{type:"primary",onClick:D,children:"Salvar"},"submit")],width:600,bodyStyle:{maxHeight:"60vh",overflowY:"auto",padding:"0 10px 0 0"},children:[e.jsx("p",{children:"Aqui você configura os dias da semana, locais e intervalos de tempo que sua agenda estará disponível para seus clientes:"}),e.jsx(k,{type:"primary",onClick:A,style:{marginBottom:"10px",width:"100%"},children:"Replicar Horários"}),e.jsx("div",{children:I.map(t=>{var n,l,g,c;return e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[e.jsx(de,{type:"checkbox",checked:t.ativo,onChange:()=>N(t.id,!t.ativo)}),e.jsx("span",{style:{marginLeft:"10px"},children:t.dia})]}),e.jsx("div",{style:{margin:"10px 0"},children:z.map(o=>e.jsx(de,{checked:H[t.id]===o.id,onChange:()=>R(t.id,o.id),children:`${o.rua}, ${o.numero} - ${o.cidade}/${o.uf}`},o.id))}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(U,{disabled:!t.ativo,format:"HH:mm",placeholder:"Início AM",onChange:o=>T(t.id,"startam",o),value:(n=p[t.id])!=null&&n.startam?_(p[t.id].startam,"HH:mm"):null,onFocus:()=>O(t.id,"startam")}),e.jsx(U,{disabled:!t.ativo,format:"HH:mm",placeholder:"Fim AM",onChange:o=>T(t.id,"endam",o),value:(l=p[t.id])!=null&&l.endam?_(p[t.id].endam,"HH:mm"):null,onFocus:()=>O(t.id,"endam")}),e.jsx(U,{disabled:!t.ativo,format:"HH:mm",placeholder:"Início PM",onChange:o=>T(t.id,"startpm",o),value:(g=p[t.id])!=null&&g.startpm?_(p[t.id].startpm,"HH:mm"):null,onFocus:()=>O(t.id,"startpm")}),e.jsx(U,{disabled:!t.ativo,format:"HH:mm",placeholder:"Fim PM",onChange:o=>T(t.id,"endpm",o),value:(c=p[t.id])!=null&&c.endpm?_(p[t.id].endpm,"HH:mm"):null,onFocus:()=>O(t.id,"endpm")})]})]},t.id)})}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("label",{style:{marginRight:"40px"},children:"Intervalo de tempo entre um atendimento e outro:"}),e.jsx(U,{format:"HH:mm",placeholder:"Selecione o intervalo",onChange:P,onFocus:()=>S(null),value:w?_(w,"HH:mm"):null})]}),e.jsx($e,{})]})},fa=({isLinkModalVisible:i,onLinkModalClose:m})=>{const{authData:s}=Q(),y=s.companyID,j=()=>`${window.location.origin}/#/agendar/${y}`,C=()=>{navigator.clipboard.writeText(j()).then(()=>{b.success("Link copiado para a área de transferência!"),m()}).catch(p=>{b.error("Falha ao copiar o link."),console.error("Erro ao copiar o link:",p)})};return e.jsxs(V,{title:"Link do Agendamento Para Clientes !",open:i,onOk:C,onCancel:m,footer:[e.jsx(k,{type:"primary",onClick:C,children:"Copiar Link"},"copy"),e.jsx(k,{onClick:m,children:"Fechar"},"close")],children:[e.jsx("p",{children:"O link a seguir pode ser compartilhado com seus clientes após a configuração da agenda."}),e.jsxs("p",{children:[e.jsx(xe,{})," Copie e compartilhe este link para permitir o agendamento:"]}),e.jsx($,{value:j(),readOnly:!0})]})};const{Option:ga}=ye,xa=()=>{_.locale("pt-br");const[i,m]=a.useState(window.innerWidth<768),[s,y]=a.useState(!1),[j,C]=a.useState(null),[p,h]=a.useState(null),[w,S]=a.useState(!1),[z,M]=a.useState(null),[H,B]=a.useState([]),[P,F]=a.useState(!1),[O,R]=a.useState([]),[I,N]=a.useState(null),[D,T]=a.useState(!1),{authData:A}=Q(),t=A.companyID,[n,l]=a.useState(),[g,c]=a.useState([{target:".select-professional",content:"Primeiro, selecione um profissional da lista."},{target:".weekly-pattern-button",content:"Agora, clique aqui para definir o padrão semanal de horários."},{target:".generate-link-button",content:"Por fim, clique aqui para gerar um link de agendamento para os clientes, compartilhe o link nas suas redes sociais."}]),o={next:"Próximo ➡️",last:"Blz 😊",skip:"Fazer depois 😞",close:"Close"};a.useEffect(()=>{(async()=>{if(t&&A.authToken)try{const v=await E.get(`/professionals?company_id=${t}`,{headers:{Authorization:`Bearer ${A.authToken}`}});if(v.status!==200)throw new Error("Falha ao buscar dados dos profissionais");const Se=ae.AES.decrypt(v.data,"%A0533266q6td9g*"),De=JSON.parse(Se.toString(ae.enc.Utf8));R(De)}catch(v){console.error("Error fetching professionals:",v)}else console.error("Company ID or auth token not found in local storage")})()},[t,A.authToken]),a.useEffect(()=>{const r=()=>m(window.innerWidth<768);return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]);const d=r=>{const{status:v}=r;(v==="finished"||v==="skipped")&&l(!1)},[u,L]=a.useState(null),q=r=>{M(_(r.date,"DD/MM/YYYY")),S(r.allDay),C(r.startTime?_(r.startTime,"HH:mm"):null),h(r.endTime?_(r.endTime,"HH:mm"):null),L(r.id),y(!0)},[ee,J]=a.useState(!1),[X,K]=a.useState(null),te=r=>{K(r),J(!0)},x=async()=>{if(J(!1),X)try{await E.delete(`/disabledDates/${X}`),B(r=>r.filter(v=>v.id!==X)),b.success("Data excluída com sucesso!")}catch(r){console.error("Erro ao excluir data",r),b.error("Erro ao excluir data. Tente novamente.")}K(null),M(null),S(!1),C(null),h(null)},f=r=>{te(r)},Z=[{title:"Data",dataIndex:"date",key:"date",render:(r,v)=>_(v.date,"DD/MM/YYYY").format("DD [de] MMMM YYYY")},...i?[]:[{title:"Dia da Semana",dataIndex:"weekday",key:"weekday",render:(r,v)=>_(v.date,"DD/MM/YYYY").format("dddd")}],{title:i?"Intervalo":"Intervalo de Tempo",dataIndex:"time",key:"time",render:(r,v)=>v.allday?"Todo o dia":v.starttime&&v.endtime?`${v.starttime.slice(0,5)} - ${v.endtime.slice(0,5)}`:"Não especificado"},{title:"Ações",key:"action",render:(r,v)=>e.jsxs(e.Fragment,{children:[e.jsx(k,{icon:e.jsx(Ve,{}),onClick:()=>q(v),type:"primary",title:"Editar horário",style:{marginLeft:"10px"},children:i?"":"Editar"}),e.jsx(k,{icon:e.jsx(re,{}),onClick:()=>f(v.id),type:"primary",danger:!0,title:"Excluir",style:{marginLeft:"10px"},children:i?"":"Excluir"})]})}],G=()=>{y(!0),L(null),M(null)},oe=()=>{Ee(),y(!1)},je=()=>{y(!1),L(null)},Ce=()=>!z||!w&&(!j||!p),be=r=>{S(r),r&&(C(null),h(null))},ke=()=>{F(!0)};a.useEffect(()=>{(async()=>{if(I)try{const v=await E.get(`/disabledDates?professional_id=${I}`);B(v.data)}catch(v){console.error("Erro ao buscar datas desabilitadas",v)}})()},[I]);const Ee=async()=>{if(z&&I)try{const r=j||p,v={date:z.format("DD/MM/YYYY"),allDay:r?!1:w,startTime:j?j.format("HH:mm"):null,endTime:p?p.format("HH:mm"):null,professional_id:I};let se;u?(se=await E.put(`/disabledDates/${u}`,v),b.success("Data atualizada com sucesso!")):(se=await E.post("/disabledDates",v),b.success("Data salva com sucesso!")),M(null),S(!1),C(null),h(null),L(null)}catch(r){console.error("Erro ao salvar data",r),b.error("Erro ao salvar data. Tente novamente.")}else b.warning("Selecione um profissional e uma data para prosseguir.")};return a.useEffect(()=>{localStorage.getItem("tutorialShown")||(l(!0),localStorage.setItem("tutorialShown","true"))},[]),e.jsxs("div",{children:[e.jsxs("h1",{children:["Controle da Agenda ",e.jsx(ze,{})]}),e.jsxs("p",{children:["Aqui você inclui seu padrão de atendiemnto semanal que ficará disponivel no link de agendamento.",e.jsx(He,{})]}),e.jsxs("div",{className:"padrao-semanal-mobile",children:[e.jsx(ye,{className:"select-professional",showSearch:!0,style:{width:200,marginBottom:20,marginRight:20,display:"flex",flexWrap:"wrap"},placeholder:"Selecione um profissional",optionFilterProp:"children",onChange:r=>N(r),filterOption:(r,v)=>v.children.toLowerCase().indexOf(r.toLowerCase())>=0,value:I,children:O.map(r=>e.jsx(ga,{value:r.id,children:r.nome},r.id))}),e.jsx(k,{className:"weekly-pattern-button",type:"primary",onClick:ke,disabled:!I,children:"Padrão Semanal"})]}),e.jsxs(V,{title:"Desabilitar Data ou Horário",visible:s,onOk:oe,onCancel:je,okButtonProps:{disabled:Ce()},children:[e.jsxs("p",{children:["Ao executar essa ação os seus clientes não conseguirão agendar na data ou horários selecionados ",e.jsx(ne,{twoToneColor:"#ff0000"})]}),e.jsx(Me,{format:"DD/MM/YYYY",value:z,onChange:M,disabled:!!u}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",checked:w,onChange:r=>be(r.target.checked)})," Todos os horários."]}),e.jsxs("p",{children:["Escolha Hora Inicial 00:00 para intervalos no inicio do dia ",e.jsx(ne,{twoToneColor:"#ff0000"})]}),!w&&e.jsxs("div",{children:[e.jsx(U,{format:"HH:mm",onChange:C,placeholder:"Hora Inicial"}),e.jsx(U,{format:"HH:mm",onChange:h,placeholder:"Hora Final"})]})]}),e.jsx(V,{title:"Vai disponibilizar este dia/horário?",visible:ee,onOk:x,onCancel:()=>J(!1),footer:[e.jsx(k,{onClick:()=>J(!1),children:"Não"},"back"),e.jsx(k,{type:"primary",onClick:x,children:"Sim"},"submit")],children:e.jsx("p",{children:"Ao executar esta ação o horário selecionado ficará disponível para os seus clientes, tem certeza que deseja prosseguir? "})}),e.jsx(ha,{isVisible:P,setIsVisible:F,selectedProfessional:I}),e.jsxs("div",{className:"datadesabilitados",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[e.jsx("h2",{style:{marginRight:"18px",fontSize:"18px"},children:"Datas ou Horário Desabilitadas"}),e.jsxs(k,{type:"primary",onClick:G,style:{marginRight:"10px"},children:[e.jsx(aa,{}),"Incluir"]})]}),e.jsxs("p",{children:["Feriados locais precisam ser incluídos manualmente ",e.jsx(ne,{twoToneColor:"#ff0000"})]}),e.jsxs(k,{className:"generate-link-button",style:{marginBottom:"20px"},type:"primary",onClick:()=>T(!0),children:[e.jsx(xe,{})," Gerar Link de Agendamento"]}),D&&e.jsx(fa,{isLinkModalVisible:D,onLinkModalClose:()=>T(!1),companyID:t}),e.jsx(ce,{dataSource:H,columns:Z,rowKey:"id"})]}),e.jsx(ve,{run:n,steps:g,callback:d,continuous:!0,showProgress:!0,locale:o,showSkipButton:!0,styles:{options:{zIndex:1e4}}})]})},va=()=>{const[i,m]=a.useState([]),[s,y]=a.useState(null),{authData:j}=Q(),C=j.companyID;a.useEffect(()=>{(async()=>{try{const w=await E.get(`/chamados/${C}`);m(w.data)}catch{b.error("Erro ao buscar chamados")}})()},[C]);const p=[{title:"Número do Chamado",dataIndex:"ticket_number",key:"ticket_number"},{title:"Data de Abertura",dataIndex:"created_at",key:"created_at",render:h=>new Date(h).toLocaleDateString()},{title:"Status",dataIndex:"status",key:"status",render:h=>e.jsx(le,{title:h===null?"A Iniciar":h===1?"Em Andamento":"Concluído",children:e.jsxs("span",{children:[h===null?e.jsx(Le,{style:{color:"red",marginRight:8}}):h===1?e.jsx(Pe,{style:{color:"orange",marginRight:8}}):e.jsx(Be,{style:{color:"green",marginRight:8}}),h===null?"A Iniciar":h===1?"Em Andamento":"Concluído"]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs("h1",{children:["Chamados ",e.jsx(na,{})]}),e.jsx(ce,{columns:p,dataSource:i,onRow:h=>({onClick:()=>{y(h)}})}),e.jsxs(V,{title:`Chamado ${s==null?void 0:s.ticket_number}`,open:!!s,onCancel:()=>y(null),footer:null,children:[e.jsx("p",{children:e.jsx("b",{children:"Seu relato:"})}),e.jsx("p",{children:s==null?void 0:s.description}),e.jsx("p",{children:e.jsx("b",{children:"Resposta:"})}),e.jsx("p",{children:(s==null?void 0:s.answer)===null?"Seu chamado logo será atendido e faremos o impossível para solucionar sua demanda.":s==null?void 0:s.answer})]})]})};function Ht(){const[i,m]=a.useState(window.innerWidth<768),[s,y]=a.useState(!1),[j,C]=a.useState(!1),[p,h]=a.useState([]),[w,S]=a.useState(null),[z,M]=a.useState(!1),[H,B]=a.useState(null),[P,F]=a.useState(null),[O,R]=a.useState(!1),[I,N]=a.useState(!1),{authData:D}=Q(),T=D.companyID,A=D.userSpecialties,t={next:"Proceed",last:"Blz 😊",skip:"Not Now",close:"Close"},[n,l]=a.useState([{target:".add-professional-button",content:'Clique aqui para adicionar um novo profissional ao sistema, faça o cadastro com atenção incluindo todos os dados. Em seguida clique em "Controle da Agenda"'}]);a.useEffect(()=>{localStorage.getItem("configsTutorialShown")||(N(!0),localStorage.setItem("configsTutorialShown","true"))},[]);const g=x=>{const{status:f}=x;(f==="finished"||f==="skipped")&&N(!1)},c=x=>{h(w?p.map(f=>f.id===x.id?x:f):[...p,x]),L()};a.useEffect(()=>{(async()=>{if(T&&D.authToken){C(!0);try{const Z=(await E.get(`/companies/${T}`,{headers:{Authorization:`Bearer ${D.authToken}`}})).data.service_id;console.log("servico",Z);const G=await E.get(`/service_details/${Z}`,{headers:{Authorization:`Bearer ${D.authToken}`}});F(G.data.persons),console.log("persons",G.data.persons)}catch(f){console.error("Erro ao buscar o número máximo de profissionais:",f),b.error("Erro ao buscar informações do serviço")}finally{C(!1)}}})()},[T,D.authToken]),a.useEffect(()=>{(async()=>{try{const f=await E.get("/companies/1");B(f.data)}catch(f){console.error("Erro ao buscar dados da empresa:",f),b.error("Erro ao buscar dados da empresa")}})()},[]);const o=()=>{M(!1)};a.useEffect(()=>{(async()=>{if(T&&D.authToken){C(!0);try{const f=await E.get(`/professionals?company_id=${T}`,{headers:{Authorization:`Bearer ${D.authToken}`}}),G=ae.AES.decrypt(f.data,"%A0533266q6td9g*"),oe=JSON.parse(G.toString(ae.enc.Utf8));h(oe)}catch(f){f.response?console.error("API response error:",f.response):console.error("Error fetching professionals:",f)}finally{C(!1)}}else console.error("Company ID or auth token not found in local storage")})()},[T,D.authToken]),a.useEffect(()=>{const x=()=>m(window.innerWidth<768);return window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]);const d=()=>{if(p.length>=P){R(!0);return}S(null),y(!0)},u=()=>{R(!1)},L=()=>{y(!1),S(null)},q=x=>{S(x),y(!0)},ee=x=>{V.confirm({title:"Tem certeza que deseja excluir este profissional? 😢",content:"Remarque os clientes ja agendados para outro Profissional, Fazendo isso, todos os horários referentes a ele ficarão indisponíveis para os clientes!",okText:"Excluir",okType:"danger",cancelText:"Cancelar",onOk(){J(x.id)}})},J=async x=>{C(!0);try{await E.delete(`/professionals/${x}`),h(p.filter(f=>f.id!==x)),b.success("Profissional excluído com sucesso")}catch(f){console.error("Erro ao excluir o profissional:",f),b.error("Erro ao excluir o profissional")}finally{C(!1)}},X=x=>{const f=x.split(" ");return f.length>2?`${f[0]} ${f[1]}`:x};let K=[{title:"Nome",dataIndex:"nome",key:"nome",render:x=>i?X(x):x}];i||K.push({title:"Celular",dataIndex:"celular",key:"celular"},{title:"Registro Profissional",dataIndex:"registro_profissional",key:"registro_profissional"}),K.push({title:"Ação",key:"action",render:(x,f)=>e.jsxs(e.Fragment,{children:[e.jsx(we,{to:`/professionals/${f.id}`,style:{marginRight:8},children:i?e.jsx(k,{icon:e.jsx(pe,{}),onClick:()=>q(f)}):e.jsxs(k,{type:"primary",onClick:()=>q(f),children:[e.jsx(pe,{})," Editar"]})}),i?e.jsx(k,{icon:e.jsx(re,{}),type:"primary",danger:!0,onClick:()=>ee(f)}):e.jsxs(k,{type:"primary",danger:!0,onClick:()=>ee(f),children:[e.jsx(re,{})," Excluir"]})]})});const te=[{key:"1",tab:i?"Profissionais":"Controle de Profissionais",content:e.jsxs(e.Fragment,{children:[e.jsxs("h1",{children:["Controle de Profissionais ",e.jsx(Qe,{})]}),e.jsx("p",{children:"Aqui você pode adicionar profissionais ou atualizar seus dados."}),e.jsxs(k,{className:"add-professional-button",style:{marginBottom:"10px"},type:"primary",onClick:d,children:[e.jsx(Te,{}),"Adicionar Profissional"]}),e.jsxs(V,{title:"Limite de Profissionais Atingido",visible:O,onCancel:u,footer:[e.jsx(k,{onClick:u,children:"Cancelar"},"back")],children:[e.jsxs("p",{children:["Seu plano contratado só permite até ",P," profissionais. Caso sua clínica esteja crescendo, faça um upgrade do seu plano."]}),e.jsx(Oe,{maxProfessionals:P})]}),e.jsx(Ie,{isVisible:s,onClose:L,initialData:w,userSpecialties:A,onProfessionalSaved:c}),e.jsx(pa,{isVisible:z,onClose:o,company:H}),j?e.jsx(ie,{size:"large"}):e.jsx(ce,{dataSource:p,columns:K,rowKey:"id"})]})},{key:"2",tab:i?"Agenda":"Controle da Agenda",content:e.jsx(e.Fragment,{children:e.jsx(xa,{})})},{key:"3",tab:i?"Empresa":"Dados Empresa",content:e.jsx(e.Fragment,{children:e.jsx(ua,{})})},!i&&{key:"4",tab:"Chamados",content:e.jsx(e.Fragment,{children:e.jsx(va,{})})},!i&&{key:"5",tab:"Meu Plano",content:e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx(Ae,{})})}].filter(Boolean);return e.jsxs("div",{className:"tabela",children:[e.jsxs("h3",{children:["Navegue entre as opções abaixo ",e.jsx(Fe,{})]}),e.jsx(me,{defaultActiveKey:"1",className:"custom-tab-class",type:"card",style:{margin:"2rem 0 0 0"},children:te.map(x=>e.jsx(me.TabPane,{tab:x.tab,children:x.content},x.key))}),e.jsx(ve,{run:I,steps:n,callback:g,continuous:!0,showSkipButton:!0,locale:t,styles:{options:{zIndex:1e4}}})]})}export{Ht as default};
