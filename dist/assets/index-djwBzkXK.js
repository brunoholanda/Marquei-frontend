import{r as s,d as te,j as a,L as oe}from"./index-kPzU05gx.js";import{a as A}from"./api-p_bhudRe.js";import{h as D}from"./moment-gy9AvL1k.js";/* empty css                     */import{S as re,A as ne}from"./ScheduleModal-UQ0yadHE.js";import{C as T}from"./index-CsRKGip1.js";import{S as ae}from"./ScheduleOutlined-DS4i6pwx.js";import{S as z}from"./index-CDd_3z3j.js";import{D as ie}from"./index-BUWDoS_L.js";import{c as M,A as H,_ as R}from"./AntdIcon-rDAQJIgd.js";import{B as w}from"./context-Cu6KQni0.js";import{P as se}from"./PlusOutlined-CtSp6DS-.js";import{T as le}from"./Table-B0u-CeGd.js";import{M as ce}from"./index-DmsyNvo6.js";import{m as j}from"./index-BfF3jSoh.js";import{g as de}from"./index-DvbXQ1GL.js";import{g as me,m as pe,r as ue,C as _}from"./useSize-Dir-JjEK.js";import{i as fe,g as ge,P as he,a as xe,b as ve,c as ye,T as k}from"./index-DSAf5tNC.js";import{E as Ce,C as Se}from"./ExclamationCircleOutlined-7uwGBhRF.js";import{C as be}from"./CloseCircleOutlined-ZbH0lEu3.js";import"./Styles-CGctwYhX.js";import"./styled-components.browser.esm-BWH_c5t_.js";import"./Serializer-CQbcCsmu.js";import"./index-COTnBvfG.js";import"./useForm-sTvtv3Iy.js";import"./render-CJmks47J.js";import"./row-BdR9_GnZ.js";import"./responsiveObserver-BuWZJpCK.js";import"./useLocale-D_rXO8QB.js";import"./ExclamationCircleFilled-C5haNHtp.js";import"./index-DdU0LtvV.js";import"./SearchOutlined-BKygTbfa.js";import"./index-Bg0REs51.js";import"./PurePanel-DZZoC6Qu.js";import"./index-DkzRl__G.js";import"./context-Cq6TeAM8.js";import"./KeyCode-Bp2GxRS5.js";import"./InfoCircleFilled-aimHxtz3.js";import"./index-BHFLF1lE.js";import"./Holidays-CC6NIhX_.js";import"./cjs-D5tZAF27.js";import"./registerModal-BemuQGxC.js";import"./index-D8T2WqBl.js";import"./index-Chjiymov.js";import"./commonMailDomains-C8uuVB4t.js";import"./WarningOutlined-CuxWXMQ9.js";import"./index-DOPZgS7U.js";import"./AuthModal-CTc-rfhF.js";import"./index-DPBYgAbq.js";import"./index-BSp-sa5F.js";import"./index-jIhnTVqN.js";import"./index-C_g5XK6A.js";import"./AddClientsModal-CZH8hJFG.js";import"./index-BxaDw8tE.js";import"./Overflow-DH1nb5VS.js";import"./CheckOutlined-CJXAI-D_.js";import"./CalendarOutlined-FfBpZXtG.js";import"./ClockCircleOutlined---JEIzSM.js";import"./index-qm-UxHX_.js";import"./EllipsisOutlined-CT_kym8T.js";import"./Dropdown-BnNsehg0.js";import"./useForceUpdate-B--ZqLvt.js";const $=e=>e?typeof e=="function"?e():e:null,Pe=e=>{const{componentCls:o,popoverColor:r,titleMinWidth:t,fontWeightStrong:i,innerPadding:c,boxShadowSecondary:u,colorTextHeading:m,borderRadiusLG:p,zIndexPopup:f,titleMarginBottom:y,colorBgElevated:x,popoverBg:l,titleBorderBottom:g,innerContentPadding:C,titlePadding:h}=e;return[{[o]:Object.assign(Object.assign({},ue(e)),{position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:f,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","--antd-arrow-background-color":x,"&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},[`${o}-content`]:{position:"relative"},[`${o}-inner`]:{backgroundColor:l,backgroundClip:"padding-box",borderRadius:p,boxShadow:u,padding:c},[`${o}-title`]:{minWidth:t,marginBottom:y,color:m,fontWeight:i,borderBottom:g,padding:h},[`${o}-inner-content`]:{color:r,padding:C}})},ge(e,"var(--antd-arrow-background-color)"),{[`${o}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow,display:"inline-block",[`${o}-content`]:{display:"inline-block"}}}]},je=e=>{const{componentCls:o}=e;return{[o]:he.map(r=>{const t=e[`${r}6`];return{[`&${o}-${r}`]:{"--antd-arrow-background-color":t,[`${o}-inner`]:{backgroundColor:t},[`${o}-arrow`]:{background:"transparent"}}}})}},Oe=e=>{const{lineWidth:o,controlHeight:r,fontHeight:t,padding:i,wireframe:c,zIndexPopupBase:u,borderRadiusLG:m,marginXS:p,lineType:f,colorSplit:y,paddingSM:x}=e,l=r-t,g=l/2,C=l/2-o,h=i;return Object.assign(Object.assign(Object.assign({titleMinWidth:177,zIndexPopup:u+30},xe(e)),ve({contentRadius:m,limitVerticalRadius:!0})),{innerPadding:c?0:12,titleMarginBottom:c?0:p,titlePadding:c?`${g}px ${h}px ${C}px`:0,titleBorderBottom:c?`${o}px ${f} ${y}`:"none",innerContentPadding:c?`${x}px ${h}px`:0})},W=me("Popover",e=>{const{colorBgElevated:o,colorText:r}=e,t=pe(e,{popoverBg:o,popoverColor:r});return[Pe(t),je(t),fe(t,"zoom-big")]},Oe,{resetStyle:!1,deprecatedTokens:[["width","titleMinWidth"],["minWidth","titleMinWidth"]]});var ke=function(e,o){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&o.indexOf(t)<0&&(r[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(e);i<t.length;i++)o.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(e,t[i])&&(r[t[i]]=e[t[i]]);return r};const we=(e,o,r)=>!o&&!r?null:s.createElement(s.Fragment,null,o&&s.createElement("div",{className:`${e}-title`},$(o)),s.createElement("div",{className:`${e}-inner-content`},$(r))),$e=e=>{const{hashId:o,prefixCls:r,className:t,style:i,placement:c="top",title:u,content:m,children:p}=e;return s.createElement("div",{className:M(o,r,`${r}-pure`,`${r}-placement-${c}`,t),style:i},s.createElement("div",{className:`${r}-arrow`}),s.createElement(ye,Object.assign({},e,{className:o,prefixCls:r}),p||we(r,u,m)))},Ee=e=>{const{prefixCls:o,className:r}=e,t=ke(e,["prefixCls","className"]),{getPrefixCls:i}=s.useContext(_),c=i("popover",o),[u,m,p]=W(c);return u(s.createElement($e,Object.assign({},t,{prefixCls:c,hashId:m,className:M(r,p)})))},Be=Ee;var Ae=function(e,o){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&o.indexOf(t)<0&&(r[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(e);i<t.length;i++)o.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(e,t[i])&&(r[t[i]]=e[t[i]]);return r};const Me=e=>{let{title:o,content:r,prefixCls:t}=e;return s.createElement(s.Fragment,null,o&&s.createElement("div",{className:`${t}-title`},$(o)),s.createElement("div",{className:`${t}-inner-content`},$(r)))},L=s.forwardRef((e,o)=>{const{prefixCls:r,title:t,content:i,overlayClassName:c,placement:u="top",trigger:m="hover",mouseEnterDelay:p=.1,mouseLeaveDelay:f=.1,overlayStyle:y={}}=e,x=Ae(e,["prefixCls","title","content","overlayClassName","placement","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle"]),{getPrefixCls:l}=s.useContext(_),g=l("popover",r),[C,h,b]=W(g),O=l(),v=M(c,h,b);return C(s.createElement(k,Object.assign({placement:u,trigger:m,mouseEnterDelay:p,mouseLeaveDelay:f,overlayStyle:y},x,{prefixCls:g,overlayClassName:v,ref:o,overlay:t||i?s.createElement(Me,{prefixCls:g,title:t,content:i}):null,transitionName:de(O,"zoom-big",x.transitionName),"data-popover-inject":!0})))});L._InternalPanelDoNotUseOrYouWillBeFired=Be;const Ne=L;var Ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-260 72h96v209.9L621.5 312 572 347.4V136zm220 752H232V136h280v296.9c0 3.3 1 6.6 3 9.3a15.9 15.9 0 0022.3 3.7l83.8-59.9 81.4 59.4c2.7 2 6 3.1 9.4 3.1 8.8 0 16-7.2 16-16V136h64v752z"}}]},name:"book",theme:"outlined"};const De=Ie;var Te=function(o,r){return s.createElement(H,R({},o,{ref:r,icon:De}))};const V=s.forwardRef(Te);var ze={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h360c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H184V184h656v320c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V144c0-17.7-14.3-32-32-32zM653.3 599.4l52.2-52.2a8.01 8.01 0 00-4.7-13.6l-179.4-21c-5.1-.6-9.5 3.7-8.9 8.9l21 179.4c.8 6.6 8.9 9.4 13.6 4.7l52.4-52.4 256.2 256.2c3.1 3.1 8.2 3.1 11.3 0l42.4-42.4c3.1-3.1 3.1-8.2 0-11.3L653.3 599.4z"}}]},name:"select",theme:"outlined"};const Ve=ze;var He=function(o,r){return s.createElement(H,R({},o,{ref:r,icon:Ve}))};const Re=s.forwardRef(He),Kt=()=>{const[e,o]=s.useState([]),[r,t]=s.useState(!1),[i,c]=s.useState(null),[u,m]=s.useState(!1),[p,f]=s.useState(""),[y,x]=s.useState([]),[l,g]=s.useState(null),[C,h]=s.useState(!1),{authData:b}=te(),O=b.companyID,v=async(n,d)=>{if(!d){j.error("Por favor, selecione um profissional primeiro.");return}t(!0);try{const S=n.format("DD/MM/YYYY"),P=await A.get("/agendamentos",{params:{data:S,professional_id:d}});o(P.data),t(!1)}catch(S){console.error("Erro ao buscar agendamentos",S),j.error("Erro ao buscar agendamentos"),t(!1)}};s.useEffect(()=>{(async()=>{if(O&&b.authToken)try{const d=await A.get(`/professionals?company_id=${O}`,{headers:{Authorization:`Bearer ${b.authToken}`}});if(d.status!==200)throw new Error("Falha ao buscar dados dos profissionais");const P=T.AES.decrypt(d.data,"%A0533266q6td9g*"),ee=JSON.parse(P.toString(T.enc.Utf8));x(ee)}catch(d){console.error("Error fetching professionals:",d)}else console.error("Company ID or auth token not found in local storage")})()},[O,b.authToken]);const Y=n=>{g(n),i&&v(i,n)};s.useEffect(()=>{l&&i&&v(i,l)},[l,i]);const F=n=>{c(n),l&&v(n,l)},[q,E]=s.useState(!1),[N,B]=s.useState(null),G=n=>{B(n),E(!0)},I=n=>{B(n),f(n.infoadicional||""),m(!0)},J=async()=>{if(!p){j.error("O campo de informações adicionais está vazio.");return}try{const n=await A.put(`/agendamentos/${N.id}`,{infoadicional:p});n.data&&n.data.success?(j.success("Informação adicional salva com sucesso!"),v(i,l)):j.error("Erro ao salvar a informação adicional.")}catch(n){console.error("Erro ao salvar a informação adicional",n),j.error("Erro ao salvar a informação adicional")}m(!1)},K=()=>{m(!1),f("")},U=(n,d)=>{const S=D(n.horario,"HH:mm"),P=D(d.horario,"HH:mm");return S.isBefore(P)?-1:S.isAfter(P)?1:0},X=[{title:"Nome",dataIndex:"nome",key:"nome",render:(n,d)=>a.jsx(Ne,{content:a.jsxs("div",{className:"baloom",children:[a.jsx("div",{children:a.jsx(k,{children:a.jsx(w,{type:"primary",style:{marginRight:8},onClick:()=>G(d),children:"Confirmar/Reagendar"})})}),a.jsxs("div",{children:[a.jsx(k,{children:a.jsx(oe,{to:`/client-details/${d.id}`,style:{marginRight:8},children:a.jsxs(w,{type:"primary",onClick:()=>I(d),children:[a.jsx(V,{}),"Sobre"]})})}),a.jsx(k,{title:"Informações Adicionais",children:a.jsx(w,{type:"link",icon:a.jsx(V,{}),onClick:()=>I(d)})})]})]}),trigger:"hover",children:a.jsx("span",{children:n})})},{title:"Status",dataIndex:"status",key:"status",render:n=>a.jsx(k,{title:n===null?"Pendente":n===1?"Confirmado":"Cancelado",children:n===null?a.jsx(Ce,{style:{color:"orange"}}):n===1?a.jsx(Se,{style:{color:"green"}}):a.jsx(be,{style:{color:"red"}})})},{title:"Data",dataIndex:"data",key:"data"},{title:"Horário",dataIndex:"horario",key:"horario"},{title:"Convenio",dataIndex:"planodental",key:"planoDental"},{title:"Contato",dataIndex:"celular",key:"celular"},{title:"Motivo",dataIndex:"motivo",key:"motivo"}],Z=()=>{v(l)},Q=()=>{E(!1),B(null),v(i,l)};return a.jsxs("div",{className:"tabela",children:[a.jsxs("h1",{children:["Agendamentos Por Tabela ",a.jsx(ae,{})]}),a.jsxs("div",{className:"",children:[a.jsx(z,{showSearch:!0,style:{width:"30%"},placeholder:"Selecione um profissional",optionFilterProp:"children",onChange:Y,filterOption:(n,d)=>d.children.toLowerCase().includes(n.toLowerCase()),value:l,children:y.map(n=>a.jsx(z.Option,{value:n.id,children:n.nome},n.id))}),a.jsx("h3",{children:"Selecione a data desejada."}),a.jsx(ie,{onChange:F,value:i,format:"DD/MM/YYYY"})]}),a.jsxs("p",{children:["Passe o mouse em cima do nome do cliente para mais opções ",a.jsx(Re,{})]}),a.jsxs(w,{style:{marginBottom:"20px"},type:"primary",onClick:()=>h(!0),children:[a.jsx(se,{})," Novo Agendamento"]}),a.jsx(re,{isModalAgendaVisible:C,handleCancel:()=>h(!1)}),a.jsx(le,{columns:X,dataSource:e.sort(U),rowKey:"id",loading:r}),a.jsx(ne,{isModalVisible:q,handleCancel:()=>E(!1),currentAppointment:N,updateAppointments:Z,handleClose:Q}),a.jsx(ce,{title:"Informações Adicionais",open:u,onCancel:K,onOk:J,okText:"Salvar",cancelText:"Cancelar",children:a.jsx("textarea",{value:p,onChange:n=>f(n.target.value),style:{width:"100%",height:"150px"},placeholder:"Digite informações adicionais aqui..."})})]})};export{Kt as default};
