import{r,e as z,j as o,c as D}from"./index-BQF3cPym.js";import{H as P}from"./HistoryOutlined-uKW25Om6.js";import{W as L}from"./WarningFilled-DmuNQdO_.js";import{T}from"./Table-BtrjlE9_.js";import{m as F}from"./index-DCz0qyh3.js";import{I as $}from"./index-5ndGXuFb.js";import{B as C}from"./context-Fzf3q6Qk.js";import{S as H}from"./SearchOutlined-D4A1T3K6.js";import{T as O}from"./index-BCWQvPtp.js";import{E as R}from"./ExclamationCircleOutlined-7HnU-imv.js";import{C as _}from"./CheckCircleOutlined-Bm0LZL5V.js";import{C as q}from"./CloseCircleOutlined-T8rIsEXL.js";import"./AntdIcon-Bf-y5mt3.js";import"./useSize-D_L_sEch.js";import"./Serializer-CQbcCsmu.js";import"./index-Zqv3mRLS.js";import"./PurePanel-BVQW51Q3.js";import"./index-BiGWWT0_.js";import"./KeyCode-Bfjm3k6b.js";import"./Overflow-C-Iz2ka9.js";import"./useLocale-DqFOwQe3.js";import"./CheckOutlined-DTHRp8rd.js";import"./render-Evlt6hy1.js";import"./useForceUpdate-Cb-16ZfM.js";import"./responsiveObserver-BFwVCCVV.js";import"./index-DDs0x0Q4.js";import"./EllipsisOutlined-Cn-2e4jY.js";import"./index-BjuhNa7t.js";import"./index-D5pPztTr.js";import"./index-CsUWG4nD.js";import"./Dropdown-Dec2Znn0.js";import"./index-DN31wMcw.js";import"./ExclamationCircleFilled-Cq3JtRsb.js";import"./InfoCircleFilled-9dsj_Nm8.js";import"./useNotification-4XyWe70T.js";const kt=()=>{const[c,w]=r.useState(window.innerWidth<768),[s,j]=r.useState([]),[k,l]=r.useState(!1),[u,m]=r.useState([]),{authData:d}=z(),h=d.companyID,[p,E]=r.useState({current:1,pageSize:10,total:0}),f=async(t=1)=>{if(l(!0),h&&d.authToken)try{const e=await D.get(`/todos-agendamentos?company_id=${h}&page=${t}&limit=${p.pageSize}`,{headers:{Authorization:`Bearer ${d.authToken}`}});if(e.status!==200)throw new Error("Falha ao buscar dados da clinica");j(e.data.data),E({...p,current:t,total:e.data.total}),l(!1)}catch(e){console.error("Erro ao buscar todos os agendamentos",e),F.error("Erro ao buscar todos os agendamentos"),l(!1)}else console.error("Company ID or auth token not found in local storage")},I=t=>{f(t)};let g;const x=(t,e,i)=>{e(),i==="nome"?m(s.filter(a=>a.nome&&a.nome.toLowerCase().includes(t[0].toLowerCase()))):i==="cpf"&&m(s.filter(a=>a.cpf&&a.cpf.includes(t[0])))},S=t=>{t(),m(s)};r.useEffect(()=>{f()},[]),r.useEffect(()=>{const t=()=>w(window.innerWidth<768);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const b=t=>{const e=t.split(" ");return e.length>2?`${e[0]} ${e[1]}`:t},y=[{title:"Nome",dataIndex:"nome",key:"nome",render:t=>c?b(t):t},{title:"Email",dataIndex:"email",key:"email",filterDropdown:({setSelectedKeys:t,selectedKeys:e,confirm:i,clearFilters:a})=>o.jsxs("div",{style:{padding:8},children:[o.jsx($,{ref:n=>{g=n},placeholder:"Pesquisar Email",value:e[0],onChange:n=>t(n.target.value?[n.target.value]:[]),onPressEnter:()=>x(e,i,"email"),style:{marginBottom:8,display:"block"}}),o.jsx(C,{type:"primary",onClick:()=>x(e,i,"email"),size:"small",style:{width:90,marginRight:8},children:"Pesquisar"}),o.jsx(C,{onClick:()=>S(a),size:"small",style:{width:90},children:"Resetar"})]}),filterIcon:t=>o.jsx(H,{style:{color:t?"#1890ff":void 0}}),onFilter:(t,e)=>e.email?e.email.toString().toLowerCase().includes(t.toLowerCase()):"",onFilterDropdownVisibleChange:t=>{t&&setTimeout(()=>g.select(),100)}},{title:"Data",dataIndex:"data",key:"data"},{title:"Horário",dataIndex:"horario",key:"horario"},{title:"Contato",dataIndex:"celular",key:"celular"}],A=[{title:"Status",dataIndex:"status",key:"status",render:t=>o.jsx(O,{title:t===null?"Pendente":t===1?"Confirmado":"Cancelado",children:t===null?o.jsx(R,{style:{color:"orange"}}):t===1?o.jsx(_,{style:{color:"green"}}):o.jsx(q,{style:{color:"red"}})})},{title:"Data",dataIndex:"data",key:"data"}],v=c?y:[...y,...A];return o.jsxs("div",{className:"tabela",children:[o.jsxs("h1",{children:["Histórico  de Agendamentos  ",o.jsx(P,{})]}),o.jsxs("p",{children:["Utilize a lupa para pesquisar por Nome ou CPF ",o.jsx(L,{})]}),o.jsx(T,{columns:v,dataSource:u.length>0?u:s,rowKey:"id",loading:k,pagination:{...p,onChange:I}})]})};export{kt as default};
