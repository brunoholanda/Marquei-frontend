import{r as t,u as F,d as O,j as e,a as I,L as V,B as w}from"./index-kPzU05gx.js";import{B as D}from"./index-BSp-sa5F.js";import U from"./index-DOPZgS7U.js";import{R as P}from"./AuthModal-CTc-rfhF.js";import{L as z}from"./styles-IkOOaBNf.js";import{L as C}from"./LockOutlined-DYTWSnnz.js";import{B as H}from"./context-Cu6KQni0.js";import{M as S}from"./index-DmsyNvo6.js";import{I as J}from"./index-DdU0LtvV.js";import{m as c}from"./index-BfF3jSoh.js";import"./api-p_bhudRe.js";import"./index-DPBYgAbq.js";import"./Styles-CGctwYhX.js";import"./styled-components.browser.esm-BWH_c5t_.js";import"./Serializer-CQbcCsmu.js";import"./index-COTnBvfG.js";import"./useSize-Dir-JjEK.js";import"./AntdIcon-rDAQJIgd.js";import"./index-DvbXQ1GL.js";import"./index-DSAf5tNC.js";import"./render-CJmks47J.js";import"./useForm-sTvtv3Iy.js";import"./row-BdR9_GnZ.js";import"./responsiveObserver-BuWZJpCK.js";import"./useLocale-D_rXO8QB.js";import"./ExclamationCircleFilled-C5haNHtp.js";import"./index-BUWDoS_L.js";import"./PurePanel-DZZoC6Qu.js";import"./CalendarOutlined-FfBpZXtG.js";import"./ClockCircleOutlined---JEIzSM.js";import"./Overflow-DH1nb5VS.js";import"./SearchOutlined-BKygTbfa.js";import"./index-CDd_3z3j.js";import"./KeyCode-Bp2GxRS5.js";import"./CheckOutlined-CJXAI-D_.js";import"./index-Bg0REs51.js";import"./index-jIhnTVqN.js";import"./index-Chjiymov.js";import"./index-C_g5XK6A.js";import"./WarningOutlined-CuxWXMQ9.js";import"./InfoCircleFilled-aimHxtz3.js";import"./context-Cq6TeAM8.js";const $="_autenticar_103d6_1",G="_formulario_103d6_10",K="_inputContainer_103d6_24",Q="_captcha_103d6_32",W="_inputField_103d6_38",X="_forgotPassword_103d6_48",Y="_registerPrompt_103d6_58",Z="_error_103d6_71",o={autenticar:$,formulario:G,inputContainer:K,captcha:Q,inputField:W,forgotPassword:X,registerPrompt:Y,error:Z},Ue=()=>{const[h,f]=t.useState(""),[g,x]=t.useState(""),[k,p]=t.useState(!1),[E,T]=t.useState(""),[N,d]=t.useState(!1),[j,R]=t.useState(""),[v,m]=t.useState(""),[a,u]=t.useState(""),i=t.useRef(null),[q,n]=t.useState(!1),y=F(),{updateAuthData:L}=O(),M=async r=>{if(r.preventDefault(),m(""),!a){m("Por favor, confirme que você não é um robô.");return}n(!0);try{const s=await fetch(`${w}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:h,password:g,recaptchaToken:a})});if(s.ok){const{token:l,company_id:_,user_specialties:B}=await s.json();if(typeof _>"u")throw n(!1),new Error("Informações do usuário ou da empresa não estão disponíveis.");L({authToken:l,companyID:_,userSpecialties:B}),f(""),x(""),u(""),y("/calendario")}else{const l=await s.json();if(n(!1),l.message==="Token inválido ou expirado")p(!0),T("Seu período de teste chegou ao fim, mas não fique triste, fique à vontade para contratar um dos nossos planos clicando aqui!");else throw new Error(l.message||"Erro ao fazer login.")}}catch(s){n(!1),m(s.message||"Erro ao fazer login."),c.error(s.message),i.current&&i.current.reset()}},b=async()=>{if(!a){c.error("Por favor, complete o reCAPTCHA.");return}try{if((await fetch(`${w}/auth/password-reset`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:j,recaptchaToken:a})})).ok)c.success("Se um email corresponder à sua conta, enviaremos um link de redefinição de senha.");else throw new Error("Algo deu errado, por favor tente novamente.")}catch(r){c.error(r.message)}finally{d(!1)}},A=()=>{d(!0)};return e.jsxs("div",{className:o.autenticar,children:[q?e.jsxs(z,{children:[e.jsx(I,{})," "]}):e.jsxs("form",{className:o.formulario,onSubmit:M,children:[e.jsxs("h1",{children:["Acesso ao Marquei ",e.jsx(C,{})]}),e.jsxs("div",{className:o.inputContainer,children:[e.jsx("label",{htmlFor:"username",children:"E-mail"}),e.jsx("input",{type:"text",id:"username",className:o.inputField,placeholder:"E-mail",value:h,onChange:r=>f(r.target.value),required:!0})]}),e.jsxs("div",{className:o.inputContainer,children:[e.jsx("label",{htmlFor:"password",children:"Senha"}),e.jsx("input",{type:"password",id:"password",className:o.inputField,placeholder:"Senha",value:g,onChange:r=>x(r.target.value),required:!0}),v&&e.jsx("div",{className:o.error,children:v})]}),e.jsx("div",{className:o.captcha,children:e.jsx(P,{ref:i,onChange:r=>u(r)})}),e.jsx(D,{type:"submit",className:o.loginButton,children:"Entrar"}),e.jsx("div",{className:o.forgotPassword,children:e.jsx(H,{type:"link",onClick:A,children:"Esqueci minha senha"})}),e.jsxs("div",{className:o.registerPrompt,children:[e.jsx("p",{children:"Você ainda não tem uma conta Marquei?"}),e.jsx(V,{to:"/cadastro",children:"Teste o Marquei gratuitamente"})]})]}),e.jsxs(S,{title:"Período de teste chegou ao Fim :(",open:k,onOk:()=>{y("/contratar-plano"),p(!1)},onCancel:()=>p(!1),okText:"Consulte outros planos...",cancelButtonProps:{style:{display:"none"}},children:[e.jsx("p",{children:E}),e.jsx(U,{title:"Plus",price:"69,99",originalPrice:"119",quantity:"1",duration:"1",mostSold:!0})]}),e.jsxs(S,{title:"Redefinir senha",open:N,onOk:b,onCancel:()=>d(!1),okText:"Resetar",cancelText:"Cancelar",children:[e.jsx("p",{children:"Insira o E-mail cadastrado para resetar a senha de acesso !"}),e.jsx(J,{prefix:e.jsx(C,{}),type:"email",placeholder:"Digite seu email",value:j,onChange:r=>R(r.target.value),required:!0}),e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"18px 0"},children:e.jsx(P,{ref:i,onChange:r=>u(r)})})]})]})};export{Ue as default};
